------------------------------------------------------------
revno: 3685
committer: Ramil Kalimullin <ramil@mysql.com>
branch nick: mysql-5.6.4-m7-release
timestamp: Tue 2011-12-13 22:18:20 +0400
message:
  Fis for BUG#13436875 - ASSERTION '!ARGS[0]->IS_TEMPORAL() || !ARGS[1]->IS_TEMPORAL()'
  
  numeric_context_result_type() Item/Field method has been changed to return 
  only numeric result types:
  1. temporal Items/Fields return DECIMAL_RESULT/INT_RESULT depending on 
     their decimal precision,
  2. STRING_RESULT Items/Fields return REAL_RESULT,
  3. other Items/Fields return its result_type.
------------------------------------------------------------
revno: 3684
committer: Luis Soares <luis.soares@oracle.com>
branch nick: mysql-5.6.4-m7-release
timestamp: Tue 2011-12-13 12:13:37 +0000
message:
  BUG#13427444: LIVE UPGRADE FAILS BETWEEN 5.5.18 -> 5.6.4 
    
  When doing a live upgrade from a 5.5 into a 5.6, the server would
  refuse to startup because the new replication metadata tables
  were not created.  In addition, the error message was mostly
  unhelpful. In fact if the user is convinced that the server
  should start, he can turn on the option slave-skip-start which
  also bypasses the replication metadata checks on startup. Then
  the user is able to fix the problem.
    
  In this patch we extend the error and warning messages to make it
  clear that the problem may be related to the live upgrade and
  also to suggest using skip-slave-start, to bypass the startup
  problem. The user can then resort to mysql_upgrade to fix not
  only this but other problems in system tables that are due to the
  live upgrade.
------------------------------------------------------------
revno: 3683
committer: Jimmy Yang <jimmy.yang@oracle.com>
branch nick: mysql-5.6.4-m7-release
timestamp: Mon 2011-12-12 20:42:45 -0800
message:
  Fix Bug #13485695 - 63689: CANT UPDATE A ROW WITHOUT CHANGING A FTS-INDEXED
  FIELD (INNODB)
        
  rb://850 approved by marko
------------------------------------------------------------
revno: 3682
committer: Ramil Kalimullin <ramil@mysql.com>
branch nick: mysql-5.6.4-m7-release
timestamp: Thu 2011-12-08 21:47:24 +0400
message:
  Fix for BUG#13451866 - DIFFERENCE IN RESULTS WHEN USING EXTRACT( MINUTE_MICROSECOND )
  
  Allow zero month|day extracting time from Field_temporal_with_date.
------------------------------------------------------------
revno: 3681
committer: Vasil Dimov <vasil.dimov@oracle.com>
branch nick: mysql-5.6.4-m7-release
timestamp: Thu 2011-12-08 11:14:27 +0200
message:
  Use WHERE LOWER(variable_name) = 'foo' instead of
  WHERE variable_name = 'FOO' when SELECTing from
  information_schema.global_status.
------------------------------------------------------------
revno: 3680
committer: Jimmy Yang <jimmy.yang@oracle.com>
branch nick: mysql-5.6.4-m7-release
timestamp: Wed 2011-12-07 03:28:54 -0800
message:
  Port following fixes to 5.6.4 release clone:
  
  Fix Bug #13444828 - INNODB FTS SUPPORT: FAILING ASSERTION:
  UT_STRCMP(INDEX1->NAME, INDEX2->NAME
  rb://842 approved by marko 
  
  Fix Bug #13410591 and Bug #13440415
  Bug #13410591 - UNEXPECTED 'FINISH BUILD INDEX' MESSAGES IN SERVER ERROR LOG
  Bug #13440415 - INNODB FTS SUPPORT:(DICT_INDEX_GET_N_UNIQUE(PLAN->INDEX) <=
  PLAN->N_EXACT_MATCH)
  rb://833 approved by Sunny Bains 
------------------------------------------------------------
revno: 3679
tags: clone-5.6.4-m7-build
committer: Jimmy Yang <jimmy.yang@oracle.com>
branch nick: trunk2
timestamp: Mon 2011-11-28 12:36:46 -0800
message:
  Fix Bug #13435544 - IB_VECTOR_SIZE(TABLE->FTS->INDEXES) ==
  IB_VECTOR_SIZE(TABLE->FTS->CACHE->INDEXES
------------------------------------------------------------
revno: 3678
committer: Jimmy Yang <jimmy.yang@oracle.com>
branch nick: trunk2
timestamp: Mon 2011-11-28 05:44:33 -0800
message:
  Fix Bug #13431755 - INNODB FTS DOES NOT WORK WITH NON-DEFAULT AUTO_INCREMENT
  START
  
  rb://829 approved by Sunny Bains
------------------------------------------------------------
revno: 3677
committer: Anitha Gopi <anitha.gopi@oracle.com>
branch nick: mysql-trunk
timestamp: Mon 2011-11-28 17:11:20 +0530
message:
  Bug#13436056 : Disabled the test since it causes PB2 timeout
------------------------------------------------------------
revno: 3676
committer: Marc Alff <marc.alff@oracle.com>
branch nick: mysql-trunk-cleanup
timestamp: Mon 2011-11-28 12:16:00 +0100
message:
  Test cleanup.
  
  Added valgrind suppressions for optimized builds, for init_pfs_instrument_array()
  Improved the robustness of the performance_schema.nesting test
------------------------------------------------------------
revno: 3675
committer: Alexander Barkov <alexander.barkov@oracle.com>
branch nick: mysql-trunk
timestamp: Mon 2011-11-28 14:08:20 +0400
message:
  WL#946 after-fix
  - Fixing compilation problems with Visual Studio 10
    (lldiv_t defined twice)
  - Fixing "conversion from 'ulong' to 'uint8', possible loss of data"
    warnings in item_timefunc.h
------------------------------------------------------------
revno: 3674
committer: Alexander Barkov <alexander.barkov@oracle.com>
branch nick: mysql-trunk
timestamp: Mon 2011-11-28 13:36:45 +0400
message:
  WL#946 after fixes:
  - Recording test results in /engines suite
  - '<=>' operator did not work for TIME data type.
  - Renaming Arg_comparator::compare_temporal_packed to compare_time_packed,
    as it's only for TIME data type.
------------------------------------------------------------
revno: 3673 [merge]
committer: Luis Soares <luis.soares@oracle.com>
branch nick: mysql-trunk
timestamp: Thu 2011-11-24 15:21:17 +0000
message:
  BUG#13427949
  
  Manual merge from mysql-5.5.
  
  Conflicts
  ---------
  Text conflict in sql/rpl_slave.cc
    ------------------------------------------------------------
    revno: 2875.321.44
    committer: Luis Soares <luis.soares@oracle.com>
    branch nick: mysql-5.5
    timestamp: Thu 2011-11-24 14:51:18 +0000
    message:
      BUG#13427949: CHANGE MASTER TO USER='' (EMPTY USER) CAUSES ERRORS ON VALGRING 
        
      When passing an empty user to the connect function will cause
      valgrind warnings. Seems that the client code is not prepared 
      to handle empty users. On 5.6 this can even be triggered by 
      START SLAVE PASSWORD='...'; i.e., without setting USER='...' on
      the START SLAVE command (see WL#4143 for details on the new
      additional START SLAVE commands).
        
      To fix this, we disallow empty users when configuring the slave
      connection parameters (this decision might be revisited if the 
      client code accepts empty users in the future).
------------------------------------------------------------
revno: 3672
committer: Jimmy Yang <jimmy.yang@oracle.com>
branch nick: trunk2
timestamp: Thu 2011-11-24 06:16:53 -0800
message:
  Remove obsoleted ftsparse() declaration
------------------------------------------------------------
revno: 3671
committer: Alexander Barkov <alexander.barkov@oracle.com>
branch nick: mysql-trunk
timestamp: Thu 2011-11-24 16:31:44 +0400
message:
  WL#946 Postfix: removing unused variable
------------------------------------------------------------
revno: 3670
committer: Marko M?kel? <marko.makela@oracle.com>
branch nick: mysql-trunk
timestamp: Thu 2011-11-24 12:49:07 +0200
message:
  Update FSF address in GPL notices once more.
------------------------------------------------------------
revno: 3669
committer: Jimmy Yang <jimmy.yang@oracle.com>
branch nick: trunk2
timestamp: Thu 2011-11-24 02:22:04 -0800
message:
  Add Copyright info to fts0blex.l, fts0tlex.l and fts0pars.y. Remove
  unused fts_uc_data.ic
  
  rb://825 approved by Marko
------------------------------------------------------------
revno: 3668
committer: Jimmy Yang <jimmy.yang@oracle.com>
branch nick: trunk3
timestamp: Thu 2011-11-24 01:59:04 -0800
message:
  Non-functional format cleanup on fts0types.ic
------------------------------------------------------------
revno: 3667 [merge]
committer: Alexander Barkov <alexander.barkov@oracle.com>
branch nick: mysql-trunk
timestamp: Thu 2011-11-24 12:05:38 +0400
message:
  Merging from mysql-trunk
    ------------------------------------------------------------
    revno: 3665.1.1
    committer: Marko M?kel? <marko.makela@oracle.com>
    branch nick: mysql-trunk
    timestamp: Thu 2011-11-24 09:57:34 +0200
    message:
      Adjust InnoDB copyright headers for fut0fut.cc and full-text-search files.
      
      TODO: Add copyright information to include/fts_uc_data.ic
      TODO: Add copyright information to *.y and *.l files between %{ and %}
      so that it will be included in the generated files.
------------------------------------------------------------
revno: 3666 [merge]
committer: Alexander Barkov <alexander.barkov@oracle.com>
branch nick: mysql-trunk
timestamp: Thu 2011-11-24 12:02:23 +0400
message:
  WL#946 Fractional second precision
  Merging from mysql-trunk-stage
    ------------------------------------------------------------
    revno: 3639.1.3
    committer: Alexander Barkov <alexander.barkov@oracle.com>
    branch nick: mysql-trunk-stage
    timestamp: Wed 2011-11-23 22:28:18 +0400
    message:
      W#946 fixing "mtr --ps opt_trace.subquery_ps_prot" failure.
      Recording new result file.
    ------------------------------------------------------------
    revno: 3639.1.2
    committer: Alexander Barkov <alexander.barkov@oracle.com>
    branch nick: mysql-trunk-stage
    timestamp: Tue 2011-11-22 22:54:48 +0400
    message:
      WL#946 Fixing compilation failure with --enable-mysql-maintainer-mode (-Werror)
    ------------------------------------------------------------
    revno: 3639.1.1 [merge]
    committer: Alexander Barkov <alexander.barkov@oracle.com>
    branch nick: mysql-trunk-stage
    timestamp: Tue 2011-11-22 13:19:19 +0300
    message:
      Merging mysql-trunl-wl5885
        ------------------------------------------------------------
        revno: 3593.1.14
        committer: Alexander Barkov <alexander.barkov@oracle.com>
        branch nick: mysql-trunk-wl5885
        timestamp: Mon 2011-11-21 22:17:25 +0300
        message:
          WL#946 Better gcov coverage. Adding tests for the old fields.
        ------------------------------------------------------------
        revno: 3593.1.13
        committer: Alexander Barkov <alexander.barkov@oracle.com>
        branch nick: mysql-trunk-wl5885
        timestamp: Mon 2011-11-21 18:17:51 +0300
        message:
          Improving coverage according to gcov results.
        ------------------------------------------------------------
        revno: 3593.1.12
        committer: Alexander Barkov <alexander.barkov@oracle.com>
        branch nick: mysql-trunk-wl5885
        timestamp: Mon 2011-11-21 15:57:16 +0300
        message:
          Removing debug code.
        ------------------------------------------------------------
        revno: 3593.1.11 [merge]
        committer: Alexander Barkov <alexander.barkov@oracle.com>
        branch nick: mysql-trunk-wl5885
        timestamp: Mon 2011-11-21 15:02:21 +0300
        message:
          Merging mysql-trunk 0> mysql-trunk-wl5885
        ------------------------------------------------------------
        revno: 3593.1.10 [merge]
        committer: Alexander Barkov <alexander.barkov@oracle.com>
        branch nick: mysql-trunk-wl5885
        timestamp: Mon 2011-11-21 14:58:25 +0300
        message:
          Merging mysql-trunk -> mysql-trunk-wl5885
        ------------------------------------------------------------
        revno: 3593.1.9
        committer: Alexander Barkov <alexander.barkov@oracle.com>
        branch nick: mysql-trunk-wl5885
        timestamp: Mon 2011-11-21 14:05:05 +0300
        message:
          WL#946: Better gcove coverage.
        ------------------------------------------------------------
        revno: 3593.1.8
        committer: Alexander Barkov <alexander.barkov@oracle.com>
        branch nick: mysql-trunk-wl5885
        timestamp: Sat 2011-11-19 22:47:50 +0300
        message:
          WL#946: Bug#13394031 VALGRIND: CONDITIONAL JUMP/MOVE DEPENDS ON UNINITIALISED IN FIELD::IS_REAL_NULL
        ------------------------------------------------------------
        revno: 3593.1.7 [merge]
        committer: Alexander Barkov <alexander.barkov@oracle.com>
        branch nick: mysql-trunk-wl5885
        timestamp: Fri 2011-11-18 16:26:35 +0300
        message:
          Merging latest bug fixes from mysql-trunk-wl946
            ------------------------------------------------------------
            revno: 3540.2.26
            committer: Alexander Barkov <alexander.barkov@oracle.com>
            branch nick: mysql-trunk-wl946
            timestamp: Fri 2011-11-18 14:49:13 +0300
            message:
              WL#946 fixing field-t gunit test failure.
            ------------------------------------------------------------
            revno: 3540.2.25
            committer: Alexander Barkov <alexander.barkov@oracle.com>
            branch nick: mysql-trunk-wl946
            timestamp: Fri 2011-11-18 13:44:11 +0300
            message:
              The fix for Bug#13399082 also fixes the Bug#13354387
              Adding test case for Bug#13354387.
            ------------------------------------------------------------
            revno: 3540.2.24
            committer: Alexander Barkov <alexander.barkov@oracle.com>
            branch nick: mysql-trunk-wl946
            timestamp: Fri 2011-11-18 12:52:00 +0300
            message:
              WL#946: Bug#13399082 ABARKOV ASSERTION `MON > 0 && MON < 13' FAILED IN TZTIME.CC:794 | SEC_SINCE_EPOCH
            ------------------------------------------------------------
            revno: 3540.2.23
            committer: Alexander Barkov <alexander.barkov@oracle.com>
            branch nick: mysql-trunk-wl946
            timestamp: Thu 2011-11-17 21:31:32 +0300
            message:
              WL#946: Bug#13401354 ITEM->FIELD_TYPE() == MYSQL_TYPE_TIME || ITEM->FIELD_TYPE() == MYSQL_TYPE_NULL
        ------------------------------------------------------------
        revno: 3593.1.6
        committer: Mayank Prasad <mayank.prasad@oracle.com>
        branch nick: 5885_final
        timestamp: Fri 2011-11-18 18:28:18 +0530
        message:
          WL#5885 
          
          details:
          - Added test case for IS_ROUTINES/PARAMETERS tables
            to test DATETIME PRECISION for values 1-6.
        ------------------------------------------------------------
        revno: 3593.1.5
        committer: Mayank Prasad <mayank.prasad@oracle.com>
        branch nick: 5885_final
        timestamp: Fri 2011-11-18 17:12:10 +0530
        message:
          WL#5885 
          
          details: 
          - added testcase to test different datetime_precision
          values (1-6).
        ------------------------------------------------------------
        revno: 3593.1.4 [merge]
        committer: Alexander Barkov <alexander.barkov@oracle.com>
        branch nick: mysql-trunk-wl5885
        timestamp: Thu 2011-11-17 16:41:28 +0300
        message:
          Merging WL#946 and WL#5885
            ------------------------------------------------------------
            revno: 3540.2.22
            committer: Alexander Barkov <alexander.barkov@oracle.com>
            branch nick: mysql-trunk-wl946
            timestamp: Wed 2011-11-16 17:58:34 +0300
            message:
              Bug#13365131 - VALGRIND: CONDITIONAL JUMP OR MOVE DEPENDS ON UNINITIALISED IN MY_TIME_COMPARE
            ------------------------------------------------------------
            revno: 3540.2.21
            committer: Alexander Barkov <alexander.barkov@oracle.com>
            branch nick: mysql-trunk-wl946
            timestamp: Wed 2011-11-16 16:45:51 +0300
            message:
              WL#946: Bug#13392141 ASSERT FAILURE IN SEC_SINCE_EPOCH
            ------------------------------------------------------------
            revno: 3540.2.20
            committer: Alexander Barkov <alexander.barkov@oracle.com>
            branch nick: mysql-trunk-wl946
            timestamp: Tue 2011-11-15 16:50:16 +0300
            message:
              WL#946: Bug?#13391370   ASSERT FAILURE IN TIME_TO_LONGLONG_DATETIME_PACKED
              
              Fixing bug report number incorrectly mentioned in the previous commit.
            ------------------------------------------------------------
            revno: 3540.2.19
            committer: Alexander Barkov <alexander.barkov@oracle.com>
            branch nick: mysql-trunk-wl946
            timestamp: Tue 2011-11-15 16:06:17 +0300
            message:
              WL#946: BUG#13386657 ASSERT FAILURE IN ITEM::GET_DATE_FROM_NON_TEMPORAL, PART2
            ------------------------------------------------------------
            revno: 3540.2.18
            committer: Alexander Barkov <alexander.barkov@oracle.com>
            branch nick: mysql-trunk-wl946
            timestamp: Tue 2011-11-15 09:52:11 +0300
            message:
              WL#946:
              Bug#13384069 - EMBEDED UPDATE WITH CAST AND DATETIME WITH FSP DOES NOT WORK
              Bug#13383838 - DELETE DOESN'T EMPTY RECORDS WHEN CAST WITH DATETIME TYPE IN EMBEDED SELECT
            ------------------------------------------------------------
            revno: 3540.2.17
            committer: Alexander Barkov <alexander.barkov@oracle.com>
            branch nick: mysql-trunk-wl946
            timestamp: Mon 2011-11-14 22:55:51 +0300
            message:
              WL#946: Bug#13386657 ASSERT FAILURE IN ITEM::GET_DATE_FROM_NON_TEMPORAL
            ------------------------------------------------------------
            revno: 3540.2.16
            committer: Alexander Barkov <alexander.barkov@oracle.com>
            branch nick: mysql-trunk-wl946
            timestamp: Mon 2011-11-14 15:54:10 +0300
            message:
              WL#946 testing valgrind failures in "mtr --valgrind --do-test=subquery"
            ------------------------------------------------------------
            revno: 3540.2.15
            committer: Alexander Barkov <alexander.barkov@oracle.com>
            branch nick: mysql-trunk-wl946
            timestamp: Mon 2011-11-14 12:58:55 +0300
            message:
              WL#946: BUG#13385275 - ASSERT FAILURE IN TIME_FROM_LONGLONG_PACKED 
            ------------------------------------------------------------
            revno: 3540.2.14
            committer: Alexander Barkov <alexander.barkov@oracle.com>
            branch nick: mysql-trunk.time9
            timestamp: Thu 2011-11-10 18:14:11 +0300
            message:
              WL#946 13367868 ?assert failure in mysql_time_cache::set_time , when time has quoted fsp
            ------------------------------------------------------------
            revno: 3540.2.13
            committer: Alexander Barkov <alexander.barkov@oracle.com>
            branch nick: mysql-trunk.time9
            timestamp: Thu 2011-11-10 17:58:23 +0300
            message:
              WL#946: Bug#13359097 ASSERT FAILURE IN MAKE_SORTKEY
            ------------------------------------------------------------
            revno: 3540.2.12
            committer: Bernt M. Johnsen <bernt.johnsen@oracle.com>
            branch nick: trunk-wl946
            timestamp: Wed 2011-11-09 11:16:53 +0100
            message:
              WL#946 Added fractions to mysql_client_test.c
            ------------------------------------------------------------
            revno: 3540.2.11
            committer: Alexander Barkov <alexander.barkov@oracle.com>
            branch nick: mysql-trunk.time9
            timestamp: Mon 2011-11-07 17:35:16 +0300
            message:
              WL#946 clean-ups
            ------------------------------------------------------------
            revno: 3540.2.10
            committer: Alexander Barkov <alexander.barkov@oracle.com>
            branch nick: mysql-trunk.time9
            timestamp: Mon 2011-11-07 15:02:15 +0300
            message:
              WL#946: more clean-ups in MYSQL_TIME_cache:
              now set_XXX() functions automatically reset string representation.
              This is needed because in case of prepared statements
              fix_length_and_dec() is called twice: at prepare time and at execute time.
              We need to clean string representation when set_XXX() is called from the
              execute time fix_length_and_dec().
            ------------------------------------------------------------
            revno: 3540.2.9
            committer: Alexander Barkov <alexander.barkov@oracle.com>
            branch nick: mysql-trunk.time9
            timestamp: Mon 2011-11-07 14:50:35 +0300
            message:
              WL#946: Bug#13354645 CRASH IN ITEM_TEMPORAL_HYBRID_FUNC
            ------------------------------------------------------------
            revno: 3540.2.8
            committer: Alexander Barkov <alexander.barkov@oracle.com>
            branch nick: mysql-trunk.time9
            timestamp: Mon 2011-11-07 10:44:22 +0300
            message:
              WL#946 Improvements in MYSQL_TIME_cache.
            ------------------------------------------------------------
            revno: 3540.2.7
            committer: Alexander Barkov <alexander.barkov@oracle.com>
            branch nick: mysql-trunk.time9
            timestamp: Mon 2011-11-07 08:59:51 +0300
            message:
              WL#946
              Fixing crash on Windows on:
              
                DBUG_ASSERT(sizeof(time_t) == sizeof(when.tv_sec));
            ------------------------------------------------------------
            revno: 3540.2.6
            committer: Alexander Barkov <alexander.barkov@oracle.com>
            branch nick: mysql-trunk.time9
            timestamp: Thu 2011-11-03 12:33:45 +0300
            message:
              WL#946 clean-ups
              - Introducing new class MYSQL_TIME_cache.
              - minor other improvements
            ------------------------------------------------------------
            revno: 3540.2.5
            committer: Alexander Barkov <alexander.barkov@oracle.com>
            branch nick: mysql-trunk.time9
            timestamp: Wed 2011-11-02 17:05:10 +0300
            message:
              WL#946 clean-ups
            ------------------------------------------------------------
            revno: 3540.2.4
            committer: Alexander Barkov <alexander.barkov@oracle.com>
            branch nick: mysql-trunk.time9
            timestamp: Wed 2011-11-02 14:21:10 +0300
            message:
              WL#946 clean-ups
            ------------------------------------------------------------
            revno: 3540.2.3
            committer: Alexander Barkov <alexander.barkov@oracle.com>
            branch nick: mysql-trunk.time9
            timestamp: Wed 2011-11-02 09:13:46 +0300
            message:
              WL#946 test clean-up
            ------------------------------------------------------------
            revno: 3540.2.2
            committer: Alexander Barkov <alexander.barkov@oracle.com>
            branch nick: mysql-trunk.time9
            timestamp: Wed 2011-11-02 00:08:15 +0300
            message:
              WL#946 clean-ups
            ------------------------------------------------------------
            revno: 3540.2.1
            committer: Alexander Barkov <alexander.barkov@oracle.com>
            branch nick: mysql-trunk.time9
            timestamp: Tue 2011-11-01 14:52:24 +0300
            message:
              WL#946
        ------------------------------------------------------------
        revno: 3593.1.3
        committer: Mayank Prasad <mayank.prasad@oracle.com>
        branch nick: 5885_final
        timestamp: Mon 2011-11-14 17:24:50 +0530
        message:
          WL#5885 : 
          
          Details:
          	Fixed result files for failing embedded tests.
        ------------------------------------------------------------
        revno: 3593.1.2 [merge]
        committer: Mayank Prasad <mayank.prasad@oracle.com>
        branch nick: 5885_final
        timestamp: Fri 2011-11-11 11:11:45 +0530
        message:
          WL#5885 : committing new mtr testcases for WL#5885
            ------------------------------------------------------------
            revno: 3484.1.2
            committer: Mayank Prasad <mayank.prasad@oracle.com>
            branch nick: 5885
            timestamp: Thu 2011-11-03 13:20:03 +0530
            message:
              WL#5885 :
              
              Details:
              - Added testcases/result files for DATETIME_PRECISION for 
                information_schema.(columns/routines/parameters) tables.
        ------------------------------------------------------------
        revno: 3593.1.1 [merge]
        committer: Mayank Prasad <mayank.prasad@oracle.com>
        branch nick: 5885_final
        timestamp: Fri 2011-11-11 11:08:56 +0530
        message:
          WL#5885 : committing code changes for WL#5885
            ------------------------------------------------------------
            revno: 3484.1.1
            committer: Mayank Prasad <mayank.prasad@oracle.com>
            branch nick: 5885
            timestamp: Tue 2011-10-25 15:53:23 +0530
            message:
              WL#5885 : TIME/TIMESTAMP/DATETIME with fractional seconds, information_schema
              
              Details:
              -> Code drop for adding a new field DATETIME_PRECISION in 
                 I_S.COLUMNS/PARAMETERS/ROUTINES.
              -> Modified result files of existing test cases to take care of new Field 
                 into account.
------------------------------------------------------------
revno: 3665
committer: Vasil Dimov <vasil.dimov@oracle.com>
branch nick: mysql-trunk
timestamp: Thu 2011-11-24 09:31:18 +0200
message:
  Fix Bug#12939557 VALGRIND:VEX AMD64->IR: UNHANDLED INSTRUCTION
  BYTES: 0XF2 0X48 0XF 0X38 0XF0 0XA
  
  Emit an error from CMake if WITH_VALGRIND is turned ON (it is OFF by
  default) and if Valgrind headers are not found. Before this patch CMake
  silently switched WITH_VALGRIND to OFF and continued if the needed
  headers were not found.                                                   
  
  We have experienced a few time-comsuming issues with people turning ON
  WITH_VALGRIND and then not getting InnoDB Valgrind instrumentation
  enabled because CMake couldn't find the headers and disabled WITH_VALGRIND.
------------------------------------------------------------
revno: 3664
committer: Marko M?kel? <marko.makela@oracle.com>
branch nick: mysql-trunk
timestamp: Thu 2011-11-24 09:15:35 +0200
message:
  Correct the FSF address.
------------------------------------------------------------
revno: 3663
committer: Manish Kumar <manish.4.kumar@oracle.com>
branch nick: mysql-trunk-bug-11747887
timestamp: Thu 2011-11-24 10:25:15 +0530
message:
  BUG#11747887:34386: MYSQLBINLOG --HEXDUMP PRINTS LAST ROW OF HEXDUMP
                      INCORRECTLY.
  
  This is a post push for the bug#11747887, which was failing in solaris platform.
  
  Problem - the failure was due to the wrong Xid value generated on solaris platform
            which was due to thw difference in the Endianness of the solaris
   	  platform.
  
  Fix -  the fix for the problem was by masking the Xid value in the result file.
------------------------------------------------------------
revno: 3662
committer: Olav Sandstaa <olav.sandstaa@oracle.com>
branch nick: read-rnd-buffer-fix
timestamp: Wed 2011-11-23 20:55:56 +0100
message:
  Fix for Bug#13249966 MRR: RANDOM ERROR DUE TO UNINITIALIZED RES WITH 
                       SMALL READ_RND_BUFFER_SIZE
  
  This bug is triggered by setting the system variable
  read_rnd_buffer_size so low that the created sort buffer used by
  DS-MRR is too small to fit a single key. When the range scan using
  DS-MRR starts, it is unable to store any keys in the sort buffer and
  an uninitialized return value is returned. This return value would
  have been given its initial value when the first record was read from
  the index. This causes either a random error value or wrong results
  from the range scan (zero records). The patch fixes two bugs in the
  DS-MRR implementation.
  
  Bug 1 (the original problem):
  
  The cause for this failure is found in DsMrr_impl::choose_mrr_impl().
  One of its arguments is the buffer size which is initially specified
  by read_rnd_buffer_size. Before this is used as argument in the call
  to get_disk_sweep_mrr_cost() the following is subtracted from the
  buffer size:
  
    table->key_info[keyno].key_length + h->ref_length;
  
  The buffer size is stored as an unsigned integer and if it is smaller
  than the above expression, the result of the subtraction becomes a
  very large number. When get_disk_sweep_mrr_cost() is called with this
  huge buffer size, it concludes that there are plenty of room for
  storing keys in this buffer when it should have concluded that the
  buffer was too small for storing a single key. This causes the
  choose_mrr_impl() to return that DS-MRR should be used when it should
  have returned that the default MRR implementation should have been used due
  to too small buffer size.
  
  The subtraction (the above expression) from the buffer size in
  DsMrr_impl::choose_mrr_impl() was originally done because an early
  version of the DsMrr implementation used the sort buffer to store the
  current position of the scan each time it had filled the sort
  buffer. This was needed in order to be able to restart the scan next
  time it should fill the sort buffer. The subtraction was done to count
  for the space needed for storing the current position. This
  implementation has since been changed to use a second handler object
  for scanning the index. With this is place, there was no need for
  storing the current position in the sort buffer. The code for storing
  and reading the current scan position to/from the sort buffer has been
  removed but the reservation of space for it in
  DsMrr_impl::choose_mrr_impl() has been left in the code. The fix for
  avoiding that the buffer size is assigned a wrong value is to remove
  this subtraction.
  
  Bug 2:
  
  This fix solved the original bug but caused several query plans to
  wrongly change from using MRR or BKA to not using these. This was
  caused by a bug in DsMrr_impl::dsmrr_info(). This function first
  computes the cost for using the default MRR strategy by calling
  handler::multi_range_read_info(). This takes as one of its arguments a
  pointer to the buffer size. Since the default MRR implementation does
  not need a sort buffer, it sets the buffer size to zero. To avoid that
  this overwrites the original buffer size, a local variable def_bufsz
  is used in DsMrr_impl::dsmrr_info(). After the call to
  handler::multi_range_read_info() this will thus always be zero. The
  bug is that this local variable is used as argument when calling
  choose_mrr_impl() instead of the original buffer size stored in
  *bufsz. This causes choose_mrr_impl() to be called with a buffer size
  of 0 bytes, and as a result it will return that the default MRR
  implementation should be used (since the zery byte buffer size is too
  small).
  
  The reason this bug has not surfaced earlier is that it has been
  "hidden" by the first bug. When calling choose_mrr_impl() with a
  buffer size of 0 the subtraction in choose_mrr_impl() would (wrongly)
  change this to a very large buffer size that was large enough to use
  for DS-MRR (or in another way: this second bug sets the supplied
  buffer size to 0 in DsMrr_impl::dsmrr_info() and then the first bug
  compensated by changing the 0 byte buffer size to a very large buffer
  size in choose_mrr_impl()).
  
  The fix for this is to replace the bufsz and flags arguments in the
  call to choose_mrr_impl() to use the original values instead of the
  values in the local variables def_flags and def_bufsz. After this fix
  the implementation of DsMrr_impl::dsmrr_info() is similar to the
  corresponding implementation in DsMrr_impl::dsmrr_info_const().
------------------------------------------------------------
revno: 3661
committer: Ashish Agarwal<ashish.y.agarwal@oracle.com>
branch nick: mysql-trunk
timestamp: Wed 2011-11-23 19:10:31 +0530
message:
  BUG#11751793 - 42784: Merge from mysql-5.5 to mysql-trunk
------------------------------------------------------------
revno: 3660
committer: Luis Soares <luis.soares@oracle.com>
branch nick: mysql-trunk
timestamp: Wed 2011-11-23 10:51:10 +0000
message:
  BUG#13410464
  
  Addressing review comments.
------------------------------------------------------------
revno: 3659 [merge]
committer: Luis Soares <luis.soares@oracle.com>
branch nick: mysql-trunk
timestamp: Wed 2011-11-23 10:49:40 +0000
message:
  BUG#13410464
  
  Automerging with latest mysql-trunk.
    ------------------------------------------------------------
    revno: 3620.5.1
    committer: Luis Soares <luis.soares@oracle.com>
    branch nick: mysql-trunk
    timestamp: Sun 2011-11-20 22:17:18 +0000
    message:
      Bug#13410464: FOR START SLAVE .. PASSWORD=<PASSWORD>, THE PASSWORD 
                    IS LOGGED IN PLAIN TEXT
      
      The server was not rewriting the statement START SLAVE when it
      was issued along with the PASSWORD instruction. Thence, the
      password is written in clear text to the general log.
      
      To fix this, we register the SQLCOM_SLAVE_START as a command that
      should be rewritten (if the command contained indeed the PASSWORD
      token).
------------------------------------------------------------
revno: 3658
committer: Tor Didriksen <tor.didriksen@oracle.com>
branch nick: trunk-clean
timestamp: Wed 2011-11-23 10:14:10 +0100
message:
  Fix pushbuild complaints:
  WARNING: GPL not restricted to version 2: sql/sql_get_diagnostics.h
------------------------------------------------------------
revno: 3657
committer: Marko M?kel? <marko.makela@oracle.com>
branch nick: mysql-trunk
timestamp: Wed 2011-11-23 10:31:30 +0200
message:
  Bug#12682554 FAILED ASSERT AT HANDLER0ALTER.CC IN MANY TESTS
  
  The previous fix did not address all cases. We got a core dump where
  the assertion failed when error==DB_SUCCESS. The table was being
  accessed by the purge thread. If handler::add_index() had locked the
  data dictionary, purge would have been unable to s-lock
  dict_operation_lock, and the assertion would not have failed.
  
  This bug was introduced in a merge of a change from mysql-5.5 to mysql-trunk:
  jon.hauglid@oracle.com-20110601080655-hz6c2i2m5il1lx4o, 2875.272.42,
  Bug#11853126 RE-ENABLE CONCURRENT READS WHILE CREATING
  SECONDARY INDEX IN INNODB.
  
  Before mysql-trunk, tables were never evicted from the InnoDB data
  dictionary cache.  The merge failed to take this into account.
  
  rb:823 approved by Jimmy Yang
------------------------------------------------------------
revno: 3656
committer: Vinay Fisrekar <vinay.fisrekar@oracle.com>
branch nick: mysql-trunk
timestamp: Wed 2011-11-23 12:01:32 +0530
message:
  Bug#13418274 - Enable the windows run for the innodb_fts_misc and innodb_fts_misc_1. (was disbaled for sporadic failure analysis)
------------------------------------------------------------
revno: 3655
committer: Sunny Bains <Sunny.Bains@Oracle.Com>
branch nick: trunk
timestamp: Wed 2011-11-23 14:38:24 +1100
message:
  Remove redundant code.
------------------------------------------------------------
revno: 3654
committer: Sunny Bains <Sunny.Bains@Oracle.Com>
branch nick: trunk
timestamp: Wed 2011-11-23 13:13:04 +1100
message:
  Fix compiler warnings.
  Fix whitespace.
  Fix comments.
  Add #define FTS_NULL_DOC_ID
   
  Note: The Bison generated files were edited to remove no-op code that caused
  warnings on Windows.
        
  rb://822 Approved by Jimmy.
------------------------------------------------------------
revno: 3653
committer: Inaam Rana <inaam.rana@oracle.com>
branch nick: mysql-trunk
timestamp: Tue 2011-11-22 21:01:58 -0500
message:
  Fix innodb_lru_scan_depth_basic test as we change the value for
  mtr runs to 100 from 1024
------------------------------------------------------------
revno: 3652
committer: Sunny Bains <Sunny.Bains@Oracle.Com>
branch nick: trunk
timestamp: Wed 2011-11-23 10:26:36 +1100
message:
  Fix a bug that was introduced when fixing the compiler error. The compiler
  would croak on the branch prediction hints.
------------------------------------------------------------
revno: 3651
committer: Inaam Rana <inaam.rana@oracle.com>
branch nick: mysql-trunk
timestamp: Tue 2011-11-22 15:20:53 -0500
message:
  Make InnoDB LRU eviction less aggressive when the buffer pool is small
  by setting the value of innodb_lru_scan_depth lower. Aggressive
  eviction results in test failures which rely on certain pages
  to be in the buffer pool e.g.: innodb_information_schema
------------------------------------------------------------
revno: 3650 [merge]
committer: Marc Alff <marc.alff@oracle.com>
branch nick: mysql-trunk-merge
timestamp: Tue 2011-11-22 20:14:42 +0100
message:
  WL#5461 PERFORMANCE SCHEMA MY.CNF DEFAULT SETUP
  
  Merge of mysql-trunk-wl5461 to mysql-trunk
    ------------------------------------------------------------
    revno: 3402.13.30 [merge]
    committer: Marc Alff <marc.alff@oracle.com>
    branch nick: mysql-trunk-wl5461
    timestamp: Tue 2011-11-22 19:40:24 +0100
    message:
      Merge mysql-trunk --> mysql-trunk-wl5461
    ------------------------------------------------------------
    revno: 3402.13.29 [merge]
    committer: Marc Alff <marc.alff@oracle.com>
    branch nick: mysql-trunk-wl5461
    timestamp: Tue 2011-11-22 12:08:42 +0100
    message:
      Merge mysql-trunk --> mysql-trunk-wl5461
    ------------------------------------------------------------
    revno: 3402.13.28
    committer: Christopher Powers <chris.powers@oracle.com>
    branch nick: mysql-trunk-wl5461
    timestamp: Mon 2011-11-21 15:02:04 -0600
    message:
      WL#5461 PERFORMANCE_SCHEMA MY.CNF Defaults Setup
      
      Ensure that instrument and consumer settings cannot be seen or changed,
      and that the corresponding tests verify the same.
      
      Remove 'enabled/disabled' as option values.
    ------------------------------------------------------------
    revno: 3402.13.27 [merge]
    committer: Christopher Powers <chris.powers@oracle.com>
    branch nick: mysql-trunk-wl5461
    timestamp: Mon 2011-11-21 14:17:00 -0600
    message:
      local merge
    ------------------------------------------------------------
    revno: 3402.13.26
    committer: Christopher Powers <chris.powers@oracle.com>
    branch nick: mysql-trunk-wl5461
    timestamp: Mon 2011-11-21 14:15:58 -0600
    message:
      WL#5461 PERFORMANCE_SCHEMA MY.CNF Defaults Setup
      
      Disallow SELECT @@ of performance_schema_instrument and
      performance_schema_consumer option settings.
    ------------------------------------------------------------
    revno: 3402.13.25 [merge]
    committer: Marc Alff <marc.alff@oracle.com>
    branch nick: mysql-trunk-wl5461
    timestamp: Mon 2011-11-21 12:32:18 +0100
    message:
      Merge mysql-trunk --> mysql-trunk-wl5461
    ------------------------------------------------------------
    revno: 3402.13.24
    committer: Christopher Powers <chris.powers@oracle.com>
    branch nick: mysql-trunk-wl5461
    timestamp: Fri 2011-11-18 12:28:29 -0600
    message:
      WL#5461 PERFORMANCE_SCHEMA MY.CNF Default Setup
      
      Resolve build warning
    ------------------------------------------------------------
    revno: 3402.13.23
    committer: Christopher Powers <chris.powers@oracle.com>
    branch nick: mysql-trunk-wl5461
    timestamp: Fri 2011-11-18 12:13:39 -0600
    message:
      WL#5461 PERFORMANCE_SCHEMA MY.CNF Default Setup
      
      For the performance_schema_instrument configuration option:
      - Simplify code for trimming trailing spaces
      - Improve gcov coverage by adding trailing space to option value
    ------------------------------------------------------------
    revno: 3402.13.22
    committer: Marc Alff <marc.alff@oracle.com>
    branch nick: mysql-trunk-wl5461
    timestamp: Fri 2011-11-18 17:49:29 +0100
    message:
      Fixed more code review comments
    ------------------------------------------------------------
    revno: 3402.13.21 [merge]
    committer: Marc Alff <marc.alff@oracle.com>
    branch nick: mysql-trunk-wl5461
    timestamp: Fri 2011-11-18 17:02:25 +0100
    message:
      Merge mysql-trunk --> mysql-trunk-wl5461
    ------------------------------------------------------------
    revno: 3402.13.20
    committer: Christopher Powers <chris.powers@oracle.com>
    branch nick: mysql-trunk-wl5461
    timestamp: Thu 2011-11-17 16:02:03 -0600
    message:
      WL#5461 PERFORMANCE_SCHEMA MY.CNF Default Setup
      
      Update mysqld--help-notwin testcase
    ------------------------------------------------------------
    revno: 3402.13.19
    committer: Christopher Powers <chris.powers@oracle.com>
    branch nick: mysql-trunk-wl5461
    timestamp: Thu 2011-11-17 15:44:20 -0600
    message:
      WL#5461 PERFORMANCE_SCHEMA MY.CNF Default Setup
      
      Changes per code review:
      - Make new test cases platform- and compile option-generic
      - Issue warnings for invalid configuration options
      - Improve configuration option descriptions
      - Misc code tweaks
    ------------------------------------------------------------
    revno: 3402.13.18
    committer: Christopher Powers <chris.powers@oracle.com>
    branch nick: mysql-trunk-wl5461
    timestamp: Thu 2011-11-17 11:01:38 -0600
    message:
      WL#5461 PERFORMANCE_SCHEMA MY.CNF Defaults Setup
      
      setup_instruments_defaults.test
      - Remove SELECT on setup_instruments - inconsistent across platforms
    ------------------------------------------------------------
    revno: 3402.13.17 [merge]
    committer: Christopher Powers <chris.powers@oracle.com>
    branch nick: mysql-trunk-wl5461
    timestamp: Thu 2011-11-17 10:48:51 -0600
    message:
      local merge
    ------------------------------------------------------------
    revno: 3402.13.16 [merge]
    committer: Christopher Powers <chris.powers@oracle.com>
    branch nick: mysql-trunk-wl5461
    timestamp: Wed 2011-11-16 12:33:42 -0600
    message:
      local merge
    ------------------------------------------------------------
    revno: 3402.13.15
    committer: Christopher Powers <chris.powers@oracle.com>
    branch nick: mysql-trunk-wl5461
    timestamp: Wed 2011-11-16 12:32:09 -0600
    message:
      WL#5461 PERFORMANCE_SCHEMA MY.CNF Default Setup
      
      - Update for new regression test
    ------------------------------------------------------------
    revno: 3402.13.14 [merge]
    committer: Christopher Powers <chris.powers@oracle.com>
    branch nick: mysql-trunk-wl5461
    timestamp: Wed 2011-11-16 01:36:28 -0600
    message:
      merge with mysql-trunk
    ------------------------------------------------------------
    revno: 3402.13.13
    committer: Christopher Powers <chris.powers@oracle.com>
    branch nick: mysql-trunk-wl5461
    timestamp: Wed 2011-11-16 01:31:31 -0600
    message:
      WL#5461 PERFORMANCE_SCHEMA MY.CNF Default Setup
      
      - Suppress valgrind warnings caused by known race condition during shutdown
    ------------------------------------------------------------
    revno: 3402.13.12
    committer: Christopher Powers <chris.powers@oracle.com>
    branch nick: mysql-trunk-wl5461
    timestamp: Wed 2011-11-16 01:14:04 -0600
    message:
      WL#5461 PERFORMANCE_SCHEMA MY.CNF Default Setup
      
      - Updated Windows test
    ------------------------------------------------------------
    revno: 3402.13.11
    committer: Christopher Powers <chris.powers@oracle.com>
    branch nick: mysql-trunk-wl5461
    timestamp: Wed 2011-11-16 01:05:50 -0600
    message:
      WL#5461 PERFORMANCE_SCHEMA MY.CNF Default Setup
      
      Added test cases to verify the new cnf options:
      - setup_instruments_defaults
      - setup_consumers_defaults
    ------------------------------------------------------------
    revno: 3402.13.10
    committer: Christopher Powers <chris.powers@oracle.com>
    branch nick: mysql-trunk-wl5461
    timestamp: Tue 2011-11-15 19:01:44 -0600
    message:
      WL#5461 PERFORMANCE_SCHEMA MY.CNF Default Setup
      
      Changes per code review:
      - Support event name wildcards for performance_schema_instrument config option
      - Move my_getopt.c reformatting to separate commit
      - Handle default configuration for global events: idle, table io, table locks
      - Enable all instruments in default_mysqld.cnf
    ------------------------------------------------------------
    revno: 3402.13.9
    committer: Christopher Powers <chris.powers@oracle.com>
    branch nick: mysql-trunk-wl5461
    timestamp: Tue 2011-11-08 21:49:18 -0600
    message:
      WL#5461 PERFORMANCE_SCHEMA MY.CNF Default Setup
      
      - Replaced strnicmp() with strncmp()
      - Comment change
    ------------------------------------------------------------
    revno: 3402.13.8 [merge]
    committer: Christopher Powers <chris.powers@oracle.com>
    branch nick: mysql-trunk-wl5461
    timestamp: Tue 2011-11-08 19:38:37 -0600
    message:
      WL#5461 PERFORMANCE_SCHEMA MY.CNF Default Setup
      
      - Merged with mysql-trunk
      - Updated implementation
    ------------------------------------------------------------
    revno: 3402.13.7
    committer: Christopher Powers <chris.powers@oracle.com>
    branch nick: mysql-trunk-wl5461
    timestamp: Sun 2011-11-06 00:19:53 -0500
    message:
      WL#5461 PERFORMANCE_SCHEMA MY.CNF Default Setup
      
      Second phase of prototype with support for the following
      configuration option:
      
        pfs_instrument = '<instrument name> = <ON|TRUE|1|ENABLED|OFF|FALSE|0|DISABLED|COUNTED>'
      
      where
          ON = TRUE = 1 = ENABLED
      and
          OFF = FALSE = 0 = DISABLED
      and where
          ON  = timed, counted
          OFF = not timed, not counted
          COUNTED = not timed, counted
      
      This option is read-only. The effect of the option can only
      be seen in the SETUP_INSTRUMENTS table. It is not visible via
      SHOW GLOBAL VARIABLES. 
    ------------------------------------------------------------
    revno: 3402.13.6
    committer: Christopher Powers <chris.powers@oracle.com>
    branch nick: mysql-trunk-wl5461
    timestamp: Wed 2011-11-02 16:31:56 -0500
    message:
      WL#5461 PERFORMANCE_SCHEMA MY.CNF Default Setup
      
      Line endings, comment change
    ------------------------------------------------------------
    revno: 3402.13.5
    committer: Christopher Powers <chris.powers@oracle.com>
    branch nick: mysql-trunk-wl5461
    timestamp: Wed 2011-11-02 15:43:37 -0500
    message:
      WL#5461 PERFORMANCE_SCHEMA MY.CNF Default Setup
      
      Preliminary implementation for SETUP_CONSUMERS defaults.
    ------------------------------------------------------------
    revno: 3402.13.4 [merge]
    committer: Christopher Powers <chris.powers@oracle.com>
    branch nick: mysql-trunk-wl5461
    timestamp: Wed 2011-11-02 11:03:44 -0500
    message:
      downmerge with mysql-trunk
    ------------------------------------------------------------
    revno: 3402.13.3 [merge]
    committer: Marc Alff <marc.alff@oracle.com>
    branch nick: mysql-trunk-wl5461
    timestamp: Wed 2011-10-26 01:25:08 +0200
    message:
      Merge mysql-trunk --> mysql-trunk-wl5461
    ------------------------------------------------------------
    revno: 3402.13.2 [merge]
    committer: Marc Alff <marc.alff@oracle.com>
    branch nick: mysql-trunk-wl5461
    timestamp: Thu 2011-10-06 15:21:36 +0200
    message:
      Merge mysql-trunk --> mysql-trunk-wl5461
    ------------------------------------------------------------
    revno: 3402.13.1
    committer: Marc Alff <marc.alff@oracle.com>
    branch nick: mysql-trunk-wl5461
    timestamp: Mon 2011-08-29 21:40:42 +0200
    message:
      New branch
------------------------------------------------------------
revno: 3649 [merge]
committer: Jimmy Yang <jimmy.yang@oracle.com>
branch nick: trunk3
timestamp: Tue 2011-11-22 07:25:52 -0800
message:
  Merge mysql-5.5 to mysql-trunk
    ------------------------------------------------------------
    revno: 2875.321.43
    tags: clone-5.5.19-build
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-5.5
    timestamp: Tue 2011-11-22 07:06:19 -0800
    message:
      Disable innodb_corrupt_bit.test on windows, issues with
      innodb_change_buffering_debug prevents creating the Dup Key scenario on
      windows
------------------------------------------------------------
revno: 3648 [merge]
committer: Vasil Dimov <vasil.dimov@oracle.com>
branch nick: mysql-trunk
timestamp: Tue 2011-11-22 16:45:34 +0200
message:
  Merge mysql-5.5 -> mysql-trunk
    ------------------------------------------------------------
    revno: 2875.321.42
    committer: Vasil Dimov <vasil.dimov@oracle.com>
    branch nick: mysql-5.5
    timestamp: Mon 2011-11-21 15:26:24 +0200
    message:
      Followup to vasil.dimov@oracle.com-20111118115710-1xlezv0nbjz6s2ps
      Fix merge issues after discussing with Marko.
------------------------------------------------------------
revno: 3647
committer: Vasil Dimov <vasil.dimov@oracle.com>
branch nick: mysql-trunk
timestamp: Tue 2011-11-22 16:00:53 +0200
message:
  Fix gcc compilation warnings about set but unused variables.
  
  These variables are used, but only inside ut_ad() so in non-debug
  builds we get a warning. Another way to fix this would be to use
  ut_a() instead of ut_ad().
  
  Discussed with:	Jimmy
------------------------------------------------------------
revno: 3646
committer: Ashish Agarwal<ashish.y.agarwal@oracle.com>
branch nick: b_t_213
timestamp: Tue 2011-11-22 19:12:28 +0530
message:
  bug#11760213 - 52599: ALTER TABLE REMOVE PARTITIONING ON
                        NON-PARTITIONED TABLE CORRUPTS MYISAM.
  
  NOTE: This is a followup patch to fix a failing
        test case.
------------------------------------------------------------
revno: 3645 [merge]
committer: Jon Olav Hauglid <jon.hauglid@oracle.com>
branch nick: mysql-trunk-test
timestamp: Tue 2011-11-22 14:18:58 +0100
message:
  Null merge from mysql-5.5 to mysql-trunk
    ------------------------------------------------------------
    revno: 2875.321.41 [merge]
    committer: Jon Olav Hauglid <jon.hauglid@oracle.com>
    branch nick: mysql-5.5-test
    timestamp: Tue 2011-11-22 14:17:19 +0100
    message:
      Null merge from mysql-5.1 to mysql-5.5
        ------------------------------------------------------------
        revno: 2661.809.59
        committer: Jon Olav Hauglid <jon.hauglid@oracle.com>
        branch nick: mysql-5.1-test
        timestamp: Tue 2011-11-22 14:16:13 +0100
        message:
          Disabling main.query_cache_28249.test since this test fails
          sporadically on 5.1. See Bug#12584161.
          
          Test runs successfully on 5.5/trunk, so this changeset will
          be null-merged.
------------------------------------------------------------
revno: 3644 [merge]
committer: Jorgen Loland <jorgen.loland@oracle.com>
branch nick: mysql-trunk
timestamp: Tue 2011-11-22 13:33:41 +0100
message:
  Automerge opt-team -> trunk
    ------------------------------------------------------------
    revno: 2876.249.438 [merge]
    committer: Jorgen Loland <jorgen.loland@oracle.com>
    branch nick: mysql-next-mr-opt-team
    timestamp: Mon 2011-11-21 14:52:44 +0100
    message:
      Merge opt-backporting -> opt-team
      Manually fixed test output from derived.test (cause: semijoin 
      not enabled in opt-team)
        ------------------------------------------------------------
        revno: 2876.466.21
        committer: Roy Lyseng <roy.lyseng@oracle.com>
        branch nick: mysql-sb5
        timestamp: Fri 2011-11-18 11:33:08 +0100
        message:
          Bug#13339643: Assertion in JOIN::flatten_subqueries on second execution
          
          Bug#11764757 (former 57623) introduced a DBUG_ASSERT, assuming that a
          join_nest containing a nested join never had the prep_on_expr field set
          when flattening subqueries. Thus, the permanent transformation of this
          field could not be done here, but was postponed to simplify_joins().
          
          However, this bug shows that in the case of a viewed table, the
          join_nest contains a nested join, and prep_on_expr is already set.
          Thus, the assertion is proven wrong, and it should be removed.
          
          mysql-test/include/subquery_sj.inc
            Added test case for bug#13339643
          
          mysql-test/r/subquery_sj_all.result
          mysql-test/r/subquery_sj_all_bka.result
          mysql-test/r/subquery_sj_all_bka_nixbnl.result
          mysql-test/r/subquery_sj_all_bkaunique.result
          mysql-test/r/subquery_sj_dupsweed.result
          mysql-test/r/subquery_sj_dupsweed_bka.result
          mysql-test/r/subquery_sj_dupsweed_bka_nixbnl.result
          mysql-test/r/subquery_sj_dupsweed_bkaunique.result
          mysql-test/r/subquery_sj_firstmatch.result
          mysql-test/r/subquery_sj_firstmatch_bka.result
          mysql-test/r/subquery_sj_firstmatch_bka_nixbnl.result
          mysql-test/r/subquery_sj_firstmatch_bkaunique.result
          mysql-test/r/subquery_sj_loosescan.result
          mysql-test/r/subquery_sj_loosescan_bka.result
          mysql-test/r/subquery_sj_loosescan_bka_nixbnl.result
          mysql-test/r/subquery_sj_loosescan_bkaunique.result
          mysql-test/r/subquery_sj_mat.result
          mysql-test/r/subquery_sj_mat_bka.result
          mysql-test/r/subquery_sj_mat_bka_nixbnl.result
          mysql-test/r/subquery_sj_mat_bkaunique.result
          mysql-test/r/subquery_sj_mat_nosj.result
          mysql-test/r/subquery_sj_none.result
          mysql-test/r/subquery_sj_none_bka.result
          mysql-test/r/subquery_sj_none_bka_nixbnl.result
          mysql-test/r/subquery_sj_none_bkaunique.result
            Added test case results for bug#13339643
          
          sql/sql_select.cc
            Removed DBUG_ASSERT that failed when view was specified.
        ------------------------------------------------------------
        revno: 2876.466.20
        committer: Roy Lyseng <roy.lyseng@oracle.com>
        branch nick: mysql-sb1
        timestamp: Mon 2011-11-14 11:48:09 +0100
        message:
          Bug#13383857: Another crash in memcpy from join_cache::write_record_data
          
          This is a similar case as bug#13106350, except that the derived table
          here has join buffering enabled. When materializing the table in this
          case, setting up buffers for copying of current rowid was omitted.
          
          The fix moves materialization check from join_matching_records()
          to sub_select_cache() and adds setup of buffers for copying of
          current rowid.
          
          mysql-test/t/derived.test
            Added test case for bug#13383857.
          
          mysql-test/r/derived.result
            Added test case results for bug#13383857.
          
          sql/join_cache.cc
            materialization of derived tables is moved into sub_select_cache().
          
          sql/sql_select.cc
            In sub_select_cache(), materialize derived table when needed
            and set up buffers for copying of current rowid.
        ------------------------------------------------------------
        revno: 2876.466.19
        committer: Jorgen Loland <jorgen.loland@oracle.com>
        branch nick: mysql-next-mr-opt-backporting
        timestamp: Mon 2011-11-14 09:16:08 +0100
        message:
          Previous merge missed Sergey Glukhov's fix for func_analyse.test.
          Manually fixing test.
        ------------------------------------------------------------
        revno: 2876.466.18
        committer: Jorgen Loland <jorgen.loland@oracle.com>
        branch nick: mysql-next-mr-opt-backporting
        timestamp: Fri 2011-11-11 15:30:08 +0100
        message:
          Recorded result files after merge mysql-trunk -> opt-backporting.
    ------------------------------------------------------------
    revno: 2876.249.437 [merge]
    committer: Jorgen Loland <jorgen.loland@oracle.com>
    branch nick: mysql-next-mr-opt-team
    timestamp: Mon 2011-11-21 14:27:11 +0100
    message:
      Null-merge opt-backporting ->opt-team
        ------------------------------------------------------------
        revno: 2876.466.17 [merge]
        committer: Jorgen Loland <jorgen.loland@oracle.com>
        branch nick: mysql-next-mr-opt-backporting
        timestamp: Fri 2011-11-11 13:49:36 +0100
        message:
          Null-merge mysql-trunk -> opt-backporting
    ------------------------------------------------------------
    revno: 2876.249.436 [merge]
    committer: Jorgen Loland <jorgen.loland@oracle.com>
    branch nick: mysql-next-mr-opt-team
    timestamp: Mon 2011-11-21 14:25:28 +0100
    message:
      Empty merge opt-backporting -> opt-team
        ------------------------------------------------------------
        revno: 2876.466.16 [merge]
        committer: Jorgen Loland <jorgen.loland@oracle.com>
        branch nick: mysql-next-mr-opt-backporting
        timestamp: Fri 2011-11-11 13:46:30 +0100
        message:
          Automerge mysql-trunk -> opt-backporting.
    ------------------------------------------------------------
    revno: 2876.249.435 [merge]
    committer: Jorgen Loland <jorgen.loland@oracle.com>
    branch nick: mysql-next-mr-opt-team
    timestamp: Fri 2011-11-11 13:47:38 +0100
    message:
      Automerge mysql-trunk -> opt-team
    ------------------------------------------------------------
    revno: 2876.249.434 [merge]
    committer: Jorgen Loland <jorgen.loland@oracle.com>
    branch nick: mysql-next-mr-opt-team
    timestamp: Fri 2011-11-11 13:46:05 +0100
    message:
      Automerge mysql-trunk -> opt-team.
------------------------------------------------------------
revno: 3643
committer: Vasil Dimov <vasil.dimov@oracle.com>
branch nick: mysql-trunk
timestamp: Tue 2011-11-22 14:20:21 +0200
message:
  Fix a compilation warning about comparison between signed and unsigned
  inside UNIV_STATS_DEBUG, also use UINT64PF for printing ib_uint64_t
  variables.
  
  Spotted by:	Marko
------------------------------------------------------------
revno: 3642 [merge]
committer: Marko M?kel? <marko.makela@oracle.com>
branch nick: mysql-trunk
timestamp: Tue 2011-11-22 13:21:45 +0200
message:
  Merge mysql-5.5 to mysql-trunk.
    ------------------------------------------------------------
    revno: 2875.321.40
    committer: Marko M?kel? <marko.makela@oracle.com>
    branch nick: mysql-5.5
    timestamp: Tue 2011-11-22 13:14:55 +0200
    message:
      Bug#13340047 LATCHING ORDER VIOLATION IN IBUF_SET_ENTRY_COUNTER() - cleanup
      
      Remove btr_cur_t::ibuf_cnt. The only dependence on cursor->ibuf_cnt
      was ibuf_set_entry_counter(). That code path was removed in the
      original bug fix (marko.makela@oracle.com-20111107072802-dgwagejlpub0rjkd).
      
      rb:819 approved by Jimmy Yang
------------------------------------------------------------
revno: 3641 [merge]
committer: Sneha Modi<sneha.modi@oracle.com>
branch nick: mysql-trunk
timestamp: Tue 2011-11-22 16:27:11 +0530
message:
  Null merge of fix for Bug#11748731 from mysql-5.5 -> mysql-trunk
    ------------------------------------------------------------
    revno: 2875.321.39
    committer: Sneha Modi<sneha.modi@oracle.com>
    branch nick: mysql-5.5
    timestamp: Mon 2011-11-21 17:07:08 +0530
    message:
      Bug#11748731:SOME 'BIG' TESTS FAILING ON 6.0 
      
      A patch for alter_table-big.test has been committed earlier.
      This is a patch for create-big.test:
      The test used to time-out after 900 seconds. 
      It relied on debug sleeps that are no longer present in the 
      code. Since the sleeps are long gone, fixing the problem didn't 
      involve just updating the result file or using macro 
      "show_binlog_events2.inc" instead of "show binlog events" 
      statement. The test needed to be rewritten using debug sync 
      points, and result then needed to be updated.
      So, the sleeps have been replaced by debug_sync points and the test execution time has 
      been reduced significantly.
------------------------------------------------------------
revno: 3640
committer: Olav Sandstaa <olav.sandstaa@oracle.com>
branch nick: itemref-regr
timestamp: Tue 2011-11-22 11:48:41 +0100
message:
  Fix for Bug#13102033 CRASH IN COPY_FUNCS IN SQL_SELECT.CC ON JOIN + GROUP BY
                       + ORDER BY
        
  This crash occurred in the function copy_funcs() due to the array of
  functions pointers was not correctly terminated. This caused data
  following the func_ptr array to be interpreted as pointers to
  functions/items. The funct_ptr array given to copy_funcs() is stored
  inside the join's tmp_table_param structure's member called items_to_copy.
  In this case we had added one more entry than we had allocated space for
  so the value of the last entry was a pointer to a real item instead of a
  NULL pointer. The reason for why an extra pointer was added:
  
  1. When preparing the query we create Item objects for the where,
     group by and order by conditions. Since this query involves a view 
     several of these will be subclasses of Item_ref. In the function
     create_view_field() we create three Item_direct_view_ref
     objects representing the "v1.i2" for the two instances in the where
     clause and one for the order by clause. What is important to
     notice is that three separate Item_direct_view_ref objects are
     created but the ref pointer of all these points to a common
     (Item*) variable (which again points to the actual Item_field object).
  
  2. When optimizing the query we call optimize_conds() which will
     build_equal_items and among other things substitute fields with
     constants where possible. In this query it will use that "v1.i2 =
     211" to replace "v1.i2 > 7" with "211 > 7". To do this replacement
     it will use the Item class' compile and transform functions. The
     v1.i2 is represented by a subclass of Item_ref. The current code
     for Item_ref::compile() will first compile the item object found
     through the ref pointer. This will cause the field "i2" to be
     replaced by the constant field "211". Because of this the next step
     done by Item_ref::compile() is to replace the content in the ref* 
     variable to point to this constant field. This gives the correct 
     result for the item three that is being optimized but it causes an
     inconsistency for the ORDER BY clause. Since the
     Item_direct_view_ref created for the ORDER BY clause points to the
     same (Item*) variable as for the Item_direct_view_ref in the where
     clause, the update of the ref* in the Item_direct_view_ref of the
     where clause will also cause the same change to be done to the
     ORDER BY clause. So the result from running optimize_conds() is
     that the ORDER BY clause has been changed from "v1.i2" to the
     constant "211".
  
  3. When creating the temporary table used for the ORDER BY we will use
     the updated Item_direct_view_ref object that now points to the
     constant "211". Since this is a constant we do not allocate space
     for it in the items_to_copy array but still insert it into the
     array (causing the terminating NULL value to be written outside of
     the allocated array).
  
  Summary of the bug: Item_ref's compile() and transform() functions
  update the ref* variable when the item they reference changes. The
  ref* can be shared between multiple Item_ref objects. This causes all
  other Item_ref objects that share the common ref* variable to be
  wrongly updated.
  
  The fix is to change Item_ref's compile() and transform() functions to
  not update the ref* variable but instead they will return the new
  object as the result of the compile() or transform() operation.  The
  result of this change will be that when the object that the Item_ref
  references is replaced, the entire Item_ref objects will be replaced
  by the new object instead of doing changes to the Item_ref's ref
  pointer.
  
  The original substitution is wrong in yet another situation: If we have 
  two conditions combined with OR, substituting one field reference in one
  of the conditions would actually replace the same field in the second
  conditions, potentially causing a wrong result.
------------------------------------------------------------
revno: 3639
committer: Andrei Elkin <andrei.elkin@oracle.com>
branch nick: wl5569-mts-trunk-for-bugfixing
timestamp: Tue 2011-11-22 11:45:19 +0200
message:
  bug#12982188 post-push fixing a test result file.
------------------------------------------------------------
revno: 3638
committer: Jimmy Yang <jimmy.yang@oracle.com>
branch nick: trunk2
timestamp: Tue 2011-11-22 00:36:33 -0800
message:
  Fix an issue that FTS parallel sort merge's event signal got lost situation.
  Add timeout for checking the merge result.
------------------------------------------------------------
revno: 3637
committer: Tor Didriksen <tor.didriksen@oracle.com>
branch nick: trunk
timestamp: Tue 2011-11-22 08:37:20 +0100
message:
  Remove -fno-exceptions from CXX flags
------------------------------------------------------------
revno: 3636
committer: Tor Didriksen <tor.didriksen@oracle.com>
branch nick: trunk
timestamp: Tue 2011-11-22 08:26:02 +0100
message:
  WL#6012 - Use the same compiler for InnoDB as the server (C++)
  
  Post-push fix, ftsparse(void*) rather than ftsparse()
------------------------------------------------------------
revno: 3635
committer: Sunny Bains <Sunny.Bains@Oracle.Com>
branch nick: trunk
timestamp: Tue 2011-11-22 18:27:55 +1100
message:
  Make the test deterministic by ordering the output on trx_query.
------------------------------------------------------------
revno: 3634
committer: Ashish Agarwal<ashish.y.agarwal@oracle.com>
branch nick: b_t_213
timestamp: Tue 2011-11-22 11:15:59 +0530
message:
  BUG#11760213 - 52599: ALTER TABLE REMOVE PARTITIONING ON
                        NON-PARTITIONED TABLE CORRUPTS MYISAM.
  
  NOTE: A test was failing, so this is a followup
        patch to fix it.
------------------------------------------------------------
revno: 3633
committer: Jimmy Yang <jimmy.yang@oracle.com>
branch nick: trunk2
timestamp: Mon 2011-11-21 20:48:55 -0800
message:
  Modify innodb-fts-stopword.test and innodb_fts_transaction.test to
  add wait_until_disconnected.inc after each connection disconnetion
------------------------------------------------------------
revno: 3632 [merge]
committer: Sunny Bains <Sunny.Bains@Oracle.Com>
branch nick: trunk
timestamp: Tue 2011-11-22 13:51:00 +1100
message:
  WL#6012 - Use the same compiler for InnoDB as the server (C++)
  
   1. Enum rules are different in C++ from C. We have abused enums in C code by 
      ORring them. Add static casts to get around these violations.
  
   2. Add static casts to convert between void* to specific types.
  
   3. InnoDB has som OOish idioms for the parser and query code. Add static casts 
      for the pointer conversions for the YACC and LEX code.
  
   4. Rename all *.c files to *.cc, this preserves the history.
  
   5. Remove the 'extern "C" {}' linkage specifier
  
   6. The thread create functions required C linkage
  
   7. Rewrite UT_LIST* as a template based C++ list type.
  
  There is no ReviewBoard entry for this. Approved by Jimmy and Marko in the WL.
    ------------------------------------------------------------
    revno: 2876.468.207
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: cpp-fts
    timestamp: Tue 2011-11-22 11:35:48 +1100
    message:
      Change the linkage to 'extern "C"'.
    ------------------------------------------------------------
    revno: 2876.468.206 [merge]
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: cpp-fts
    timestamp: Tue 2011-11-22 10:33:14 +1100
    message:
      Merge from mysql-trunk.
    ------------------------------------------------------------
    revno: 2876.468.205 [merge]
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: cpp-fts
    timestamp: Tue 2011-11-22 08:49:54 +1100
    message:
      Merge from mysql-trunk.
    ------------------------------------------------------------
    revno: 2876.468.204 [merge]
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: cpp-fts
    timestamp: Mon 2011-11-21 15:58:23 +1100
    message:
      Merge from mysql-trunk.
      Fix conflicts due to merge.
    ------------------------------------------------------------
    revno: 2876.468.203 [merge]
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: cpp-fts
    timestamp: Mon 2011-11-21 11:04:40 +1100
    message:
      Merge from mysql-trunk.
    ------------------------------------------------------------
    revno: 2876.468.202 [merge]
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: cpp-fts
    timestamp: Mon 2011-11-21 07:17:41 +1100
    message:
      Remove assertion, field->data can be uninitialised the first time.
    ------------------------------------------------------------
    revno: 2876.468.201 [merge]
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: cpp-fts
    timestamp: Sat 2011-11-19 07:44:23 +1100
    message:
      Merge from mysql-trunk.
    ------------------------------------------------------------
    revno: 2876.468.200
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: cpp-fts
    timestamp: Fri 2011-11-18 15:55:35 +1100
    message:
      alocator must be initialised before the heap.
    ------------------------------------------------------------
    revno: 2876.468.199
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: cpp-fts
    timestamp: Fri 2011-11-18 15:13:53 +1100
    message:
      Tidy up the code.
      Set fts_string_t::f_n_char to 0 and copy the value when copying types.
    ------------------------------------------------------------
    revno: 2876.468.198
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: cpp-fts
    timestamp: Fri 2011-11-18 14:50:54 +1100
    message:
      Set fts_string_t::f_n_char to 0.
    ------------------------------------------------------------
    revno: 2876.468.197
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: cpp-fts
    timestamp: Fri 2011-11-18 14:46:48 +1100
    message:
      Tidy up the code, fix whitespace.
    ------------------------------------------------------------
    revno: 2876.468.196
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: cpp-fts
    timestamp: Fri 2011-11-18 14:44:10 +1100
    message:
      Set fts_string_t::f_n_char to 0.
    ------------------------------------------------------------
    revno: 2876.468.195
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: cpp-fts
    timestamp: Fri 2011-11-18 14:42:07 +1100
    message:
      Tidy up the code.
    ------------------------------------------------------------
    revno: 2876.468.194
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: cpp-fts
    timestamp: Fri 2011-11-18 14:39:00 +1100
    message:
      Initialise fts_string_t::f_n_char to 0.
      Tidy up the code.
    ------------------------------------------------------------
    revno: 2876.468.193
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: cpp-fts
    timestamp: Fri 2011-11-18 14:35:03 +1100
    message:
      Initialise fts_string_t::f_n_char to 0
      Reduce scope of local variables.
      Tidy up the code.
    ------------------------------------------------------------
    revno: 2876.468.192
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: cpp-fts
    timestamp: Fri 2011-11-18 14:27:00 +1100
    message:
      Make fts_cache_add_doc() static.
    ------------------------------------------------------------
    revno: 2876.468.191
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: cpp-fts
    timestamp: Fri 2011-11-18 14:23:01 +1100
    message:
      Copy the entire fts_string_t contents.
    ------------------------------------------------------------
    revno: 2876.468.190
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: cpp-fts
    timestamp: Fri 2011-11-18 14:17:42 +1100
    message:
      Fix whitespace.
      Change coding style to InnoDB style in ha_innodb.cc
      Remove unused functions.
      Move prototypes of MySQL helper functions to ha_prototypes.h
    ------------------------------------------------------------
    revno: 2876.468.189
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: cpp-fts
    timestamp: Fri 2011-11-18 14:01:03 +1100
    message:
      Remove bogus assertion.
    ------------------------------------------------------------
    revno: 2876.468.188 [merge]
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: cpp-fts
    timestamp: Fri 2011-11-18 13:59:41 +1100
    message:
      Merge from mysql-trunk.
    ------------------------------------------------------------
    revno: 2876.468.187 [merge]
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: cpp-fts
    timestamp: Thu 2011-11-17 22:20:13 +1100
    message:
      Merge from mysql-trunk.
    ------------------------------------------------------------
    revno: 2876.468.186
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: cpp-fts
    timestamp: Thu 2011-11-17 17:02:53 +1100
    message:
      Remove uneccessary memset()
      Fix some formatting.
      Fix some casts.
    ------------------------------------------------------------
    revno: 2876.468.185 [merge]
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: cpp-fts
    timestamp: Thu 2011-11-17 11:20:31 +1100
    message:
      Merge --weave from mysql-trunk.
    ------------------------------------------------------------
    revno: 2876.468.184
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: cpp-fts
    timestamp: Thu 2011-11-17 11:17:28 +1100
    message:
      Fix build errors and some formatting.
    ------------------------------------------------------------
    revno: 2876.468.183 [merge]
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Wed 2011-11-16 07:31:08 -0800
    message:
      Merge mysql-trunk-innodb-c++ into mysql-5.6-labs-innodb-fts and then cross
      weave merge with changes in mysql-trunk-innodb-c++fts.
        ------------------------------------------------------------
        revno: 3394.3.4 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Wed 2011-11-16 17:13:31 +1100
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.3.3 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Wed 2011-11-16 10:14:22 +1100
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.3.2 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Tue 2011-11-15 10:58:38 +1100
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.3.1 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Mon 2011-11-14 07:34:47 +1100
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.87
        committer: Jimmy Yang <jimmy.yang@oracle.com>
        branch nick: c+fts
        timestamp: Tue 2011-11-15 03:10:00 -0800
        message:
          Fix a merge error in fts_query_strcmp().
        ------------------------------------------------------------
        revno: 3394.2.86
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: cpp-fts
        timestamp: Mon 2011-11-14 09:02:51 +1100
        message:
          Force the invariant.
        ------------------------------------------------------------
        revno: 3394.2.85
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: cpp-fts
        timestamp: Mon 2011-11-14 08:56:30 +1100
        message:
          Fix assertion in handler0alter.cc, check the table flags along with n_fields.
          Fix a bug in row0merge.cc. The field value was being set from the stack that
          Rearrange some code around the bug fix.
          goes out of scope within the function.
          Change mac_write_to_8() first parameter to a void*.
        ------------------------------------------------------------
        revno: 3394.2.84
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: cpp-fts
        timestamp: Sat 2011-11-12 17:24:55 +1100
        message:
          Regenerate the lexer and parser.
          Fix the YYINPUT macro to use the return value.
        ------------------------------------------------------------
        revno: 3394.2.83
        committer: Jimmy Yang <jimmy.yang@oracle.com>
        branch nick: c+fts
        timestamp: Fri 2011-11-11 22:03:49 -0800
        message:
          Correct Version String
        ------------------------------------------------------------
        revno: 3394.2.82
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: cpp-fts
        timestamp: Sat 2011-11-12 11:34:04 +1100
        message:
          Fix build errors and warnings.
          Change %llu to 64bit format string.
          Fix function signatures, get rid of ullint, replace with ib_id_t.
          Add fts0priv.ic
          Move UNIV_UNUSED out of the blanket check for innodb compiler hints.
        ------------------------------------------------------------
        revno: 3394.2.81
        committer: Jimmy Yang <jimmy.yang@oracle.com>
        branch nick: c+fts
        timestamp: Fri 2011-11-11 08:32:08 -0800
        message:
          Use FTS's pars0grm.y and pars0pars.cc
        ------------------------------------------------------------
        revno: 3394.2.80
        committer: Jimmy Yang <jimmy.yang@oracle.com>
        branch nick: c+fts
        timestamp: Fri 2011-11-11 04:22:05 -0800
        message:
          Resolve link issue on fts0pars.cc
        ------------------------------------------------------------
        revno: 3394.2.79
        committer: Jimmy Yang <jimmy.yang@oracle.com>
        branch nick: c+fts
        timestamp: Fri 2011-11-11 02:06:05 -0800
        message:
          Add row0ftsort.c file
        ------------------------------------------------------------
        revno: 3394.2.78
        committer: Jimmy Yang <jimmy.yang@oracle.com>
        branch nick: c+fts
        timestamp: Fri 2011-11-11 01:27:04 -0800
        message:
          Add missing function define in pars0pars.c
        ------------------------------------------------------------
        revno: 3394.2.77 [merge]
        committer: Jimmy Yang <jimmy.yang@oracle.com>
        branch nick: c+fts
        timestamp: Fri 2011-11-11 00:46:18 -0800
        message:
          merge mysql-trunk-innodb-c++ and mysql-5.6-labs-innodb-fts
        ------------------------------------------------------------
        revno: 3394.2.76 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Fri 2011-11-11 11:04:24 +1100
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.75 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Thu 2011-11-10 21:27:41 +1100
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.74 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Thu 2011-11-10 17:50:07 +1100
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.73 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Thu 2011-11-10 17:48:28 +1100
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.72
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Wed 2011-11-09 13:40:33 +1100
        message:
          Remove some compiler hints. They were causing a build failure on slid07 (OSX).
        ------------------------------------------------------------
        revno: 3394.2.71
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Wed 2011-11-09 09:24:59 +1100
        message:
          Get rid of the UT_LIST_MAP macro.
        ------------------------------------------------------------
        revno: 3394.2.70
        committer: Marko M?kel? <marko.makela@oracle.com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Tue 2011-11-08 23:55:49 +0200
        message:
          Break too long lines and adjust white space.
        ------------------------------------------------------------
        revno: 3394.2.69
        committer: Marko M?kel? <marko.makela@oracle.com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Tue 2011-11-08 23:45:43 +0200
        message:
          Add a mutex_own assertion.
        ------------------------------------------------------------
        revno: 3394.2.68 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Wed 2011-11-09 07:49:44 +1100
        message:
          Merge from mysql-trunk.
          Fix a compiler error in ibuf0ibuf.c.
        ------------------------------------------------------------
        revno: 3394.2.67
        committer: Marko M?kel? <marko.makela@oracle.com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Tue 2011-11-08 16:29:40 +0200
        message:
          Correct the @return comment of pars_get_lex_chars().
        ------------------------------------------------------------
        revno: 3394.2.66
        committer: Marko M?kel? <marko.makela@oracle.com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Tue 2011-11-08 16:14:27 +0200
        message:
          eval_func(): Replace if-else with switch.
        ------------------------------------------------------------
        revno: 3394.2.65
        committer: Marko M?kel? <marko.makela@oracle.com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Tue 2011-11-08 16:10:24 +0200
        message:
          Add white space around UINT64PF according to our convention.
        ------------------------------------------------------------
        revno: 3394.2.64
        committer: Marko M?kel? <marko.makela@oracle.com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Tue 2011-11-08 14:27:56 +0200
        message:
          Update copyright messages.
        ------------------------------------------------------------
        revno: 3394.2.63
        committer: Marko M?kel? <marko.makela@oracle.com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Tue 2011-11-08 12:32:23 +0200
        message:
          Update copyright statements and file names in comments.
          Restore UNIV_BTR_DEBUG.
        ------------------------------------------------------------
        revno: 3394.2.62 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Fri 2011-11-04 09:23:52 +1100
        message:
          Merge from mysql-trunk.
          Fix an issue in ut0lst.h debug code.
        ------------------------------------------------------------
        revno: 3394.2.61
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Thu 2011-11-03 12:47:55 +1100
        message:
          Fix inlime asm, save %ebx before calling cpuid and restore later. Save the
          returned value from cpuid in %ebx to %esi and use that to assign the output
          value.
        ------------------------------------------------------------
        revno: 3394.2.60 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Thu 2011-11-03 07:25:49 +1100
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.59 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Wed 2011-11-02 07:51:06 +1100
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.58 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Wed 2011-11-02 07:39:04 +1100
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.57 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Sat 2011-10-29 07:22:11 +1100
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.56 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Fri 2011-10-28 16:53:46 +1100
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.55
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Wed 2011-10-26 13:51:53 +1100
        message:
          Use pointer to member instead of offset into structure.
          Move the validate functors to buf0buf.h.
        ------------------------------------------------------------
        revno: 3394.2.54
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Tue 2011-10-25 15:03:50 +1100
        message:
          Get rid of unnecessary casts.
          Use PRIu64 etc. from C99, on Windows use the Visual Studio specific format.
          Use integer type from inttypes.h and on Windows use Visual Studio types.
        ------------------------------------------------------------
        revno: 3394.2.53
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Tue 2011-10-25 14:29:30 +1100
        message:
          Get rid of bogus comment.
        ------------------------------------------------------------
        revno: 3394.2.52
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Tue 2011-10-25 14:27:10 +1100
        message:
          pars_get_lex_chars() returns the number of characters copied.
          Get rid of the "out" parameter and use the returned value in lexyy.cc.
        ------------------------------------------------------------
        revno: 3394.2.51 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Tue 2011-10-25 11:56:08 +1100
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.50 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Mon 2011-10-24 08:10:52 +1100
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.49 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Thu 2011-10-20 10:07:36 +1100
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.48 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Wed 2011-10-19 18:36:42 +1100
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.47 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Wed 2011-09-28 10:10:43 +1000
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.46 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Tue 2011-09-27 07:51:31 +1000
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.45 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Mon 2011-09-26 12:16:57 +1000
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.44 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Fri 2011-09-23 09:35:02 +1000
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.43 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Thu 2011-09-22 06:45:57 +1000
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.42 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Wed 2011-09-21 16:28:35 +1000
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.41 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Tue 2011-09-20 07:37:30 +1000
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.40 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Fri 2011-09-16 12:46:45 +1000
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.39 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Thu 2011-09-15 07:35:19 +1000
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.38 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Thu 2011-09-15 07:32:16 +1000
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.37 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Thu 2011-09-08 10:47:34 +1000
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.36 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Wed 2011-09-07 15:36:08 +1000
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.35 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Tue 2011-09-06 07:07:20 +1000
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.34
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Fri 2011-09-02 14:51:36 +1000
        message:
          Cast the start function argument to os_thread_create() to a os_thread_func_t.
        ------------------------------------------------------------
        revno: 3394.2.33 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Fri 2011-09-02 07:47:23 +1000
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.32
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Fri 2011-09-02 07:45:31 +1000
        message:
          Add missing DECLARE_THREAD around start functions.
        ------------------------------------------------------------
        revno: 3394.2.31 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Thu 2011-09-01 22:06:35 +1000
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.30
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Thu 2011-09-01 22:04:28 +1000
        message:
          Add DECLARE_THREAD macro for Windows specific declarations.
        ------------------------------------------------------------
        revno: 3394.2.29
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Thu 2011-09-01 17:23:16 +1000
        message:
          Fix a bug introduced in a previous commit. In a previous commit I had changed
          the type of srv_mysql50_table_name_prefix from char[9] to char*. It should
          be char[10]. Make the appropriate adjustment in code that referes to this
          variable.
        ------------------------------------------------------------
        revno: 3394.2.28 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Thu 2011-09-01 09:34:07 +1000
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.27
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Wed 2011-08-31 14:50:35 +1000
        message:
          Fix compilation errors for the UNIV_DEBUG case.
        ------------------------------------------------------------
        revno: 3394.2.26 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Wed 2011-08-31 11:09:44 +1000
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.25 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Tue 2011-08-30 19:06:15 +1000
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.24
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Tue 2011-08-30 08:00:39 +1000
        message:
          Undo unrelated change.
        ------------------------------------------------------------
        revno: 3394.2.23
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Tue 2011-08-30 07:54:05 +1000
        message:
          Make UT_LIST_* macros into template based inline functions.
          Use a functor to create the read view snapshot.
          Add -fno-exceptions to the CMAKE_CXX_FLAGS
        ------------------------------------------------------------
        revno: 3394.2.22 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Tue 2011-08-30 06:50:31 +1000
        message:
          Merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 3394.2.21 [merge]
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Mon 2011-08-29 10:57:25 +1000
        message:
          Merge from mysql-trunk. Made some change to compile the code with C++.
          Renamed .c files to .cc.
          Fixed link errors.
        ------------------------------------------------------------
        revno: 3394.2.20
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Sat 2011-08-27 09:04:32 +1000
        message:
          Remove the vestige of timed_mutexes for the UNIV_DEBUG case.
        ------------------------------------------------------------
        revno: 3394.2.19
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Fri 2011-08-26 15:45:28 +1000
        message:
          Remove unused variables.
        ------------------------------------------------------------
        revno: 3394.2.18
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Fri 2011-08-26 13:06:08 +1000
        message:
          Declare pthread_create() start functions with C linkage.
          Fix the yylex() macro so that it doesn't take any argument. SunProCC gave
          a warning even though it is not used.
          Add os_thread_func_t with proper linkage.
          Not tested on Windows but there are some Windows related changes.
          Disable -Wconversion flag
          For the SunProCC version of UT_RELAX_CPU() use the asm("PAUSE") version of the
          syntax. Note the GCC specific __volatile__ was removed for the SunProCC version.
          Set C linkage for two callback functions used for Zip memory alloc/free.
        ------------------------------------------------------------
        revno: 3394.2.17
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Thu 2011-08-25 07:04:30 +1000
        message:
          Fix warnings reported by g++: 'warning: suggest a space before ?;? or explicit
          braces around empty body in ?while? statement'
          
          Added empty body.
        ------------------------------------------------------------
        revno: 3394.2.16
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Thu 2011-08-25 06:41:16 +1000
        message:
          Disable pre-fetch on Solaris.
        ------------------------------------------------------------
        revno: 3394.2.15
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Wed 2011-08-24 18:41:58 +1000
        message:
          The fix to make munmap() work on Solaris introduced a bug.
          Handle the #else case for when !__WIN and !OS_MAP_ANON.
        ------------------------------------------------------------
        revno: 3394.2.14
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Wed 2011-08-24 10:05:02 +1000
        message:
          Cast the pointer to caddr_t when UNIV_SOLARIS is defined. POSIX verson
          requires a void* argument. We default to no cast for non-Solaris platforms.
        ------------------------------------------------------------
        revno: 3394.2.13
        committer: Vasil Dimov <vasil.dimov@oracle.com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Tue 2011-08-23 10:46:16 +0300
        message:
          Fix all occurences of C source filenames after they were renamed to .cc
          E.g. replace fil0fil.c with fil0fil.cc all over the source.
        ------------------------------------------------------------
        revno: 3394.2.12
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Tue 2011-08-23 16:27:51 +1000
        message:
          reinterpret_cast<PLONG*>() should have been reinterpret_cast<PLONG>().
        ------------------------------------------------------------
        revno: 3394.2.11
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Tue 2011-08-23 16:09:09 +1000
        message:
          Change n_active and n_waiting to volatile lint.
          Use reinterpret_cast<PLONG*> for SetFilePointer's 3rd arg.
        ------------------------------------------------------------
        revno: 3394.2.10
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Tue 2011-08-23 13:22:24 +1000
        message:
          Enable -Wconversion in CMakeLists.txt.
          Fix warnings that are triggered by this flag.
          The only remaining warnings are from MySQL code in sql/field.h.
        ------------------------------------------------------------
        revno: 3394.2.9
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Tue 2011-08-23 13:09:24 +1000
        message:
          Replace the UT_MIN and UT_MAX macros with safer versions.
          Use "static inline" for all compilers".
        ------------------------------------------------------------
        revno: 3394.2.8
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Tue 2011-08-23 12:47:36 +1000
        message:
          Add static_cast<> for memory allocations on Windows.
        ------------------------------------------------------------
        revno: 3394.2.7
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Tue 2011-08-23 11:31:41 +1000
        message:
          Fix a .c file that was missed earlier.
        ------------------------------------------------------------
        revno: 3394.2.6
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Tue 2011-08-23 10:21:58 +1000
        message:
          1. Rename all .c files to .cc.
          2. Update CMakeLists.txt sources
          3. Remove the CFLAGS and compiler hack from CMakeList.txt. CMake should be
             able to use the correct compiler from the source filename suffix.
          4. Update license info in make_bison.sh and make_flex.sh
          5. Update make_bison.sh and make_flex.sh to generate .cc files.
        ------------------------------------------------------------
        revno: 3394.2.5
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Tue 2011-08-23 10:04:23 +1000
        message:
          Fix issues when built with the following debug defines enabled:
          
          #define UNIV_LOG_LSN_DEBUG
          #define UNIV_BLOB_DEBUG
          #define UNIV_DEBUG_VALGRIND
          #define UNIV_DEBUG_LOCK_VALIDATE
          #define UNIV_DEBUG
          #define UNIV_SYNC_DEBUG
          #define UNIV_HASH_DEBUG
          #define UNIV_PERF_DEBUG
          #define UNIV_ZIP_DEBUG
          #define UNIV_ZIP_COPY
          #define UNIV_AIO_DEBUG
          #define UNIV_STATS_DEBUG
          #define UNIV_SEARCH_DEBUG
          #define UNIV_MEM_DEBUG
          #define UNIV_IBUF_DBEUG
          #define UNIV_IBUF_COUNT_DEBUG
          #define UNIV_LIST_DEBUG
          #define UNIV_LRU_DEBUG
          #define UNIV_AHI_DEBUG
          
          1. Forward declaration of ib_rbt_t* in dict0mem.h
          2. Change type of dict_index_t::blobs to the actual type: ib_rbt_t*
          3. Fix list and has invalidation macros.
          4. Add some casts from void* to specific type.
        ------------------------------------------------------------
        revno: 3394.2.4
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Mon 2011-08-22 20:15:19 +1000
        message:
          Undo last change.
        ------------------------------------------------------------
        revno: 3394.2.3
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Mon 2011-08-22 19:58:07 +1000
        message:
          Test please ignore.
        ------------------------------------------------------------
        revno: 3394.2.2
        committer: Vasil Dimov <vasil.dimov@oracle.com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Mon 2011-08-22 12:25:52 +0300
        message:
          Remove UNIV_*DEBUG from include/univ.i and fix a problem
          where UNIV_DEBUG was not enabled when MySQL's WITH_DEBUG was enabled.
        ------------------------------------------------------------
        revno: 3394.2.1
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: mysql-trunk-innodb-c++
        timestamp: Sun 2011-08-21 15:21:39 +1000
        message:
          Code changes to compile with C++.
    ------------------------------------------------------------
    revno: 2876.468.182 [merge]
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Tue 2011-11-15 05:36:28 -0800
    message:
      Merge with mysql-trunk
------------------------------------------------------------
revno: 3631
committer: Sunny Bains <Sunny.Bains@Oracle.Com>
branch nick: trunk
timestamp: Tue 2011-11-22 10:15:10 +1100
message:
  Remove extra ',' in univ.i
  Set crc32 in buf0buf.c to ULINT32_UNDEFINED to silence an uninitalised warning.
  The function uses crc32_inited to control access to crc32 therefore the warning
  looks bogus.
------------------------------------------------------------
revno: 3630 [merge]
committer: Andrei Elkin <andrei.elkin@oracle.com>
branch nick: wl5569-mts-trunk-for-bugfixing
timestamp: Mon 2011-11-21 21:51:17 +0200
message:
  merge from the main repo.
    ------------------------------------------------------------
    revno: 3627.1.1
    committer: Vasil Dimov <vasil.dimov@oracle.com>
    branch nick: mysql-trunk
    timestamp: Mon 2011-11-21 19:51:51 +0200
    message:
      Prefix InnoDB printout messages with a single space
      to be inline with other output from MySQL code (and parts of
      InnoDB code also prefix with a single space).
------------------------------------------------------------
revno: 3629
committer: Andrei Elkin <andrei.elkin@oracle.com>
branch nick: wl5569-mts-trunk-for-bugfixing
timestamp: Mon 2011-11-21 21:50:04 +0200
message:
  experimenting with rpl_parallel_ddl in order to catch Bug 13033076.
  The test is made to DROP databases concurrently on the master side to prove the regular concurrent DROP:s execute correctly.
------------------------------------------------------------
revno: 3628
committer: Andrei Elkin <andrei.elkin@oracle.com>
branch nick: wl5569-mts-trunk-for-bugfixing
timestamp: Mon 2011-11-21 19:46:02 +0200
message:
  Bug#12982188 - MTS: SBR ABORTS WITH ERROR 1742 ON LOAD DATA WITH
                 TRIGGER FROM MYISAM TO INNODB
  
  The reason of the bug is not anticipated possibility of a group -
  BEGIN, BEGIN_LOAD_QUERY_EVENT, COMMIT -
  none of which event contains partitioning info.
  
  Fixed with recognizing such pattern and to force the group execution
  in sequential mode.
------------------------------------------------------------
revno: 3627
committer: Jimmy Yang <jimmy.yang@oracle.com>
branch nick: trunk2
timestamp: Mon 2011-11-21 09:09:08 -0800
message:
  Fix Bug #13411182 - ASSERTION PREBUILT->TABLE->N_REF_COUNT == 2 ON ADD FULLTEXT
------------------------------------------------------------
revno: 3626
committer: Manish Kumar <manish.4.kumar@oracle.com>
branch nick: mysql-trunk-bug-11747887
timestamp: Mon 2011-11-21 18:55:04 +0530
message:
  BUG#11747887:34386: MYSQLBINLOG --HEXDUMP PRINTS LAST ROW OF HEXDUMP
                      INCORRECTLY.
  
  Description: When mysqlbinlog --hexdump prints events, it prints the
               last row of the hexdump incorrectly, in two ways:
  
        1. if the last row has eight bytes, the end of the second last row is
           copied to the end of the last row, padding the last row to full length.
  
        2. if the last row has less than sixteen bytes, the textual
                representation is not aligned with previous rows.
  
  Problem: there was no proper alignment done incase the last line had
           less than 16 bytes.
  
  Fix: the bug was removed by padding the last line with the required
       number of spaces.
------------------------------------------------------------
revno: 3625 [merge]
committer: Sneha Modi<sneha.modi@oracle.com>
branch nick: mysql-trunk
timestamp: Mon 2011-11-21 17:07:49 +0530
message:
  Bug#11748731:
  
  Merging from mysql-5.5 -> mysql-trunk
    ------------------------------------------------------------
    revno: 2875.330.1
    committer: Sneha Modi<sneha.modi@oracle.com>
    branch nick: mysql-5.5
    timestamp: Mon 2011-11-21 16:58:32 +0530
    message:
      Bug#11748731:SOME 'BIG' TESTS FAILING ON 6.0 
      
      A patch for alter_table-big.test has been committed earlier.
      This is a patch for create-big.test:
      The test used to time-out after 900 seconds. 
      It relied on debug sleeps that are no longer present in the 
      code. Since the sleeps are long gone, fixing the problem didn't 
      involve just updating the result file or using macro 
      "show_binlog_events2.inc" instead of "show binlog events" 
      statement. The test needed to be rewritten using debug sync 
      points, and result then needed to be updated.
      So, the sleeps have been replaced by debug_sync points and the test execution time has 
      been reduced significantly.
------------------------------------------------------------
revno: 3624 [merge]
committer: Bjorn Munch <bjorn.munch@oracle.com>
branch nick: main-tr
timestamp: Mon 2011-11-21 12:31:27 +0100
message:
  upmerge: don't run federated_plugin.test for embedded
    ------------------------------------------------------------
    revno: 2875.321.38
    committer: Bjorn Munch <bjorn.munch@oracle.com>
    branch nick: main-55
    timestamp: Mon 2011-11-21 12:28:35 +0100
    message:
      Followup to 11750417:
        Disable federated_plugin test for embedded, like other federated tests
        Also removed redundant include/not_embedded.inc from federated.test
------------------------------------------------------------
revno: 3623 [merge]
committer: Evgeny Potemkin <evgeny.potemkin@oracle.com>
branch nick: mysql-trunk
timestamp: Mon 2011-11-21 14:19:10 +0400
message:
  Auto-merged.
    ------------------------------------------------------------
    revno: 3620.4.2 [merge]
    committer: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
    branch nick: fix-trunk
    timestamp: Mon 2011-11-21 12:02:34 +0200
    message:
      merge
    ------------------------------------------------------------
    revno: 3620.4.1
    committer: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
    branch nick: fix-trunk
    timestamp: Mon 2011-11-21 11:59:30 +0200
    message:
      Fixed the test suite failures after a merge from mysql-trunk-security.
       - changed error codes in test resultss
       - removed a stale result file rpl_parallel_benchmark.result
------------------------------------------------------------
revno: 3622 [merge]
committer: Evgeny Potemkin <evgeny.potemkin@oracle.com>
branch nick: mysql-trunk
timestamp: Mon 2011-11-21 13:58:42 +0400
message:
  Auto-merge.
    ------------------------------------------------------------
    revno: 3620.1.18
    committer: Jorgen Loland <jorgen.loland@oracle.com>
    branch nick: mysql-trunk
    timestamp: Mon 2011-11-21 09:51:57 +0100
    message:
      BUG#13400713: Follow-up patch. Giving internal tmp tables
      a name was a bad idea: may conflict with user defined table
      names and are visible in MYSQL_FIELDs returned to client. 
    ------------------------------------------------------------
    revno: 3620.1.17
    committer: Vasil Dimov <vasil.dimov@oracle.com>
    branch nick: mysql-trunk
    timestamp: Mon 2011-11-21 10:36:29 +0200
    message:
      Fix Bug#13397030 DO NOT CALC UNNECESSARY CHECKSUMS WHEN VALIDATING A PAGE
      
      When checking if a checksum matches, before this patch, we always
      calculated crc32 even if the selected algo is 'innodb'
      (e.g. innodb_checksum_algotithm=innodb).
      
      This is seen as unnecessary and crc32 should only be calculated if
      the 'innodb' checksum does not match. Same applies for calculating the
      'innodb' checksum if innodb_checksum_algotithm=crc32.
      
      Approved by:	Marko (http://bur03.no.oracle.com/rb/r/814/)
    ------------------------------------------------------------
    revno: 3620.1.16
    committer: Marko M?kel? <marko.makela@oracle.com>
    branch nick: mysql-trunk
    timestamp: Mon 2011-11-21 10:19:55 +0200
    message:
      Add some assertions and comments for WL#6046.
    ------------------------------------------------------------
    revno: 3620.1.15 [merge]
    committer: Sneha Modi<sneha.modi@oracle.com>
    branch nick: mysql-trunk
    timestamp: Mon 2011-11-21 11:01:50 +0530
    message:
      Bug#11748572:
      
      Merging from mysql-5.5 -> mysql-trunk
        ------------------------------------------------------------
        revno: 2875.321.37
        committer: Sneha Modi<sneha.modi@oracle.com>
        branch nick: mysql-5.5
        timestamp: Mon 2011-11-21 10:59:28 +0530
        message:
          Bug#11748572:ALLOCATING A LARGE QUERY CACHE IS NOT DETERMINISTIC
          
          Setting query_cache_size to larger values might fail depending on the memory 
          pressure being put on the system. This can be seen on pushbuild as the test 
          case query_cache_size_basic tries to allocate a +3GB query cache, which 
          succeeds in some machines and fails in others.
          
          So this part of the code where the test case tries to allocate +3GB query cache has been 
          disabled for now to get the test running on pb2.
    ------------------------------------------------------------
    revno: 3620.1.14
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: trunk
    timestamp: Mon 2011-11-21 15:46:31 +1100
    message:
      trx can be NULL, check for that in the debug assertion.
    ------------------------------------------------------------
    revno: 3620.1.13 [merge]
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-trunk
    timestamp: Sun 2011-11-20 18:35:19 -0800
    message:
      Merge from mysql-5.5 to mysql-trunk
        ------------------------------------------------------------
        revno: 2875.321.36
        committer: Jimmy Yang <jimmy.yang@oracle.com>
        branch nick: mysql-5.5
        timestamp: Sun 2011-11-20 18:21:20 -0800
        message:
          Fix Bug #13405367 - 60212 SERVER CRASH WITH CORRUPT FETCH BUFFER
          
          rb://608 approved by Sunny Bains
    ------------------------------------------------------------
    revno: 3620.1.12 [merge]
    committer: kevin.lewis@oracle.com
    branch nick: mysql-trunk
    timestamp: Sun 2011-11-20 19:19:44 -0600
    message:
      Merge with mysql-test including WL6046
        ------------------------------------------------------------
        revno: 3620.3.1
        committer: Sunny Bains <Sunny.Bains@Oracle.Com>
        branch nick: trunk
        timestamp: Mon 2011-11-21 07:25:39 +1100
        message:
          WL#6046 - Special handling of read-only transactions
          
          Split the trx_sys_t::trx_list into two:
           1. trx_sys_t::ro_trx_list
           2. trx_sys_t::rw_trx_list
          
          The debug flag that checks for list membership has been split into two too. The
          new rules around list membership and the new transaction state transitions can
          be found in trx0trx.h.
          
          The read view that is required for MVCC to work uses the trx_sys_t::rw_trx_list.
          Read-only transactions don't need to be considered in the this read view
          because they don't make any changes.
          
          An additional optimisation is to detect whether the SQL query is an aut-commit
          non-locking select. Such transactions don't go on either of the trx lists. This
          reduces the contention on the trx_sys_t::mutex further. Auto-commit non-locking
          selects set the trx_t::start_time once every 32 times, this is to further
          reduce system calls from trx_start_low(). These ac-nl-selects currently will
          not be displayed via "SHOW ENGINE INNODB STATUS" but only via the Information
          Schema. Add two new columns to the Information_schema.innodb_trx table.
          
            1. trx_is_read_only
            2. trx_autocommit_non_locking
          
          This WL depends on WL#5968 START TRANSACTION [READ (WRITE | ONLY)];, currently
          the function to query the read-only status of a transaction will always return
          FALSE. The function is there as stub only:
          
            thd_trx_is_read_only();
          
          rb://800 Approved by Marko.
    ------------------------------------------------------------
    revno: 3620.1.11
    committer: kevin.lewis@oracle.com
    branch nick: mysql-trunk
    timestamp: Sun 2011-11-20 15:00:25 -0600
    message:
      WL#5756 - Complete patch for mysql-trunk to support innodb-page-size
      of 4k or 8k in addition to the default of 16k.  Only one page size is
      supported at a time.
      
      A new global startup variable is introduced called INNODB-PAGE-SIZE.
      
      InnoDB maps UNIV_PAGE_SIZE to this setup parameter in order to create
      and use all tablespaces with the same page size.  Only 4k, 8k, and 16k
      are supported here.  Errors are reported if a tablesapce is opened with
      a size other than the current setting.  The page size is embedded into
      the tablespace header at location FSP_SPACE_FLAGS.
      
      Extensive changes are made to test cases.  Some are made to run with
      16k page sizes only by adding --include include/have_innodb_16k.inc.
      Other test scripts are changed to accept multiple possible outputs.
      And others are moved to the new tests suite/innodb/innodb_16k, innodb_8k
      & innodb_4k.
      
      extra/nnochecksum.c is improved to compile parts of the innodb code
      directly, use mysys functions for command line processing, and to use
      the embedded page size in FSP_SPACE_FLAGS within each tablespace.
      
      The standard runs that get executed by pushbuild are expanded.  See
      collections/ default.push, default.daily & default.weekly.
      
      The following bugs were found and fixed as part of this patch;
      Bug#13391699   INNODB_16K DOES NOT PASS THE HIGH LOAD CHECK,
                     TRYING TO DO IBUF MERGE TO DROPPED
      Bug#13394706   INNODB; SLOW DOUBLEWRITE BUFFER CREATION WITH UNIV_DEBUG
                     AND 4K PAGE SIZE
      Bug#13391353   INNODB :PAGE SIZE SUPPORT - INNODB_<4/8/16>K.TEST GETS
                     ROW SIZE ERROR ON 32 BIT
      Bug#13336585   INNODB: CHANGE BUFFERING WITH 4K PAGES CAN ASSERT IF
                     SECONDARY KEY IS NEAR MAX
      Bug#12602606   INCONSISTENCY IN EXPLAIN SELECT ... WHEN USING 4K PAGE SIZE
      Bug#12573796   INNODB; TEST SUITE/INNODB/INNODB_TRX_WEIGHT.TEST DEADLOCKS
                     FOR 4K AND 8K PAGES
      Bug#12562795   INNODB; CRASH ON WINDOWS WHEN RECOMPILE FOR 4K PAGE SIZE.
    ------------------------------------------------------------
    revno: 3620.1.10 [merge]
    committer: Inaam Rana <inaam.rana@oracle.com>
    branch nick: mysql-trunk
    timestamp: Sat 2011-11-19 12:18:45 -0500
    message:
      merge bug#13390506 from 5.5
        ------------------------------------------------------------
        revno: 2875.321.35
        committer: Inaam Rana <inaam.rana@oracle.com>
        branch nick: mysql-5.5
        timestamp: Fri 2011-11-18 11:20:17 -0500
        message:
          merge bug#13390506 from mysql-5.1
        ------------------------------------------------------------
        revno: 2875.321.34 [merge]
        committer: Inaam Rana <inaam.rana@oracle.com>
        branch nick: mysql-5.5
        timestamp: Fri 2011-11-18 11:02:04 -0500
        message:
          NULL merge from mysql-5.1
            ------------------------------------------------------------
            revno: 2661.809.58
            committer: Inaam Rana <inaam.rana@oracle.com>
            branch nick: mysql-5.1
            timestamp: Fri 2011-11-18 10:59:10 -0500
            message:
              Bug#13390506 - VALGRIND FAILURE AFTER THE FIX FOR 13371000
                
              rb://816
              approved by: Marko Makela
                
              The title is misleading. This bug was actually introduced by
              bug 12635227 and was unearthed by a later optimization.
              We need to free buf_page_t structs that we are allocating using
              malloc() at shutdown.
    ------------------------------------------------------------
    revno: 3620.1.9 [merge]
    committer: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
    branch nick: merge-trunk
    timestamp: Sat 2011-11-19 10:26:38 +0200
    message:
      merge
        ------------------------------------------------------------
        revno: 3620.2.3
        committer: Jorgen Loland <jorgen.loland@oracle.com>
        branch nick: mysql-trunk
        timestamp: Fri 2011-11-18 15:51:40 +0100
        message:
          BUG#13400713: Followup patch:
           - consistently use tmp as abreviation for temporary
             in optimizer trace
           - fixed test issue in opt_trace.general.inc
        ------------------------------------------------------------
        revno: 3620.2.2
        committer: Vinay Fisrekar <vinay.fisrekar@oracle.com>
        branch nick: mysql-trunk
        timestamp: Fri 2011-11-18 19:46:55 +0530
        message:
          Bug#13400194 - fix windows test failure issues 
        ------------------------------------------------------------
        revno: 3620.2.1
        committer: Jorgen Loland <jorgen.loland@oracle.com>
        branch nick: mysql-trunk-13400713
        timestamp: Fri 2011-11-18 13:17:45 +0100
        message:
          BUG#13400713 - ADD OPTIMIZER TRACING OF TEMPORARY TABLES
          
          Add optimizer tracing to temporary table creation
    ------------------------------------------------------------
    revno: 3620.1.8 [merge]
    committer: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
    branch nick: merge-trunk
    timestamp: Sat 2011-11-19 10:21:17 +0200
    message:
      null Merge BUG#12997905 to trunk as discussed with Jorgen
        ------------------------------------------------------------
        revno: 2875.321.33 [merge]
        committer: Jorgen Loland <jorgen.loland@oracle.com>
        branch nick: mysql-5.5
        timestamp: Fri 2011-11-18 14:53:54 +0100
        message:
          Merge BUG#12997905 from 5.1 to 5.5
            ------------------------------------------------------------
            revno: 2661.809.57
            committer: Jorgen Loland <jorgen.loland@oracle.com>
            branch nick: mysql-5.1
            timestamp: Fri 2011-11-18 14:47:11 +0100
            message:
              Backmerge of BUG#12997905
    ------------------------------------------------------------
    revno: 3620.1.7
    committer: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
    branch nick: merge-trunk
    timestamp: Sat 2011-11-19 10:08:03 +0200
    message:
      Fixed post-merge problems : 
      - updated test results due to a differnet error number
      - added a local variable declaration missing.
    ------------------------------------------------------------
    revno: 3620.1.6 [merge]
    committer: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
    branch nick: merge-trunk
    timestamp: Fri 2011-11-18 14:48:52 +0200
    message:
      merge mysql-5.5->mysql-trunk
        ------------------------------------------------------------
        revno: 2875.321.32 [merge]
        committer: Vasil Dimov <vasil.dimov@oracle.com>
        branch nick: mysql-5.5
        timestamp: Fri 2011-11-18 13:57:10 +0200
        message:
          Merge mysql-5.1 -> mysql-5.5
          
          I manually checked that all the conflicting InnoDB changes are in 5.5 already.
          Two things I am not sure about - I commented them with XXX in this patch.
          I will further check with the authors of the changesets whether these things
          should be present or not.
            ------------------------------------------------------------
            revno: 2661.809.56 [merge]
            committer: Karen Langford <karen.langford@oracle.com>
            branch nick: mysql-5.1
            timestamp: Thu 2011-11-17 00:26:16 +0100
            message:
              Merge from mysql-5.1.60-release
                ------------------------------------------------------------
                revno: 2661.814.34
                tags: mysql-5.1.60
                committer: Karen Langford <karen.langford@oracle.com>
                branch nick: mysql-5.1.60-release
                timestamp: Sat 2011-10-29 20:08:40 +0200
                message:
                  Patch to fix stdint.h missing from pre Solaris 10 versions.
                ------------------------------------------------------------
                revno: 2661.814.33
                committer: Karen Langford <karen.langford@oracle.com>
                branch nick: mysql-5.1.60-release
                timestamp: Fri 2011-10-28 16:40:46 +0200
                message:
                  Patch to fix libedit vis.h problem (OSX/FreeBSD)
        ------------------------------------------------------------
        revno: 2875.321.31
        committer: Rafal Somla <rafal.somla@oracle.com>
        branch nick: mysql-5.5
        timestamp: Thu 2011-11-17 12:34:52 +0100
        message:
          Bug#13101974 SLAVE CAN'T CONNECT AS REPLICATION USER USING WINDOWS AUTH PLUGIN
          
          Problem was that built-in client-side support for Windows Native Authentication (WNA) was included only in the client library, but not into the server code (which also uses some of the sources from the client library).
          
          This is fixed by modyfying sql/CMakeLists.txt to include the client-side WNA plugin library and enable WNA related code by defining AUTHENTICATION_WIN macro.
          
          Also, the logic of libmysql/CMakeLists.txt is simplified a bit.
        ------------------------------------------------------------
        revno: 2875.321.30
        author: hery.ramilison@oracle.com
        committer: Build Team <MYSQL-RE_WW@oracle.com>
        branch nick: mysql-5.5
        timestamp: Thu 2011-11-17 09:13:43 +0100
        message:
          fix for bug 11748060/34981
        ------------------------------------------------------------
        revno: 2875.321.29 [merge]
        author: hery.ramilison@oracle.com
        committer: Build Team <MYSQL-RE_WW@oracle.com>
        branch nick: mysql-5.5
        timestamp: Thu 2011-11-17 09:00:58 +0100
        message:
          Merge from mysql-5.5.18-release
            ------------------------------------------------------------
            revno: 2875.325.29
            tags: mysql-5.5.18
            committer: Alfranio Correia <alfranio.correia@oracle.com>
            branch nick: mysql-5.5.18-release
            timestamp: Wed 2011-11-02 15:28:18 +0000
            message:
              BUG#13337202 - REPLICATION PERFORMANCE DROP DUE TO "THE BINLOG MAY BE CORRUPTED" FLOOD
              
              In patch mysql-5.5:revno:3097.92.133, we made the gcc 4.6.1 compiler
              to stop complaining about the fact that binlog_can_be_corrupted was
              defined but not used. The fix consisted in checking the variable
              and printing a warning message.
              
              However, the fix caused a regression as a message was being printed
              out when there was no corrupted binary log causing performance
              problems and triggering users' suspicions when there was no need.
              
              In BUG#13337202, we do not print any message and use the variable
              in an "if" with an empty body to keep the compiler happy.
    ------------------------------------------------------------
    revno: 3620.1.5 [merge]
    committer: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
    branch nick: merge-trunk
    timestamp: Fri 2011-11-18 14:28:10 +0200
    message:
      merged mysql-trunk-security-fixed->mysql-trunk
        ------------------------------------------------------------
        revno: 2876.471.46 [merge]
        committer: Marko M?kel? <marko.makela@oracle.com>
        branch nick: mysql-trunk-security
        timestamp: Wed 2011-10-26 12:34:27 +0300
        message:
          Merge mysql-5.5-security to mysql-trunk-security.
            ------------------------------------------------------------
            revno: 2875.325.28 [merge]
            tags: clone-5.5.18-build
            committer: Marko M?kel? <marko.makela@oracle.com>
            branch nick: mysql-5.5-security
            timestamp: Wed 2011-10-26 12:28:40 +0300
            message:
              Null merge from mysql-5.1-security.
                ------------------------------------------------------------
                revno: 2661.814.32
                tags: clone-5.1.60-build
                committer: Marko M?kel? <marko.makela@oracle.com>
                branch nick: mysql-5.1-security
                timestamp: Wed 2011-10-26 12:23:57 +0300
                message:
                  Revert revno:3452.71.32 (Bug#12612184 fix).
                  
                  Bug#12612184 RACE CONDITION AFTER BTR_CUR_PESSIMISTIC_UPDATE()
                  
                  The fix introduced potentially more severe crash recovery problems
                  than the bug causes. Revert the fix for now.
                ------------------------------------------------------------
                revno: 2661.814.31
                committer: Marko M?kel? <marko.makela@oracle.com>
                branch nick: mysql-5.1-security
                timestamp: Wed 2011-10-26 11:44:28 +0300
                message:
                  Revert most of revno 3560.9.1 (Bug#12704861)
                  
                  This was an attempt to address problems with the Bug#12612184 fix.
                  Even with this follow-up fix, crash recovery can be broken.
                  Let us fix the bug later.
        ------------------------------------------------------------
        revno: 2876.471.45 [merge]
        committer: Marko M?kel? <marko.makela@oracle.com>
        branch nick: mysql-trunk-security
        timestamp: Wed 2011-10-26 10:16:46 +0300
        message:
          Merge mysql-5.5-security to mysql-trunk-security.
            ------------------------------------------------------------
            revno: 2875.325.27 [merge]
            committer: Marko M?kel? <marko.makela@oracle.com>
            branch nick: mysql-5.5-security
            timestamp: Wed 2011-10-26 10:06:23 +0300
            message:
              Merge mysql-5.1-security to mysql-5.5-security.
                ------------------------------------------------------------
                revno: 2661.814.30
                committer: Marko M?kel? <marko.makela@oracle.com>
                branch nick: mysql-5.1-security
                timestamp: Wed 2011-10-26 09:38:28 +0300
                message:
                  Copy and adapt innodb_misc1.test from innodb to innodb_plugin.
                ------------------------------------------------------------
                revno: 2661.814.29
                committer: Marko M?kel? <marko.makela@oracle.com>
                branch nick: mysql-5.1-security
                timestamp: Wed 2011-10-26 09:34:32 +0300
                message:
                  Fix results after Bug#12661768 fix.
        ------------------------------------------------------------
        revno: 2876.471.44 [merge]
        committer: Marko M?kel? <marko.makela@oracle.com>
        branch nick: mysql-trunk-security
        timestamp: Tue 2011-10-25 18:41:25 +0300
        message:
          Merge mysql-5.5-security to mysql-trunk-security.
            ------------------------------------------------------------
            revno: 2875.325.26 [merge]
            committer: Marko M?kel? <marko.makela@oracle.com>
            branch nick: mysql-5.5-security
            timestamp: Tue 2011-10-25 18:06:05 +0300
            message:
              Merge mysql-5.1-security to mysql-5.5-security.
                ------------------------------------------------------------
                revno: 2661.814.28
                committer: Marko M?kel? <marko.makela@oracle.com>
                branch nick: mysql-5.1-security
                timestamp: Tue 2011-10-25 17:58:34 +0300
                message:
                  Fix results after Bug#12661768 fix.
                ------------------------------------------------------------
                revno: 2661.814.27
                committer: Marko M?kel? <marko.makela@oracle.com>
                branch nick: mysql-5.1-security
                timestamp: Tue 2011-10-25 17:33:38 +0300
                message:
                  Bug#13002783 PARTIALLY UNINITIALIZED CASCADE UPDATE VECTOR
                  
                  In the ON UPDATE CASCADE clause of FOREIGN KEY constraints, the
                  calculated update vector was not fully initialized. This bug was
                  introduced in the InnoDB Plugin when implementing support for
                  ROW_FORMAT=DYNAMIC.
                  
                  Additionally, the data type information was not initialized, but
                  apparently it has never been needed in this case.  Nevertheless, it is
                  not good programming practice to pass uninitialized values around.
                  
                  calc_row_difference(): Declare the update field uninitialized in
                  Valgrind. Copy the data type information as well, except when the
                  field is SQL NULL. In the built-in InnoDB, initialize
                  ufield->extern_storage = FALSE (an initialization bug that had gone
                  unnoticed this far). The InnoDB Plugin and later have this flag to
                  dfield_t and have always initialized it properly.
                  
                  row_ins_cascade_calc_update_vec(): Reduce the scope of some
                  pointers. Initialize orig_len. (This caused the bug in InnoDB Plugin
                  and later.)
                  
                  row_ins_foreign_check_on_constraint(): Simplify a condition. Declare
                  the update vector uninitialized.
                  
                  rb:771 approved by Jimmy Yang
        ------------------------------------------------------------
        revno: 2876.471.43 [merge]
        committer: Vasil Dimov <vasil.dimov@oracle.com>
        branch nick: mysql-trunk-security
        timestamp: Tue 2011-10-25 16:52:22 +0300
        message:
          Merge mysql-5.5-security -> mysql-trunk-security
          
          This is a merge for the fix of Bug#12661768 UPDATE IGNORE CRASHES SERVER
          IF TABLE IS INNODB AND IT IS PARENT FOR OTHER ONE
          
          However the patch is different from the patch that went into 5.1 and 5.5 -
          a less risky patch was pushed there. In 5.6 we change the handler interface
          and add a new error message.
          
          This is the proper commit message for the patch that is in MySQL 5.6:
          
          --- cut ---
          Fix Bug#12661768 UPDATE IGNORE CRASHES SERVER IF TABLE IS INNODB AND IT IS
          PARENT FOR OTHER ONE
          
          When "UPDATE t1 SET c = 1" is prevented by a duplicate entry in t2 (where
          there is a FK on t1 and t2 and ON UPDATE CASCADE), then InnoDB returns the
          number of the offending index from t2, but the MySQL part of the code
          assumes this is the Nth index from t1. If t1 contains less indexes, then a
          crash may occur, or if the returned number is less than the number of the
          indexes - then a bogus data is printed.
          
          Since MySQL is not aware of the second table, the option here is to return
          its name and the index name from InnoDB to MySQL instead of just a bare
          number (designating the number of the index).
          
          Approved by:	Jimmy, Marko, Jon Olav Hauglid (rb://768)
          --- cut ---
            ------------------------------------------------------------
            revno: 2875.325.25 [merge]
            committer: Vasil Dimov <vasil.dimov@oracle.com>
            branch nick: mysql-5.5-security
            timestamp: Tue 2011-10-25 16:48:23 +0300
            message:
              Merge mysql-5.1-security -> mysql-5.5-security (Fix Bug#12661768)
                ------------------------------------------------------------
                revno: 2661.814.26
                committer: Vasil Dimov <vasil.dimov@oracle.com>
                branch nick: mysql-5.1-security
                timestamp: Tue 2011-10-25 16:46:38 +0300
                message:
                  Fix Bug#12661768 UPDATE IGNORE CRASHES SERVER IF TABLE IS INNODB AND IT IS
                  PARENT FOR OTHER ONE
                  
                  Do not try to lookup key_nr'th key in 'table' because there may not be such
                  a key there. key_nr is the number of the key in the _child_ table name, not
                  in the parent table.
                  
                  Instead just print the fields of the record that are covered by the first key
                  defined on the parent table.
                  
                  This bug gets a better fix in MySQL 5.6, which is too risky for 5.1 and 5.5.
                  
                  Approved by:	Jon Olav Hauglid (via IM)
        ------------------------------------------------------------
        revno: 2876.471.42 [merge]
        committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
        branch nick: mysql-trunk-security
        timestamp: Mon 2011-10-24 14:09:13 +0400
        message:
          Empty merge from mysql-5.5-security.
            ------------------------------------------------------------
            revno: 2875.325.24 [merge]
            committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
            branch nick: mysql-5.5-security
            timestamp: Mon 2011-10-24 14:03:19 +0400
            message:
              Empty merge from mysql-5.1-security.
                ------------------------------------------------------------
                revno: 2661.814.25 [merge]
                committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
                branch nick: mysql-5.1-security
                timestamp: Mon 2011-10-24 12:44:27 +0400
                message:
                  Auto-merge from mysql-5.1.
            ------------------------------------------------------------
            revno: 2875.325.23 [merge]
            committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
            branch nick: mysql-5.5-security
            timestamp: Mon 2011-10-24 13:21:32 +0400
            message:
              Auto-merge from mysql-5.5.
        ------------------------------------------------------------
        revno: 2876.471.41 [merge]
        committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
        branch nick: mysql-trunk-security
        timestamp: Mon 2011-10-24 14:02:27 +0400
        message:
          Manual merge from mysql-trunk.
          Conflicts:
            - mysql-test/t/sp.test
            - mysql-test/r/sp.result
        ------------------------------------------------------------
        revno: 2876.471.40 [merge]
        committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
        branch nick: mysql-trunk-security
        timestamp: Thu 2011-10-20 18:32:37 +0400
        message:
          Auto-merge from mysql-5.5-security.
            ------------------------------------------------------------
            revno: 2875.325.22 [merge]
            committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
            branch nick: mysql-5.5-security
            timestamp: Thu 2011-10-20 18:29:49 +0400
            message:
              Auto-merge from mysql-5.1-security.
                ------------------------------------------------------------
                revno: 2661.814.24
                committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
                branch nick: mysql-5.1-security
                timestamp: Thu 2011-10-20 18:06:41 +0400
                message:
                  Fix Windows-build failure: use my_snprintf() instead of snprintf().
        ------------------------------------------------------------
        revno: 2876.471.39 [merge]
        committer: Sergey Glukhov <sergey.glukhov@oracle.com>
        branch nick: mysql-trunk-security
        timestamp: Wed 2011-10-19 16:23:06 +0400
        message:
          5.5-security -> trunk-security merge
            ------------------------------------------------------------
            revno: 2875.325.21
            committer: Sergey Glukhov <sergey.glukhov@oracle.com>
            branch nick: mysql-5.5-security
            timestamp: Wed 2011-10-19 16:07:14 +0400
            message:
              Bug#12540545 61101: ASSERTION FAILURE IN THREAD 1256741184 IN FILE /BUILDDIR/BUILD/BUILD/MYSQ
              The assertion in innodb is triggered in this way:
              1. mysql server does lookup on the primary key with full key,
                 innodb decides to not store cursor position because
                 "any index_next/prev call will return EOF anyway"
              2. server asks innodb to return any next record in the index and the
                 assertion is triggered because no cursor position is stored.
              
              It happens when a unique search (match_mode=ROW_SEL_EXACT)
              in the clustered index is performed. InnoDB has never stored
              the cursor position after a unique key lookup in the
              clustered index because storing the position is an expensive
              operation. The bug was introduced by 
              WL3220 'Loose index scan for aggregate functions'.
              
              The fix is to disallow loose index scan optimization
              for AGG_FUNC(DISTINCT ...) if GROUP_MIN_MAX quick select
              uses clustered key.
        ------------------------------------------------------------
        revno: 2876.471.38 [merge]
        committer: Tatjana Azundris Nuernberg <tatjana.nuernberg@oracle.com>
        branch nick: 56-11765687t
        timestamp: Wed 2011-10-19 04:05:05 +0100
        message:
          Bug12589870 post-merge fixes auto-merge
            ------------------------------------------------------------
            revno: 2875.325.20 [merge]
            committer: Tatjana Azundris Nuernberg <tatjana.nuernberg@oracle.com>
            branch nick: 55-11765687t
            timestamp: Wed 2011-10-19 03:42:09 +0100
            message:
              Bug12589870 post merge fixes - manual merge
                ------------------------------------------------------------
                revno: 2661.814.23
                committer: Tatjana Azundris Nuernberg <tatjana.nuernberg@oracle.com>
                branch nick: 51-11765687t
                timestamp: Wed 2011-10-19 03:21:31 +0100
                message:
                  Bug12589870 post-merge fixes for Sparc64 and friends
        ------------------------------------------------------------
        revno: 2876.471.37 [merge]
        committer: Tor Didriksen <tor.didriksen@oracle.com>
        branch nick: trunk-security
        timestamp: Fri 2011-10-14 11:40:10 +0200
        message:
          merge 5.5-security => trunk-security
            ------------------------------------------------------------
            revno: 2875.325.19 [merge]
            committer: Tor Didriksen <tor.didriksen@oracle.com>
            branch nick: 5.5-security
            timestamp: Fri 2011-10-14 11:14:44 +0200
            message:
              merge 5.1-security => 5.5-security
                ------------------------------------------------------------
                revno: 2661.814.22 [merge]
                committer: Tor Didriksen <tor.didriksen@oracle.com>
                branch nick: 5.1-security
                timestamp: Fri 2011-10-14 10:44:27 +0200
                message:
                  merge 5.0-security => 5.1 security
                    ------------------------------------------------------------
                    revno: 1810.4002.35
                    committer: Tor Didriksen <tor.didriksen@oracle.com>
                    branch nick: 5.0-security
                    timestamp: Fri 2011-10-14 10:09:53 +0200
                    message:
                      Bug#12563865 ROUNDED,TMP_BUF,DECIMAL_VALUE STACK CORRUPTION IN ALL VERSIONS >=5.0
                      
                      Buffer over-run on all platforms, crash on windows, wrong result on other platforms,
                      when rounding numbers which start with 999999999 and have
                      precision = 9 or 18 or 27 or 36 ...
        ------------------------------------------------------------
        revno: 2876.471.36
        committer: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
        branch nick: merge-truk-security
        timestamp: Wed 2011-10-12 18:47:16 +0300
        message:
          fixed merge result mysql-trunk->mysql-trunk-security
        ------------------------------------------------------------
        revno: 2876.471.35 [merge]
        committer: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
        branch nick: merge-truk-security
        timestamp: Wed 2011-10-12 16:40:11 +0300
        message:
          empty weave merge mysql-5.5-security->mysql-trunk-security 
            ------------------------------------------------------------
            revno: 2875.325.18 [merge]
            committer: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
            branch nick: merge-5.5-security
            timestamp: Wed 2011-10-12 15:12:34 +0300
            message:
              empty weave merge mysql-5.1-security->mysql-5.5-security
                ------------------------------------------------------------
                revno: 2661.814.21 [merge]
                committer: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
                branch nick: merge-5.1-security
                timestamp: Wed 2011-10-12 14:42:42 +0300
                message:
                  empty weave merge mysql-5.0-security->mysql-5.1-security
                    ------------------------------------------------------------
                    revno: 1810.4002.34 [merge]
                    committer: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
                    branch nick: merge-5.0-security
                    timestamp: Wed 2011-10-12 14:33:09 +0300
                    message:
                      auto-merge mysql-5.0->mysql-5.0-security
                ------------------------------------------------------------
                revno: 2661.814.20 [merge]
                committer: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
                branch nick: merge-5.1-security
                timestamp: Wed 2011-10-12 14:34:44 +0300
                message:
                  auto-merge mysql-5.1->mysql-5.1-security
            ------------------------------------------------------------
            revno: 2875.325.17 [merge]
            committer: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
            branch nick: merge-5.5-security
            timestamp: Wed 2011-10-12 15:07:15 +0300
            message:
              merge mysql-5.5->mysql-5.5-security
        ------------------------------------------------------------
        revno: 2876.471.34 [merge]
        committer: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
        branch nick: merge-truk-security
        timestamp: Wed 2011-10-12 16:30:13 +0300
        message:
          merge mysql-trunk->mysql-trunk-security
        ------------------------------------------------------------
        revno: 2876.471.33 [merge]
        committer: Tatjana Azundris Nuernberg <tatjana.nuernberg@oracle.com>
        branch nick: 56-11765687z
        timestamp: Mon 2011-10-10 15:58:24 +0100
        message:
          auto-merge
            ------------------------------------------------------------
            revno: 2875.325.16 [merge]
            committer: Tatjana Azundris Nuernberg <tatjana.nuernberg@oracle.com>
            branch nick: 55-11765687z
            timestamp: Mon 2011-10-10 15:48:52 +0100
            message:
              auto-merge
                ------------------------------------------------------------
                revno: 2661.814.19 [merge]
                committer: Tatjana Azundris Nuernberg <tatjana.nuernberg@oracle.com>
                branch nick: 51-11765687z
                timestamp: Mon 2011-10-10 15:34:29 +0100
                message:
                  auto-merge
            ------------------------------------------------------------
            revno: 2875.325.15 [merge]
            committer: Tatjana Azundris Nuernberg <tatjana.nuernberg@oracle.com>
            branch nick: 55-11765687z
            timestamp: Mon 2011-10-10 15:39:05 +0100
            message:
              auto-merge
        ------------------------------------------------------------
        revno: 2876.471.32 [merge]
        committer: Tatjana Azundris Nuernberg <tatjana.nuernberg@oracle.com>
        branch nick: 56-11765687z
        timestamp: Mon 2011-10-10 15:43:26 +0100
        message:
          auto-merge
            ------------------------------------------------------------
            revno: 2876.474.1 [merge]
            committer: Magne Mahre <magne.mahre@oracle.com>
            branch nick: mysql-trunk-security
            timestamp: Fri 2011-10-07 14:12:36 +0200
            message:
              Merge from 5.5-security
                ------------------------------------------------------------
                revno: 2875.329.1 [merge]
                committer: Magne Mahre <magne.mahre@oracle.com>
                branch nick: mysql-5.5-security
                timestamp: Fri 2011-10-07 14:10:15 +0200
                message:
                  Merge from 5.1-security
                    ------------------------------------------------------------
                    revno: 2661.822.1
                    committer: Magne Mahre <magne.mahre@oracle.com>
                    branch nick: mysql-5.1-security
                    timestamp: Fri 2011-10-07 14:08:31 +0200
                    message:
                      BUG#12589870 CRASHES WITH MULTIQUERY PACKET + USE<DB>  + QUERY CACHE
                       
                      A buffer large enough to hold the query _plus_ some additional
                      data is allocated before parsing is started.   The additional data 
                      is used by the query cache, and consists of the name of the current 
                      database and a set of flags.
                       
                      When a packet containing multiple SQL statements is sent to the
                      server and one of the statements changes the current database
                      (a "USE <db>" statement), and the name of the new current database 
                      is longer than of the previous,  there is not enough space in the 
                      buffer for the new name, and we write out over the buffer boundary.
                      
                      The fix adds an extra field to store the number of bytes
                      allocated to the database name in the buffer.  If the current
                      database name changes, and the new name is longer than the
                      previous one, we refuse to cache the query.
        ------------------------------------------------------------
        revno: 2876.471.31 [merge]
        committer: Tatjana Azundris Nuernberg <tatjana.nuernberg@oracle.com>
        branch nick: 56-11765687z
        timestamp: Thu 2011-10-06 12:04:19 +0100
        message:
          manual merge
            ------------------------------------------------------------
            revno: 2875.325.14 [merge]
            committer: Tatjana Azundris Nuernberg <tatjana.nuernberg@oracle.com>
            branch nick: 55-11765687z
            timestamp: Thu 2011-10-06 11:49:58 +0100
            message:
              manual merge
                ------------------------------------------------------------
                revno: 2661.814.18 [merge]
                committer: Tatjana Azundris Nuernberg <tatjana.nuernberg@oracle.com>
                branch nick: 51-11765687z
                timestamp: Thu 2011-10-06 11:35:01 +0100
                message:
                  manual merge
                    ------------------------------------------------------------
                    revno: 1810.4002.33
                    committer: Tatjana Azundris Nuernberg <tatjana.nuernberg@oracle.com>
                    branch nick: 50-11765687z
                    timestamp: Thu 2011-10-06 11:23:46 +0100
                    message:
                      additional clean-up for 11765687
        ------------------------------------------------------------
        revno: 2876.471.30 [merge]
        committer: Tatjana Azundris Nuernberg <tatjana.nuernberg@oracle.com>
        branch nick: 56-11765687z
        timestamp: Thu 2011-10-06 11:26:59 +0100
        message:
          manual merge
            ------------------------------------------------------------
            revno: 2875.325.13 [merge]
            committer: Tatjana Azundris Nuernberg <tatjana.nuernberg@oracle.com>
            branch nick: 55-11765687z
            timestamp: Thu 2011-10-06 10:55:57 +0100
            message:
              manual merge to reconcile with MySQL ticket 27145
                ------------------------------------------------------------
                revno: 2661.814.17 [merge]
                committer: Tatjana Azundris Nuernberg <tatjana.nuernberg@oracle.com>
                branch nick: 51-11765687z
                timestamp: Thu 2011-09-29 10:56:21 +0100
                message:
                  manual merge
                    ------------------------------------------------------------
                    revno: 1810.4002.32
                    committer: Tatjana Azundris Nuernberg <tatjana.nuernberg@oracle.com>
                    branch nick: 50-11765687z
                    timestamp: Thu 2011-09-29 10:47:11 +0100
                    message:
                      Bug#11765687 (MySQL58677): No privilege on table / view, but can know #rows / underlying table's name
                      
                      1 - If a user had SHOW VIEW and SELECT privileges on a view and
                      this view was referencing another view, EXPLAIN SELECT on the outer
                      view (that the user had privileges on) could reveal the structure
                      of the underlying "inner" view as well as the number of rows in
                      the underlying tables, even if the user had privileges on none of
                      these referenced objects.
                      
                      This happened because we used DEFINER's UID ("SUID") not just for
                      the view given in EXPLAIN, but also when checking privileges on
                      the underlying views (where we should use the UID of the EXPLAIN's
                      INVOKER instead).
                      
                      We no longer run the EXPLAIN SUID (with DEFINER's privileges).
                      This prevents a possible exploit and makes permissions more
                      orthogonal.
                      
                      2 - EXPLAIN SELECT would reveal a view's structure even if the user
                      did not have SHOW VIEW privileges for that view, as long as they
                      had SELECT privilege on the underlying tables.
                      
                      Instead of requiring both SHOW VIEW privilege on a view and SELECT
                      privilege on all underlying tables, we were checking for presence
                      of either of them.
                      
                      We now explicitly require SHOW VIEW and SELECT privileges on
                      the view we run EXPLAIN SELECT on, as well as all its
                      underlying views. We also require SELECT on all relevant
                      tables. 
        ------------------------------------------------------------
        revno: 2876.471.29 [merge]
        committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
        branch nick: mysql-trunk-security
        timestamp: Fri 2011-09-23 21:07:39 +0400
        message:
          Auto-merge from mysql-5.5-security.
            ------------------------------------------------------------
            revno: 2875.325.12 [merge]
            committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
            branch nick: mysql-5.5-security
            timestamp: Fri 2011-09-23 20:49:23 +0400
            message:
              Manual merge from mysql-5.1-security.
                ------------------------------------------------------------
                revno: 2661.814.16
                committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
                branch nick: mysql-5.1-security
                timestamp: Thu 2011-09-22 18:31:16 +0400
                message:
                  Fix for Bug#13001491: MYSQL_REFRESH CRASHES WHEN STORED ROUTINES ARE RUN CONCURRENTLY.
                  
                  The main problem was that lex_start() was forgotten to be called before processing
                  COM_REFRESH.
                  
                  Another problem discovered was that if failures to flush the error log were not properly
                  handled, which resulted in the server crash.
                  
                  The user-visible effect of these problems were:
                    - if COM_REFRESH command was sent after SQL-queries of some sort,
                      the server would crash.
                    - if COM_REFRESH was requested with REFRESH_LOG only, and the error log
                      failed to flush, the server would crash. The error log fails to flush
                      when it points to unavailable file (for example, due to restricted
                      permissions).
                  
                  The fixes are:
                    - call lex_start() in the beginning of COM_REFRESH;
                    - handle failures to flush the error log properly, i.e. raise ER_UNKNOWN_ERROR.
        ------------------------------------------------------------
        revno: 2876.471.28 [merge]
        committer: Mattias Jonsson <mattias.jonsson@oracle.com>
        branch nick: topush-trunk-sec
        timestamp: Thu 2011-09-15 22:50:15 +0200
        message:
          merge
            ------------------------------------------------------------
            revno: 2875.325.11 [merge]
            committer: Mattias Jonsson <mattias.jonsson@oracle.com>
            branch nick: topush-5.5-sec_2
            timestamp: Thu 2011-09-15 21:32:25 +0200
            message:
              merge
                ------------------------------------------------------------
                revno: 2875.327.2 [merge]
                committer: Mattias Jonsson <mattias.jonsson@oracle.com>
                branch nick: topush-5.5-sec
                timestamp: Thu 2011-09-15 21:27:18 +0200
                message:
                  merge
                    ------------------------------------------------------------
                    revno: 2875.328.1
                    committer: Mattias Jonsson <mattias.jonsson@oracle.com>
                    branch nick: b12696518-55-sec
                    timestamp: Thu 2011-09-15 20:49:39 +0200
                    message:
                      Bug#12696518: MEMORY LEAKS IN HA_PARTITION (VALGRIND TESTS ON TRUNK)
                      
                      (also 5.5+ solution for bug#11766879/bug#60106)
                      
                      The valgrind warning was due to an unused 'new handler_add_index(...)'
                      which was never freed.
                      
                      The error handling did not work (fails as in bug#11766879) and
                      the implementation was not as transparant as it could, therefore I
                      made it a bit simpler and more transparant to the underlying handlers.
                      
                      This way it follows the api better and the error handling works and
                      is also now tested.
                      
                      Also added a debug test to verify the error handling.
                      
                      Improved according to Jon Olavs review:
                      Added class ha_partition_add_index.
                      Also added base class Sql_alloc to handler_add_index.
                      Update 3.
                ------------------------------------------------------------
                revno: 2875.327.1 [merge]
                committer: Mattias Jonsson <mattias.jonsson@oracle.com>
                branch nick: topush-5.5-sec
                timestamp: Thu 2011-09-15 19:52:10 +0200
                message:
                  null merge of bug#11766879 (to be fixed by bug#12696518)
                    ------------------------------------------------------------
                    revno: 2661.814.15 [merge]
                    committer: Mattias Jonsson <mattias.jonsson@oracle.com>
                    branch nick: topush-5.1-sec
                    timestamp: Thu 2011-09-15 19:26:38 +0200
                    message:
                      merge into 5.1-sec of bug#11766879.
                        ------------------------------------------------------------
                        revno: 2661.821.1
                        committer: Mattias Jonsson <mattias.jonsson@oracle.com>
                        branch nick: b11766879-51
                        timestamp: Tue 2011-08-23 15:13:17 +0200
                        message:
                          Bug#11766879/Bug#60106: DIFF BETWEEN # OF INDEXES IN MYSQL VS INNODB,
                          PARTITONING, ON INDEX CREATE
                          
                          If the first partition succeeded in adding a index, but a successive partition failed,
                          then the first partition had still the new index.
                          
                          The fix reverts the added indexes from previous partitions on failure.
        ------------------------------------------------------------
        revno: 2876.471.27 [merge]
        committer: Kristofer Pettersson <kristofer.pettersson@oracle.com>
        branch nick: mysql-trunk-security
        timestamp: Thu 2011-09-15 11:47:59 +0200
        message:
          automerge
            ------------------------------------------------------------
            revno: 2876.473.1
            committer: Magne Mahre <magne.mahre@oracle.com>
            branch nick: mysql-trunk-security
            timestamp: Thu 2011-09-15 09:57:14 +0200
            message:
              Bug#12735545 - PARSER STACK OVERFLOW WITH NAME_CONST CONTAINING 
                             OR EXPRESSION
              
              Using NAME_CONST with a non-constant negated expression as
              value could cause a server crash.
              
              The issue was solved by added a more strict test on the
              value argument when constructing the Item_name_const
              object, verifying that the argument is indeed a literal
              constant.
        ------------------------------------------------------------
        revno: 2876.471.26 [merge]
        committer: Kristofer Pettersson <kristofer.pettersson@oracle.com>
        branch nick: mysql-trunk-security
        timestamp: Thu 2011-09-15 11:46:36 +0200
        message:
          merge 5.5-security -> trunk-security
            ------------------------------------------------------------
            revno: 2875.325.10
            committer: Kristofer Pettersson <kristofer.pettersson@oracle.com>
            branch nick: mysql-5.5-security
            timestamp: Thu 2011-09-15 10:01:15 +0200
            message:
              Bug#11764310 - 57132: CONV FUNCTION CRASHES, NEGATIVE ARGUMENT TO MEMCPY
              
              Amendment to previous patch:
              Failure in CONV() should return NULL instead of
              empty set.
              When compiled on Windows or Solaris the function
              Item_func_conv::val_str() doesn't fail on 
              longlong2str() but finds an earlier exit path
              based on the attributes of the arguments.
              This exit path returns NULL on failure and as a
              consequence the original patch caused different
              test results depending on the OS used.
        ------------------------------------------------------------
        revno: 2876.471.25 [merge]
        committer: Kristofer Pettersson <kristofer.pettersson@oracle.com>
        branch nick: mysql-trunk-security
        timestamp: Tue 2011-09-06 09:44:33 +0200
        message:
          automerge 5.5-security => trunk-security
            ------------------------------------------------------------
            revno: 2875.325.9
            committer: Kristofer Pettersson <kristofer.pettersson@oracle.com>
            branch nick: mysql-5.5-security
            timestamp: Tue 2011-09-06 09:42:14 +0200
            message:
              Bug11764310 - 57132: CONV FUNCTION CRASHES, NEGATIVE ARGUMENT TO MEMCPY 
              
              Failure to check the return state of a longlong2str() call
              caused a crash. This could happen if a user executed the sql
              function CONV() with certain parameters.
              
              The patch fixes the issue by checking that the returned pointer
              isn't NULL.
        ------------------------------------------------------------
        revno: 2876.471.24 [merge]
        committer: Tor Didriksen <tor.didriksen@oracle.com>
        branch nick: trunk-security
        timestamp: Wed 2011-08-24 09:32:54 +0200
        message:
          automerge 5.5-security => trunk-security
            ------------------------------------------------------------
            revno: 2875.325.8
            committer: Tor Didriksen <tor.didriksen@oracle.com>
            branch nick: 5.5-security
            timestamp: Wed 2011-08-24 09:18:50 +0200
            message:
              Bug#10064164 post-push fix: build break unless #defined HAVE_OPENSSL
        ------------------------------------------------------------
        revno: 2876.471.23 [merge]
        committer: Kristofer Pettersson <kristofer.pettersson@oracle.com>
        branch nick: mysql-trunk-security
        timestamp: Tue 2011-08-23 16:39:19 +0200
        message:
          automerge 5.5-security -> trunk-security
            ------------------------------------------------------------
            revno: 2875.325.7
            committer: Kristofer Pettersson <kristofer.pettersson@oracle.com>
            branch nick: mysql-5.5-security
            timestamp: Tue 2011-08-23 16:20:21 +0200
            message:
              Bug10064164 Clean up of the protocol to avoid ambiguities
              
              The client-server protocol has left some room for interpretation
              which this patch fixes by introducing byte counters and
              enforced logic for SSL handshakes.
        ------------------------------------------------------------
        revno: 2876.471.22 [merge]
        committer: Tor Didriksen <tor.didriksen@oracle.com>
        branch nick: trunk-security
        timestamp: Fri 2011-08-19 09:32:38 +0200
        message:
          NULL merge 5.5-security => trunk-security
            ------------------------------------------------------------
            revno: 2875.325.6
            committer: Tor Didriksen <tor.didriksen@oracle.com>
            branch nick: 5.5-security
            timestamp: Fri 2011-08-19 09:06:50 +0200
            message:
              Backport from trunk of:
              Bug#12532830 - SIGFPE OR ASSERTION (PRECISION <= ((9 * 9) - 8*2)) && (DEC <= 30)
        ------------------------------------------------------------
        revno: 2876.471.21
        committer: Tor Didriksen <tor.didriksen@oracle.com>
        branch nick: trunk-security
        timestamp: Fri 2011-08-19 09:21:53 +0200
        message:
          bug#11765413 post-push fix: update comments for Item_field constructor
        ------------------------------------------------------------
        revno: 2876.471.20 [merge]
        committer: Tor Didriksen <tor.didriksen@oracle.com>
        branch nick: trunk-security
        timestamp: Fri 2011-08-19 09:11:20 +0200
        message:
          merge 5.5-security => trunk-security
            ------------------------------------------------------------
            revno: 2875.325.5 [merge]
            committer: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
            branch nick: mysql-5.5-security
            timestamp: Wed 2011-08-17 13:29:09 +0300
            message:
              merge mysql-5.1-security->mysql-5.5-security
                ------------------------------------------------------------
                revno: 2661.814.14 [merge]
                committer: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
                branch nick: mysql-5.1-security
                timestamp: Wed 2011-08-17 13:25:33 +0300
                message:
                  merge mysql-5.0-security->mysql-5.1-security
                    ------------------------------------------------------------
                    revno: 1810.4002.31
                    committer: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
                    branch nick: mysql-5.0-security
                    timestamp: Wed 2011-08-17 13:13:44 +0300
                    message:
                      changed the old @sun.com address of security trees.
                ------------------------------------------------------------
                revno: 2661.814.13
                committer: Karen Langford <karen.langford@oracle.com>
                branch nick: mysql-5.1-security
                timestamp: Thu 2011-08-11 15:31:25 +0200
                message:
                  Raise version number after cloning 5.1.59
        ------------------------------------------------------------
        revno: 2876.471.19 [merge]
        committer: Dmitry Shulga <Dmitry.Shulga@oracle.com>
        branch nick: mysql-trunk-security
        timestamp: Wed 2011-08-17 17:55:48 +0700
        message:
          Auto-merge of patch for bug#12621017 from mysql-5.5-security tree.
            ------------------------------------------------------------
            revno: 2875.325.4
            committer: Dmitry Shulga <Dmitry.Shulga@oracle.com>
            branch nick: mysql-5.5-security
            timestamp: Sat 2011-08-13 13:34:00 +0700
            message:
              Fixed Bug#12621017 - CRASH IF A SP VARIABLE IS USED IN THE LIMIT CLAUSE OF A
              SET STATEMENT.
              
              Server built with debug asserts, without debug crashes if a user tries
              to run a stored procedure that constains query with subquery that include
              either LIMIT or LIMIT OFFSET clauses.
              
              The problem was that Item::fix_fields() was not called for the items
              representing LIMIT or OFFSET clauses.
              
              The solution is to call Item::fix_fields() right before evaluation in
              st_select_lex_unit::set_limit().
        ------------------------------------------------------------
        revno: 2876.471.18 [merge]
        committer: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
        branch nick: B11765565-trunk-security
        timestamp: Fri 2011-08-12 15:41:36 +0300
        message:
          merge
            ------------------------------------------------------------
            revno: 2875.325.3 [merge]
            committer: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
            branch nick: B11765565-5.5-security
            timestamp: Fri 2011-08-12 15:36:49 +0300
            message:
              merge
        ------------------------------------------------------------
        revno: 2876.471.17 [merge]
        committer: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
        branch nick: B11765565-trunk-security
        timestamp: Fri 2011-08-12 15:37:50 +0300
        message:
          merge
            ------------------------------------------------------------
            revno: 2876.472.1 [merge]
            committer: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
            branch nick: B12818542-trunk-security
            timestamp: Fri 2011-08-12 15:33:31 +0300
            message:
              merge of bug #12818542 mysql-5.5-security->mysql-trunk-security
                ------------------------------------------------------------
                revno: 2875.326.1
                committer: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
                branch nick: B12818542-5.5-security
                timestamp: Fri 2011-08-12 15:04:05 +0300
                message:
                  Bug #12818542: PAM: ADDING PASSWORD FOR AN ACCOUNT DISABLES 
                  PAM AUTHENTICATION SETTINGS
                  
                  SET PASSWORD code on a account with plugin authentication was errorneously
                  resetting the in-memory plugin pointer for the user back to native password 
                  plugin despite the fact that it was sending a warning that the command has 
                  no immediate effect.
                  Fixed by not updating the user's plugin if it's already set to a non default value.
                  Note that the bug affected only the in-memory cache of the user definitions.
                  Any restart of the server will fix the problem.
                  Also the salt and the password has are still stored into the user tables (just as 
                  it's documented now).
                  Test case added.
                  One old test case result updated  to have the correct value.
        ------------------------------------------------------------
        revno: 2876.471.16 [merge]
        committer: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
        branch nick: B11765565-trunk-security
        timestamp: Fri 2011-08-12 15:28:33 +0300
        message:
          merge of 11765565 mysql-5.5-security->mysql-trunk-security
            ------------------------------------------------------------
            revno: 2875.325.2
            committer: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
            branch nick: B11765565-5.5-security
            timestamp: Fri 2011-08-12 15:14:31 +0300
            message:
              Bug #11765565: 58548: 5.5.X NEEDS TO LINK TO THE CORESERVICES FRAMEWORK 
                FOR SOME PLUGINS TO WORK
              
              Some dynamically loadable plugins on the Mac may need functions from the 
              CoreServices framework. Unfortunately the only place where this can be initialized
              is the main executable. Thus to allow plugins to use functions from that framework
              the mysqld binary needs to link to the framework.
        ------------------------------------------------------------
        revno: 2876.471.15 [merge]
        committer: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
        branch nick: mysql-trunk-security
        timestamp: Fri 2011-08-12 14:29:43 +0300
        message:
          null merge of the version bump
            ------------------------------------------------------------
            revno: 2875.325.1
            committer: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
            branch nick: mysql-5.5-security
            timestamp: Fri 2011-08-12 14:22:16 +0300
            message:
              bumped up the version to 5.5.18
        ------------------------------------------------------------
        revno: 2876.471.14 [merge]
        committer: Marko M?kel? <marko.makela@oracle.com>
        branch nick: mysql-trunk-security
        timestamp: Wed 2011-08-10 15:11:28 +0300
        message:
          Merge mysql-5.5-security to mysql-trunk-security.
        ------------------------------------------------------------
        revno: 2876.471.13
        committer: Dmitry Shulga <Dmitry.Shulga@oracle.com>
        branch nick: mysql-trunk-security-bug11765413
        timestamp: Wed 2011-08-10 15:43:47 +0700
        message:
          Fixed bug#11765413 (formerly known as 58378): CRASH WITH DEPENDENT SUBQUERY
          AND PREPARED STATEMENT.
          
          This crash occurred during execution of prepared statement that contained
          subquery in WHERE clause and when this subquery used HAVING condition.
          
          The problem was that during parsing of HAVING clause the instance of Item_field
          was created on memory allocated from runtime memroot and this allocated
          object/memory was destroyed after preparation stage finished. So when prepared
          statement subsequently was executed it tried to use Item_field object that
          had been already deleted.
          
          The solution is to allocate Item_field object at memroot dedicated for prepared 
          statement processing.
        ------------------------------------------------------------
        revno: 2876.471.12 [merge]
        committer: Ramil Kalimullin <ramil@mysql.com>
        branch nick: mysql-trunk-security
        timestamp: Tue 2011-08-09 12:54:23 +0400
        message:
          Auto-merge from mysql-5.5-security.
        ------------------------------------------------------------
        revno: 2876.471.11 [merge]
        committer: Ramil Kalimullin <ramil@mysql.com>
        branch nick: mysql-trunk-security
        timestamp: Tue 2011-08-09 12:30:54 +0400
        message:
          Manual merge from mysql-trunk.
        ------------------------------------------------------------
        revno: 2876.471.10 [merge]
        committer: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
        branch nick: B12319710-trunk-security
        timestamp: Tue 2011-07-26 17:44:29 +0300
        message:
          merge mysql-5.5-security->mysql-trunk-security
        ------------------------------------------------------------
        revno: 2876.471.9 [merge]
        committer: Tor Didriksen <tor.didriksen@oracle.com>
        branch nick: trunk-security
        timestamp: Mon 2011-07-18 10:42:08 +0200
        message:
          merge 5.5-security => trunk-security
        ------------------------------------------------------------
        revno: 2876.471.8 [merge]
        committer: Tor Didriksen <tor.didriksen@oracle.com>
        branch nick: trunk-security
        timestamp: Mon 2011-07-18 09:11:30 +0200
        message:
          automerge 5.5->security => trunk-security
        ------------------------------------------------------------
        revno: 2876.471.7 [merge]
        committer: Tor Didriksen <tor.didriksen@oracle.com>
        branch nick: trunk-security
        timestamp: Fri 2011-07-15 14:12:40 +0200
        message:
          Automerge 5.5-security => trunk-security
        ------------------------------------------------------------
        revno: 2876.471.6 [merge]
        committer: Davi Arnaut <davi.arnaut@oracle.com>
        branch nick: mysql-trunk-security
        timestamp: Fri 2011-07-15 08:09:39 -0300
        message:
          Merge of mysql-5.5-security into mysql-trunk-security.
        ------------------------------------------------------------
        revno: 2876.471.5 [merge]
        committer: Tor Didriksen <tor.didriksen@oracle.com>
        branch nick: trunk-security
        timestamp: Mon 2011-07-11 12:51:20 +0200
        message:
          merge 5.5-security => trunk-security
          Merging only test files from Bug#11765255.
          This bug was already fixed by patch for Bug#12590211.
        ------------------------------------------------------------
        revno: 2876.471.4 [merge]
        committer: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
        branch nick: merge-trunk-security
        timestamp: Thu 2011-07-07 15:51:05 +0300
        message:
          empty weave merge mysql-5.5-security->mysql-trunk-security
        ------------------------------------------------------------
        revno: 2876.471.3 [merge]
        committer: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
        branch nick: merge-trunk-security
        timestamp: Thu 2011-07-07 14:32:19 +0300
        message:
          weave merge of mysql-trunk->mysql-trunk-security
        ------------------------------------------------------------
        revno: 2876.471.2 [merge]
        committer: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
        branch nick: merge-trunk-security
        timestamp: Thu 2011-06-16 14:32:38 +0300
        message:
          merged mysql-5.5-security->mysql-trunk-security
        ------------------------------------------------------------
        revno: 2876.471.1 [merge]
        committer: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
        branch nick: merge-trunk-security
        timestamp: Thu 2011-06-16 12:26:33 +0300
        message:
          auto-merge of mysql-trunk->mysql-trunk-security
    ------------------------------------------------------------
    revno: 3620.1.4
    committer: Ashish Agarwal<ashish.y.agarwal@oracle.com>
    branch nick: b_t_213
    timestamp: Fri 2011-11-18 11:36:29 +0530
    message:
      bug#11760213 - 52599: ALTER TABLE REMOVE PARTITIONING ON
                            NON-PARTITIONED TABLE CORRUPTS MYISAM.
      
      ISSUE: Removing partitioning on a not partitioned table
             was permitted, but wasn't handled properly.
             As a result storage engine and .frm table
             definitions may go out of sync.
      
      SOLUTION: With this patch removing partitioning
                on a not partitioned is forbidden.
    ------------------------------------------------------------
    revno: 3620.1.3
    committer: Tor Didriksen <tor.didriksen@oracle.com>
    branch nick: trunk
    timestamp: Thu 2011-11-17 15:51:28 +0100
    message:
      WL#5825 Using C++ Standard Library with MySQL code
      post-push cleanup:
      the old workaround to avoid
        undefined reference to `__pure_virtual'
      no longer works.
      The client library contains C++ code, and must be linked with g++
    ------------------------------------------------------------
    revno: 3620.1.2
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: trunk2
    timestamp: Thu 2011-11-17 06:26:59 -0800
    message:
      Fix some unused-but-set-variable warnings in FTS code.
    ------------------------------------------------------------
    revno: 3620.1.1
    committer: Oystein Grovlen <oystein.grovlen@oracle.com>
    branch nick: mysql-trunk
    timestamp: Thu 2011-11-17 15:07:41 +0100
    message:
      Bug#12876523: VALGRIND FAILURE IN COMPRESSION TESTS
      
      The valgrind issue happens in the zlib package,
      and according to the zlib FAQ, it is intentional for
      performance reasons (http://www.zlib.net/zlib_faq.html#faq36).
      
      The current valgrind suppression file contains several call
      stacks for valgrind issues with deflate().  However, all the
      existing stacks differ from the one reported here at the
      4th level.
      
      I assume the failing stack trace must be due to inlining
      in optimized builds, but I have not been able to reproduce
      it on my available platforms.  However, I see no reason that
      the suppression rules should distinguish on which MySQL
      function call deflate() when there is a known problem with
      how deflate() works.  By limiting the stack in the suppression
      file to 3 levels, we can also reduce the number of suppression
      rules for deflate().
------------------------------------------------------------
revno: 3621
committer: Evgeny Potemkin <evgeny.potemkin@oracle.com>
branch nick: mysql-trunk
timestamp: Fri 2011-11-18 14:40:55 +0400
message:
  Bug#13354889: Crash on a derived table with more than 64 fields.
  Due to an overlook the bitmap used for table fields during key generation for
  derived tables were not wide enough. This caused keys being generated over
  wrong fields, missing keys and could lead to a crash.
  
  Now a wider bitmap is used for referring a derived table's fields. It is
  called Field_map and defined as Bitmap<MAX_FIELDS>.
------------------------------------------------------------
revno: 3620 [merge]
committer: Rafal Somla <rafal.somla@oracle.com>
branch nick: mysql-trunk
timestamp: Thu 2011-11-17 12:40:29 +0100
message:
  Merge of bug#13101974
    ------------------------------------------------------------
    revno: 2875.324.1
    committer: Rafal Somla <rafal.somla@oracle.com>
    branch nick: bug13101974
    timestamp: Tue 2011-11-15 13:18:15 +0100
    message:
      Bug#13101974 SLAVE CAN'T CONNECT AS REPLICATION USER USING WINDOWS AUTH PLUGIN
      
      Problem was that built-in client-side support for Windows Native Authentication (WNA) was included only in the client library, but not into the server code (which also uses some of the sources from the client library).
      
      This is fixed by modyfying sql/CMakeLists.txt to include the client-side WNA plugin library and enable WNA related code by defining AUTHENTICATION_WIN macro.
      
      Also, the logic of libmysql/CMakeLists.txt is simplified a bit.
------------------------------------------------------------
revno: 3619
committer: Jimmy Yang <jimmy.yang@oracle.com>
branch nick: trunk2
timestamp: Thu 2011-11-17 03:02:53 -0800
message:
  Fix bug #13400194 INNODB FTS SUPPORT: INNODB_FTS_LARGE_RECORDS DO NOT
  COMPLETE RUN ON WINDOWS. Also misc test cleanup:
  1) add sys_vars test for newly added FTS configure varaibles 
  2) removed fulltext_plugin.test
------------------------------------------------------------
revno: 3618
committer: Jorgen Loland <jorgen.loland@oracle.com>
branch nick: mysql-trunk-11761078
timestamp: Thu 2011-11-17 11:09:13 +0100
message:
  BUG#11761078: 53534: INCORRECT 'SELECT SQL_BIG_RESULT...' 
                WITH GROUP BY ON DUPLICATED FIELDS
  
  If a GROUP BY clause contains duplicates of the same field
  and group range access is used to resolve the query, the optimizer
  incorrectly believed that the range access would not provide 
  the ordered output required to do grouping. Thus, the already
  ordered rows were ordered once more using filesort (which yields
  correct result but is not optimal). end_send() then thought 
  that group range access method had not been used (see 
  is_using_loose_index_scan()) and therefore did not copy 
  non-aggregated fields to the resultset.
  
  The fix is to remove duplicated (and redundant) fields from 
  the GROUP BY and ORDER BY clauses, which in turns makes 
  the optimizer realize that the output of the range access method
  is, in fact, ordered.
------------------------------------------------------------
revno: 3617 [merge]
committer: Jimmy Yang <jimmy.yang@oracle.com>
branch nick: trunk2
timestamp: Wed 2011-11-16 08:48:12 -0800
message:
  Implement WL #5538 InnoDB Full-Text Search Support, merge
  mysql-5.6-labs-innodb-fts into mysql-trunk
    ------------------------------------------------------------
    revno: 2876.468.181
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Mon 2011-11-14 09:18:11 -0800
    message:
      Clean up valgrind tests
    ------------------------------------------------------------
    revno: 2876.468.180
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Mon 2011-11-14 00:52:14 -0800
    message:
      Add optimize table command in the innodb_fts_misc_1 test
    ------------------------------------------------------------
    revno: 2876.468.179
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Sun 2011-11-13 23:12:14 -0800
    message:
      Fix a fts_lexer prototype declaration error
    ------------------------------------------------------------
    revno: 2876.468.178
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Sun 2011-11-13 21:20:25 -0800
    message:
      Fix a phrase search bug when the querying fields spreading different indexes
      columns. Also resolve some valgrind warnings.
    ------------------------------------------------------------
    revno: 2876.468.177
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Sun 2011-11-13 08:38:51 -0800
    message:
      For FTS parallel sort event, add timeout when master thread wait for
      child thread to finish.
    ------------------------------------------------------------
    revno: 2876.468.176
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: fts5
    timestamp: Sat 2011-11-12 05:21:50 -0800
    message:
      Resolve some FTS windows PB2 test failure.
    ------------------------------------------------------------
    revno: 2876.468.175 [merge]
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Fri 2011-11-11 19:46:14 -0800
    message:
      Merge from mysql-trunk to mysql-5.6-labs-innodb-fts
    ------------------------------------------------------------
    revno: 2876.468.174
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Fri 2011-11-11 06:41:27 -0800
    message:
      Remove diagnostic printout
    ------------------------------------------------------------
    revno: 2876.468.173
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Thu 2011-11-10 04:03:52 -0800
    message:
      Fix an issue that we might not drop the FTS index cache in the case of
      crash recovery of an index, which crashed after most metadata are entered
      into system table.
    ------------------------------------------------------------
    revno: 2876.468.172
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Wed 2011-11-09 06:10:15 -0800
    message:
      For boolean search with operator "+" (and), the first word with such operator
      needs special treatment, so that its result are populate the intersection
      list regardless previous search results.
    ------------------------------------------------------------
    revno: 2876.468.171
    committer: Vinay Fisrekar <vinay.fisrekar@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Tue 2011-11-08 20:56:14 +0530
    message:
      More Tests for FK with transaction
      Adding new test file - creating two FTS index on same table
    ------------------------------------------------------------
    revno: 2876.468.170
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Tue 2011-11-08 06:49:50 -0800
    message:
      Add a diagnostic check function to check the consistency of FTS index
      cache and index metadata.
    ------------------------------------------------------------
    revno: 2876.468.169
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Tue 2011-11-08 03:13:53 -0800
    message:
      In fts_sync(), do not set sync->trx to NULL after releasing FTS cache lock.
    ------------------------------------------------------------
    revno: 2876.468.168
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Mon 2011-11-07 21:40:51 -0800
    message:
      Do error handling and remove index from fts index cache if create index
      failed. Also correct an incorrect assertion in dict_sys_tables_type_validate()
    ------------------------------------------------------------
    revno: 2876.468.167
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Mon 2011-11-07 10:31:01 -0800
    message:
      Miscelleous cleanup issues discovered by valgrind tests.
    ------------------------------------------------------------
    revno: 2876.468.166
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Sat 2011-11-05 05:49:50 -0700
    message:
      The index_cache structure stored in the cache->index vector could have its
      memory address changing as the vector resizes, need to recalibrate index_cache
      pointers in "get_doc" structure after each resize.
    ------------------------------------------------------------
    revno: 2876.468.165
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Fri 2011-11-04 12:24:15 -0700
    message:
      Keep the FTS auxiliary table drop before user table's drop.
    ------------------------------------------------------------
    revno: 2876.468.164
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Fri 2011-11-04 10:13:10 -0700
    message:
      Fix Bug #13348470 INNODB FTS SUPPORT : ASSERT AT FSEG_INODE_GET FOR FTS QUERY
    ------------------------------------------------------------
    revno: 2876.468.163
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Thu 2011-11-03 05:34:40 -0700
    message:
      Fix Bug #13343973 INNODB FTS SUPPORT : ASSERT FOR EMPTY STRINGS WITH 
      CONCAT OPERATOR
    ------------------------------------------------------------
    revno: 2876.468.162
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Tue 2011-11-01 21:08:48 -0700
    message:
      Clean up stale code from "FTS_ADD_DEBUG" define. Also remove the unused
      DOC_ID stats info from fts_sync() operation.
    ------------------------------------------------------------
    revno: 2876.468.161
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Tue 2011-11-01 03:01:14 -0700
    message:
      Add additional test on FK cascade update with FTS_DOC_ID as the constraint
      key. Also reorganize fts_get_next_doc_id() and fts_init_doc_id(), which
      is used by init_fts_doc_id_for_ref() check.
    ------------------------------------------------------------
    revno: 2876.468.160
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Mon 2011-10-31 23:56:36 -0700
    message:
      Add support for FK cascade update/delete for FTS indexed column, including
      "ON DELETE CASCADE/SET NULL" and "ON UPDATE CASCADE/SET NULL". In all
      case but "ON UPDATE CASCADE", the original row's Doc ID is marked as deleted.
      In the "ON UPDATE CASCADE" case, new Doc ID is generated and inserted along
      with updated columns.
    ------------------------------------------------------------
    revno: 2876.468.159
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Fri 2011-10-28 06:51:38 -0700
    message:
      Update result of mysql_plugin.test. Move fts_sync() out of fts_cache_add_doc()
    ------------------------------------------------------------
    revno: 2876.468.158
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Thu 2011-10-27 22:35:17 -0700
    message:
      Explicitly lock and unlock the FTS cache lock for fts_sync(). This is to
      avoid possible missed unlock when fts_sync() hits problem.
    ------------------------------------------------------------
    revno: 2876.468.157 [merge]
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Wed 2011-10-26 21:20:52 -0700
    message:
      Merge from mysql-trunk to mysql-5.6-labs-innodb-fts
    ------------------------------------------------------------
    revno: 2876.468.156
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Wed 2011-10-26 00:12:01 -0700
    message:
      When creating Fulltext index through FIC, skip the max column length check,
      which is newly added in trunk when we extend the max index column length to
      3072. Fulltext index has no length limitation in terms of indexed column.
    ------------------------------------------------------------
    revno: 2876.468.155
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Mon 2011-10-24 02:03:21 -0700
    message:
      Resolve latch order violation while initializing a FTS index and loading
      user stopword.
    ------------------------------------------------------------
    revno: 2876.468.154
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Fri 2011-09-09 05:50:58 -0700
    message:
      More non-functional cleanup/reorg on FTS sort code
    ------------------------------------------------------------
    revno: 2876.468.153
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Fri 2011-09-09 01:27:24 -0700
    message:
      Consolidate functions in FTS sort module, especially reduce the number
      of function parameters for row_merge_fts_doc_tokenize(), for
      better code readability and functional organization.
    ------------------------------------------------------------
    revno: 2876.468.152
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Wed 2011-09-07 06:48:12 -0700
    message:
      Allow multiple FTS indexes to be created on a table, and make sure drop
      index and DML work fine with multiple indexes.
    ------------------------------------------------------------
    revno: 2876.468.151
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: fts
    timestamp: Tue 2011-09-06 14:26:42 +1000
    message:
      Remove unnecessary goto.
    ------------------------------------------------------------
    revno: 2876.468.150
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: fts
    timestamp: Fri 2011-09-02 21:33:24 +1000
    message:
      Change comment style to Doxygen. Change licnese year. Minor code formatting.
    ------------------------------------------------------------
    revno: 2876.468.149
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: fts
    timestamp: Fri 2011-09-02 21:22:03 +1000
    message:
      Change year from 2010 to 2011.
    ------------------------------------------------------------
    revno: 2876.468.148
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: fts
    timestamp: Fri 2011-09-02 21:20:40 +1000
    message:
      Change comment style to Doxygen. Add a license.
    ------------------------------------------------------------
    revno: 2876.468.147
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: fts
    timestamp: Fri 2011-09-02 21:12:03 +1000
    message:
      Change comment style to Doxygen.
    ------------------------------------------------------------
    revno: 2876.468.146
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: fts
    timestamp: Fri 2011-09-02 21:01:01 +1000
    message:
      Change to Doxygen style comments. Minor formatting.
      Minor code changes too.
    ------------------------------------------------------------
    revno: 2876.468.145
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: fts
    timestamp: Fri 2011-09-02 20:09:24 +1000
    message:
      Change comments to Doxygen format. Minor formatting.
    ------------------------------------------------------------
    revno: 2876.468.144
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: fts
    timestamp: Fri 2011-09-02 19:51:55 +1000
    message:
      Fix the license and change comment style to Doxygen.
      Fix formatting of comments.
      Non-functional changes.
    ------------------------------------------------------------
    revno: 2876.468.143
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: fts
    timestamp: Fri 2011-09-02 18:53:59 +1000
    message:
      Remove Percona attribution in the license, copy and paste error.
    ------------------------------------------------------------
    revno: 2876.468.142
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: fts
    timestamp: Fri 2011-09-02 18:41:43 +1000
    message:
      Fix license and comments. Non-functinal change.
    ------------------------------------------------------------
    revno: 2876.468.141
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: fts
    timestamp: Fri 2011-09-02 18:20:21 +1000
    message:
      Add license and fix date. Non-functional change.
    ------------------------------------------------------------
    revno: 2876.468.140
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: fts
    timestamp: Fri 2011-09-02 18:11:22 +1000
    message:
      Fix warning: dereferencing type-punned pointer will break strict-aliasing rules.
    ------------------------------------------------------------
    revno: 2876.468.139
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: fts
    timestamp: Fri 2011-09-02 17:47:19 +1000
    message:
      Fix comments, non-functional change.
    ------------------------------------------------------------
    revno: 2876.468.138
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: fts
    timestamp: Fri 2011-09-02 17:43:03 +1000
    message:
      Move the fts files to their own directory fts/.
      Add the Doxygen /*!< to functions.
      Reinstate the fut0fut.c from mysql-trunk/
      fut/fut0fut.c will have a new id, the old file was renamed to fts/fts0fts.c.
    ------------------------------------------------------------
    revno: 2876.468.137
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Thu 2011-09-01 21:32:34 -0700
    message:
      Consolidate run time doc insertion/tokenization code, in preparation to
      support multiple FTS indexes on the table.
    ------------------------------------------------------------
    revno: 2876.468.136
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Thu 2011-09-01 20:12:23 -0700
    message:
      Temporarily address utf32 and uft16 charset queries by converting them
      to utf8 before proceed.
    ------------------------------------------------------------
    revno: 2876.468.135
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Wed 2011-08-31 19:49:23 -0700
    message:
      Optimize FTS parallel sort by using 4 bytes Doc ID instead of 8 Bytes
      if Doc ID value is in 4 byte integer limit. This could reduce overall
      sort size (we sort each word with its Doc ID and position), thus
      improve performance.
    ------------------------------------------------------------
    revno: 2876.468.134
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Tue 2011-08-30 02:23:17 -0700
    message:
      Change innodb_ft_min_token_size and innodb_ft_max_token_size from
      "byte" based to "character" based. Also change "uft8" field in
      fts_string_t to "f_str", as we now deal with various character strings
      other than "utf8".
    ------------------------------------------------------------
    revno: 2876.468.133
    committer: Vinay Fisrekar <vinay.fisrekar@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Thu 2011-08-04 17:00:19 +0530
    message:
      Test For Checking FTS variables and behavior across the sessions
    ------------------------------------------------------------
    revno: 2876.468.132
    committer: Vinay Fisrekar <vinay.fisrekar@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Wed 2011-08-03 19:20:45 +0530
    message:
      Adding FTS tests for innodb_ft_enable_stopword, innodb_ft_server_stopword_table,innodb_ft_user_stopword_table variables
    ------------------------------------------------------------
    revno: 2876.468.131
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Tue 2011-08-02 02:01:19 -0700
    message:
      Minor cleanups in FTS stopword handling. Make sure the user specified stopword
      table is registerred in the CONFIG table, and being re-used when server
      reboot.
    ------------------------------------------------------------
    revno: 2876.468.130
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Mon 2011-08-01 02:58:07 -0700
    message:
      Change InnoDB FTS related Information schema table name from
      "innodb_fts_*" to "innodb_ft_*", so that they are consistent in
      naming with that of system configure variables.
    ------------------------------------------------------------
    revno: 2876.468.129
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Thu 2011-07-28 04:29:33 -0700
    message:
      Add a missing "END_OF_ST_FIELD_INFO" to INFORMATION_SCHEMA FTS_CONFIG
      table column define.
    ------------------------------------------------------------
    revno: 2876.468.128
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Wed 2011-07-27 23:10:45 -0700
    message:
      Fix a bug where fts_ast_free_node could use an stale variable
      to fetch the next node info.
    ------------------------------------------------------------
    revno: 2876.468.127
    committer: Jimmy Yang <yangjimmy@gmail.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Wed 2011-07-27 08:12:29 -0700
    message:
      fix a bug in fts_search() for deleted record search that could
      search to an out of bound record.
    ------------------------------------------------------------
    revno: 2876.468.126
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Wed 2011-07-27 00:29:31 -0700
    message:
      Address two minor issues: 1) change "innodb_ft_enable_sort_o_direct"
      to "innodb_disable_sort_file_cache" 2) Error out the Doc ID if user
      tries to re-use a Doc ID when they manage their own Doc ID by
      using the FTS_DOC_ID column
    ------------------------------------------------------------
    revno: 2876.468.125
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Tue 2011-07-26 10:08:11 -0700
    message:
      Add a server configure variable so that user can turn off OS file system
      cache by enabling O_DIRECT. This is to avoid additional memory consumed
      by OS file system cache during sort merge phase.
    ------------------------------------------------------------
    revno: 2876.468.124
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Mon 2011-07-25 05:20:48 -0700
    message:
      Fix an issue with innobase_fts_casedn_str where cs->casedn_multiply could
      larger than 1.
    ------------------------------------------------------------
    revno: 2876.468.123
    committer: jyang <jyang@dscczz01.us.oracle.com>
    branch nick: fts
    timestamp: Sun 2011-07-24 22:10:35 -0700
    message:
      Modify a test file, innodb_fts_large_records.test, to have different
      input data file name for each sub-test, so there will not be any
      interference.
    ------------------------------------------------------------
    revno: 2876.468.122
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Sun 2011-07-24 06:24:26 -0700
    message:
      Fix a bug that first document could be tokenized twice.
    ------------------------------------------------------------
    revno: 2876.468.121
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Sun 2011-07-24 01:56:20 -0700
    message:
      A few final cleanup fixes:
      1) Switch some sort memory allocation away from heap memory to directly use
      ut_malloc and ut_free
      2) Clean up code for some valgrind tests
      3) Put diagnostic print into defines and controlling system variable
    ------------------------------------------------------------
    revno: 2876.468.120
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Fri 2011-07-22 00:42:26 -0700
    message:
      Fix a bug in FTS optimize when FTS_OPTIMIZE_MAX_WORDS is reached, it
      would jump to the next index partition even the current partition has
      not been exhausted. Also change FTS_OPTIMIZE_MAX_WORDS to a configurable
      parameter
    ------------------------------------------------------------
    revno: 2876.468.119
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Thu 2011-07-21 05:46:38 -0700
    message:
      Better handle the Doc ID update if it is supplied by user. Still such
      Doc ID would follow rules set up for internal supplied Doc ID, and ID of
      zero is not allowed, and not tokenized.
    ------------------------------------------------------------
    revno: 2876.468.118
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Wed 2011-07-20 08:25:56 -0700
    message:
      Tolerate DB_DUPLICATE_KEY for fts_trx_commit() for now. This shall be
      addressed with a more complete solution
    ------------------------------------------------------------
    revno: 2876.468.117
    committer: jyang <jyang@dscczz01.us.oracle.com>
    branch nick: fts
    timestamp: Wed 2011-07-20 05:02:39 -0700
    message:
      Enhance single term phrase search, also change "select *" to "select
      count(*)" in innodb_fts_large_records.test for some simple one
      record search
    ------------------------------------------------------------
    revno: 2876.468.116
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Wed 2011-07-20 04:00:52 -0700
    message:
      Make fts_sort_pll_degree always round up to the power of 2 number,
      also resolve an issue with possible accessing stale "index" variable in
      row_create_index_for_mysql()
    ------------------------------------------------------------
    revno: 2876.468.115 [merge]
    committer: Calvin Sun <calvin.sun@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Wed 2011-07-20 03:10:48 -0400
    message:
      mysql-5.6-labs-innodb-fts: merge from parent.
        ------------------------------------------------------------
        revno: 2876.470.3
        committer: Jimmy Yang <jimmy.yang@oracle.com>
        branch nick: mysql-innodb-fts
        timestamp: Wed 2011-07-20 00:00:01 -0700
        message:
          Miscellaneous function comment change.
        ------------------------------------------------------------
        revno: 2876.470.2
        committer: Jimmy Yang <jimmy.yang@oracle.com>
        branch nick: mysql-innodb-fts
        timestamp: Tue 2011-07-19 21:18:02 -0700
        message:
          The ranking increase/decrease symbol can be used along with wildcard
          match, thus it can be applied multiple times. Add a upper limit on 
          that, so that we have a reasonable ranking value.
        ------------------------------------------------------------
        revno: 2876.470.1
        committer: Jimmy Yang <jimmy.yang@oracle.com>
        branch nick: mysql-innodb-fts
        timestamp: Tue 2011-07-19 10:25:58 -0700
        message:
          Temporarily disable "cache->added > 0" assert, so Michael can proceed
          with his test. This count is an internal statistics counter of no
          significant result. So it can be disabled.
    ------------------------------------------------------------
    revno: 2876.468.114
    committer: Calvin Sun <calvin.sun@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Wed 2011-07-20 03:06:29 -0400
    message:
      mysql-5.6-labs-innodb-fts: change the naming to "labs-innodb-fts".
    ------------------------------------------------------------
    revno: 2876.468.113
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Tue 2011-07-19 04:43:47 -0700
    message:
      This fix increase the index table partition from 4 to 6, to improve
      create index and query performance. It also fixes a bug for cache->added
      counter that could goes to negative if the delete started before
      records from last crash bring into cache.
    ------------------------------------------------------------
    revno: 2876.468.112
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Mon 2011-07-18 18:24:05 -0700
    message:
      Fix an issue in fts_query_match_phrase_terms() for phrase search when
      query string longer than the phrase
    ------------------------------------------------------------
    revno: 2876.468.111
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Mon 2011-07-18 06:56:44 -0700
    message:
      Fix an incorrect selection tree value assignment when two adjacent write runs
      are completely empty
    ------------------------------------------------------------
    revno: 2876.468.110
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Sun 2011-07-17 22:17:24 -0700
    message:
      Convert incoming FTS query string to utf8 before proceed.
    ------------------------------------------------------------
    revno: 2876.468.109
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Sat 2011-07-16 13:07:15 -0700
    message:
      This is to handle statement level rollback in a user transaction, so that
      the Doc ID log operation are correctly handled, and Doc ID logged in
      the statement are removed from the final commit list.
    ------------------------------------------------------------
    revno: 2876.468.108
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Fri 2011-07-15 06:50:40 -0700
    message:
      We do not support handler index read for FTS, just return HA_ERR_KEY_NOT_FOUND
      for this type of search
    ------------------------------------------------------------
    revno: 2876.468.107
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Fri 2011-07-15 05:05:29 -0700
    message:
      A couple of fixes to address issues found by Michael:
      1) Initialized local variable "new_primary" in add_index() as error condition
      could jump before its value was assigned.
      2) Enhance synchronization at the last step FTS cache sync at server shutdown
      time
    ------------------------------------------------------------
    revno: 2876.468.106
    committer: Vinay Fisrekar <vinay.fisrekar@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Fri 2011-07-15 13:51:40 +0530
    message:
      Adding tests came from peter's testing
    ------------------------------------------------------------
    revno: 2876.468.105
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Thu 2011-07-14 08:47:13 -0700
    message:
      Minor type change for newly added configure variable to address
      compilation error on windows
    ------------------------------------------------------------
    revno: 2876.468.104
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Thu 2011-07-14 08:22:45 -0700
    message:
      Resolve a possible sync issue on Doc ID during fts_sync and insert,
      the result is duplicated key (Doc ID) error
    ------------------------------------------------------------
    revno: 2876.468.103
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Thu 2011-07-14 04:15:54 -0700
    message:
      Modify a bogus assertion to include FTS_MODIFY in fts_delete() operation.
    ------------------------------------------------------------
    revno: 2876.468.102
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Thu 2011-07-14 00:19:50 -0700
    message:
      Need to update slot->last_run even if the optimize thread not going to
      optimze the table
    ------------------------------------------------------------
    revno: 2876.468.101
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Wed 2011-07-13 22:10:24 -0700
    message:
      Add Doc ID mutext to guard the doc id generation.
    ------------------------------------------------------------
    revno: 2876.468.100
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Wed 2011-07-13 18:17:34 -0700
    message:
      This is to allow user to specify sort buffer size and create FTS 
      parallel degree. It also enhance the internal eval code to allow
      do prefix search with charset.
    ------------------------------------------------------------
    revno: 2876.468.99
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Wed 2011-07-13 03:55:10 -0700
    message:
      Minor fix to address PB2 build/test issue. Change new system variable
      innodb_fts_cache_size from ulint to ulong
    ------------------------------------------------------------
    revno: 2876.468.98
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Tue 2011-07-12 05:24:16 -0700
    message:
      Add a system varaible "innodb_optimize_fulltext_only", so that we will
      overload "optimize table" to optimize the fulltext index on a table.
      And we shall rely mostly on this command to optimize FTS rather
      than using the background thread.
    ------------------------------------------------------------
    revno: 2876.468.97
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: fts4
    timestamp: Mon 2011-07-11 05:33:02 -0700
    message:
      Adjust SYNC_FTS_CACHE_INIT and SYNC_FTS_CACHE synchronization level, so
      to avoid order violation when acquire these rwlock and dict_sys mutext
    ------------------------------------------------------------
    revno: 2876.468.96 [merge]
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Mon 2011-07-11 01:33:15 -0700
    message:
      Merge from mysql-trunk to mysql-5.6-labs-innodb-fts
    ------------------------------------------------------------
    revno: 2876.468.95
    committer: Vinay Fisrekar <vinay.fisrekar@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Mon 2011-07-11 11:37:32 +0530
    message:
      test with FTS + tnx/rollback 
    ------------------------------------------------------------
    revno: 2876.468.94
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: fts4
    timestamp: Sun 2011-07-10 21:08:02 -0700
    message:
      If a transaction can read uncommitted data of other session (with read
      uncommitted isolation level) or read its own session, it could find
      rows that still in the FTS index but not deleted by the transaction. In
      such case, we should continue to fetch next matched document instead of
      return "HA_ERR_KEY_NOT_FOUND", which could end the search prematurely.
    ------------------------------------------------------------
    revno: 2876.468.93
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Fri 2011-07-08 12:04:33 -0700
    message:
      Skip FTS index for persistent stats update since it is not a BTree index.
      So to skip any of its auxiliary tables, for which persistent stats would
      be of no use
    ------------------------------------------------------------
    revno: 2876.468.92
    committer: Vinay Fisrekar <vinay.fisrekar@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Fri 2011-07-08 17:25:26 +0530
    message:
      Test For FTS With Transaction
    ------------------------------------------------------------
    revno: 2876.468.91
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Fri 2011-07-08 04:16:42 -0700
    message:
      A couple of bug fix from Michael's testing
      1) Check for infimum record when use btr_pcur_get_low_match() to find
      record.
      2) Make sure cache->added is updated when we re-parse the documents during
      server startup from last crash
    ------------------------------------------------------------
    revno: 2876.468.90
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Fri 2011-07-08 01:43:15 -0700
    message:
      Completely obsolete fts_utf8_strcmp(), and substitute it with charset
      based compare function.
    ------------------------------------------------------------
    revno: 2876.468.89
    committer: Vinay Fisrekar <vinay.fisrekar@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Fri 2011-07-08 12:06:02 +0530
    message:
      Adding FTS test with transaction -multiple session 
    ------------------------------------------------------------
    revno: 2876.468.88
    committer: Vinay Fisrekar <vinay.fisrekar@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Thu 2011-07-07 20:54:20 +0530
    message:
      Dividing single test into 2 parts and adding more charset tests
    ------------------------------------------------------------
    revno: 2876.468.87
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Thu 2011-07-07 04:11:49 -0700
    message:
      This checking address a couple of issues discovered from Michael's testing:
      1. For FTS auxiliary tables, we only request for temporary statistics
      and skip it for persistent statistics
      2. Add rwlock to synchronize the fts_init_index(), so that the re-parsing
      work from last crashing is not done multiple times.
    ------------------------------------------------------------
    revno: 2876.468.86
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Wed 2011-07-06 08:34:02 -0700
    message:
      Some miscellaneous cleanup. Also further tune the innobase_strnxfrm()
      function for better hashing.
    ------------------------------------------------------------
    revno: 2876.468.85
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Tue 2011-07-05 20:20:36 -0700
    message:
      Should skip FTS index when update secondary indexes during transaction
      rollback. row_undo_mod_upd_del_sec() is missing such check, resulting
      a rollback to update the FTS index as a Btree index
    ------------------------------------------------------------
    revno: 2876.468.84
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Tue 2011-07-05 10:57:36 -0700
    message:
      This is to use my_strnxfrm() to normalize the first character of the
      word used for FTS index partition. So that different characters that
      maps to the same charset position with their sort order can be put
      in the same partition.
    ------------------------------------------------------------
    revno: 2876.468.83
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Tue 2011-07-05 09:15:51 -0700
    message:
      When processing deleted record at the transaction commit time, do not
      use mysql transaction to insert into DELETED auxiliary table, as such
      transaction already in the "prepared" state.
    ------------------------------------------------------------
    revno: 2876.468.82
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Tue 2011-07-05 07:38:53 -0700
    message:
      If a word appears in every document of the table, its ranking should be
      arbitrary low. We used to do log10((double)ULINT_MAX / (ULINT_MAX -1)),
      however, on 64bit machine, it results in 0, which is not desired. Change
      the value to a fixed small value.
    ------------------------------------------------------------
    revno: 2876.468.81
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Tue 2011-07-05 06:26:02 -0700
    message:
      Fix a bug where an incorrect Doc ID column length is used
    ------------------------------------------------------------
    revno: 2876.468.80
    committer: Vinay Fisrekar <vinay.fisrekar@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Tue 2011-07-05 17:05:17 +0530
    message:
      Testcase with utf8 strings
    ------------------------------------------------------------
    revno: 2876.468.79
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Mon 2011-07-04 22:45:51 -0700
    message:
      A few miscellaneous fixes:
      
      1) Add 3 error messages for InnoDB specific FT error return
      2) Convert some defines to innodb configurable variables
      3) Remove unused function fts_get_next_token()
    ------------------------------------------------------------
    revno: 2876.468.78
    committer: Vinay Fisrekar <vinay.fisrekar@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Mon 2011-07-04 18:15:43 +0530
    message:
      Adding FTS index test with 'compressed' row format
    ------------------------------------------------------------
    revno: 2876.468.77
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Mon 2011-07-04 04:39:25 -0700
    message:
      Don't use query cache for FTS search related query. FTS search would
      request each Doc's ranking for each returned row. Query caching could
      cause result overwritten.
    ------------------------------------------------------------
    revno: 2876.468.76
    committer: Vinay Fisrekar <vinay.fisrekar@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Mon 2011-07-04 11:53:33 +0530
    message:
      Adding testcases for FTS index with foreign key constraints
    ------------------------------------------------------------
    revno: 2876.468.75
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Fri 2011-07-01 06:00:05 -0700
    message:
      This checkin includes following change:
      1) Create the auxiliary table with the column prtype the same as
      that of FTS indexed column.
      2) Make the temporary table for FTS FIC sort using the same prtype
      as that of FTS indexed column. And with mtype of DATA_VARMYSQL is the
      charset is not latin1 swedish.
    ------------------------------------------------------------
    revno: 2876.468.74
    committer: Vinay Fisrekar <vinay.fisrekar@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Fri 2011-07-01 16:43:47 +0530
    message:
      Adding more tests from peter's testcases
    ------------------------------------------------------------
    revno: 2876.468.73
    committer: Vinay Fisrekar <vinay.fisrekar@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Fri 2011-07-01 16:18:58 +0530
    message:
      1) add tescases for FTS with transaction
      2) Update test/result file according to bug fixes
    ------------------------------------------------------------
    revno: 2876.468.72
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Thu 2011-06-30 07:21:12 -0700
    message:
      A couple more charset related change:
      1) The auxiliary index table's word column is created with the same prtype
      as indexed column (Note all indexed FTS column must have same prtype).
      2) Use charset based function to convert string to lower case before pass
      to parser for query plan generation.
    ------------------------------------------------------------
    revno: 2876.468.71
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Wed 2011-06-29 22:26:11 -0700
    message:
      Exclude FTS index from being chosen as index used for foreign key
      constraint.
    ------------------------------------------------------------
    revno: 2876.468.70
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Wed 2011-06-29 06:24:47 -0700
    message:
      Change the string to lower case before searching the FT index cache tree
      rather than doing so after. Different case could result in different
      ranking order, thus an out of order error.
    ------------------------------------------------------------
    revno: 2876.468.69
    committer: Vinay Fisrekar <vinay.fisrekar@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Wed 2011-06-29 16:15:07 +0530
    message:
      Adding testcases based on peter's testing
    ------------------------------------------------------------
    revno: 2876.468.68
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Wed 2011-06-29 02:16:54 -0700
    message:
      This is to deal with muiltiple pass of FTS search used for AND/OR search.
      We will have multiple result set for each pass, and provide each pass's
      result info when needed.
    ------------------------------------------------------------
    revno: 2876.468.67
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Tue 2011-06-28 22:12:43 -0700
    message:
      Fix a case where string length could changed when we switch it to
      lower case. Also we do not user MySQL transaction for any internal
      query execution.
    ------------------------------------------------------------
    revno: 2876.468.66
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Tue 2011-06-28 18:27:02 -0700
    message:
      Fix a proximity search bug that did not end the search when one of words'
      match queue already exhausted.
    ------------------------------------------------------------
    revno: 2876.468.65
    committer: Vinay Fisrekar <vinay.fisrekar@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Tue 2011-06-28 13:36:44 +0530
    message:
      Adding test with proximity search cases - disabled it as its result differ from myisam
    ------------------------------------------------------------
    revno: 2876.468.64
    committer: Vinay Fisrekar <vinay.fisrekar@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Tue 2011-06-28 11:22:56 +0530
    message:
      Run innodb_fts suite on pb2 for branch mysql-5.6-labs-innodb-fts
    ------------------------------------------------------------
    revno: 2876.468.63
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Mon 2011-06-27 21:19:05 -0700
    message:
      Change InnoDB parser, so that we do not just take "[a-zA-Z_][a-zA-Z0-9_]"
      as search term, but any character of different charset.
    ------------------------------------------------------------
    revno: 2876.468.62
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Fri 2011-06-24 05:21:53 -0700
    message:
      This is to add FTS charset support. ha_compare_text() is used for
      internal string/text comparison. For red black tree interfaces,
      we also added additional parameter so that we can perform
      the comparison with input charset.
    ------------------------------------------------------------
    revno: 2876.468.61
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Wed 2011-06-22 08:58:56 -0700
    message:
      Remove requirement of updating ADDED auxiliary table for any DML involving
      FTS columns. The maintainance of ADDED table results in costly overhead. By
      remove such overhead, we can cut down the DML operation time dramatically.
      Some of the ADDED table code is not under define of FTS_ADDED_DEBUG define,
      so it can be reactivated for debugging or disagnostic purpose.
    ------------------------------------------------------------
    revno: 2876.468.60
    committer: Vinay Fisrekar <vinay.fisrekar@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Wed 2011-06-22 17:07:45 +0530
    message:
      Formatting file to remove unnecessary diff.
    ------------------------------------------------------------
    revno: 2876.468.59
    committer: Vinay Fisrekar <vinay.fisrekar@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Wed 2011-06-22 16:25:03 +0530
    message:
      Adding test for FTS index with more records.
    ------------------------------------------------------------
    revno: 2876.468.58
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Tue 2011-06-21 23:10:37 -0700
    message:
      check in the FTS stopword test.
    ------------------------------------------------------------
    revno: 2876.468.57
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Mon 2011-06-20 01:38:12 -0700
    message:
      Need to handle NULL column in fts_add_fetch_document().
    ------------------------------------------------------------
    revno: 2876.468.56
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Fri 2011-06-17 05:43:42 -0700
    message:
      Explicitly add "Engine = InnoDB" to the new innodb_fts_misc.test to
      avoid possibly creating MyISAM tables.
    ------------------------------------------------------------
    revno: 2876.468.55
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Fri 2011-06-17 05:09:47 -0700
    message:
      Improved on the internal Doc ID management. Got rid of the FTS_DOC_ID_STEP
      and we no longer need to update Doc ID to the CONFIG table every
      FTS_DOC_ID_STEP, which could be costly. Doc ID are now mostly an in
      memory counter, and be sync-ed only when FTS cache sync-ed to auxiliary tables.
      The Doc ID is initialized when we create FTS cache at the table load time,
      its initial value is determined by consulting ADDED table and CONFIG table.
    ------------------------------------------------------------
    revno: 2876.468.54
    committer: Vinay Fisrekar <vinay.fisrekar@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Fri 2011-06-17 14:42:38 +0530
    message:
      Adding FTS tests
      1) proximity search - new feature
      2) subquery test
      3) FTS with NULL values
      4) FTS with alter/create/drop index
      5) Negative tests
    ------------------------------------------------------------
    revno: 2876.468.53
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Fri 2011-06-17 01:11:08 -0700
    message:
      Fix two issues: 1) We should skip FTS index whole rollback any DML, since
      FTS index are updated only when it commits.
      2) We will allow proximity search with distance 0, which turn it into
      a phrase search.
    ------------------------------------------------------------
    revno: 2876.468.52
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Wed 2011-06-15 03:15:34 -0700
    message:
      Fix a bug that we prematurely clear a search result (prebuilt->result) in
      a subquery, which causes a segment fault when the query refers to the
      result again. Also make it a no-op for check FTS index, which does
      not have B-TREE.
    ------------------------------------------------------------
    revno: 2876.468.51 [merge]
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Tue 2011-06-14 18:40:44 -0700
    message:
      Pull merge from mysql-trunk
    ------------------------------------------------------------
    revno: 2876.468.50
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Tue 2011-06-14 03:57:38 -0700
    message:
      Minor fix for some compilation problem on Solaris.
    ------------------------------------------------------------
    revno: 2876.468.49
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Sun 2011-06-12 21:19:09 -0700
    message:
      Update fulltext_misc test result for a switch from Engine = MyISAM to
      Engine = InnoDB switch
    ------------------------------------------------------------
    revno: 2876.468.48
    committer: Calvin Sun <calvin.sun@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Fri 2011-06-10 11:59:05 -0500
    message:
      Minor changes to fulltext_update.test and fulltext_misc.result.
    ------------------------------------------------------------
    revno: 2876.468.47
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Fri 2011-06-10 07:46:12 -0700
    message:
      Moved innodb-fts-basic, innodb-fts-ddl, innodb-fts-fic tests to
      innodb_fts test suite
    ------------------------------------------------------------
    revno: 2876.468.46
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Fri 2011-06-10 07:26:03 -0700
    message:
      Add innodb-fts-fic.result, result file for innodb-fts-fic test
    ------------------------------------------------------------
    revno: 2876.468.45
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-5.6-labs-innodb-fts
    timestamp: Fri 2011-06-10 06:48:36 -0700
    message:
      Fix one signed, unsigned variable comparison
    ------------------------------------------------------------
    revno: 2876.468.44
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Fri 2011-06-10 06:11:36 -0700
    message:
      Fix FTS code to make innodb_fts test suite to pass. Fixes are mostly
      related to FTS ranking. We use "term frequency?inverse document frequency"
      type of ranking calculation. So ranking might be exactly the same as the
      one used MyISAM, however, the general ranking Order should be the same.
      
      Also removed "default_engine" reference in the tests, and use "engine = InnoDB"
      explicitly so we can just run the test suite by "--suite=innodb_fts"
      without specifying ignoring or using a particular storage engine.
      
      Some queries are quoted out because we do not support such. Any changed
      queries are commented with "INNODB_FTS" key word, mostly are related to
      
      1) Command not support by InnoDB, such as "repair", "optimize" and "ignore key"
      2) Charset support (need enhance)
      3) InnoDB do not support FT type queries on table without FTS index
      4) Check table not yet supported on FTS
      5) Misc item, such as "apostrophe" support etc.
    ------------------------------------------------------------
    revno: 2876.468.43
    committer: Calvin Sun <calvin.sun@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Thu 2011-06-09 16:01:58 -0500
    message:
      Should not create MyISAM table, use default_engine instead.
    ------------------------------------------------------------
    revno: 2876.468.42
    committer: Calvin Sun <calvin.sun@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Thu 2011-06-09 15:58:38 -0500
    message:
      Remove the following "replace_result". Otherwise, it fails on Windows.
      
      --replace_result $default_engine <default_engine>
    ------------------------------------------------------------
    revno: 2876.468.41
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Thu 2011-06-09 03:28:13 -0700
    message:
      Check in miscellaneous fixes to make MyISAM's fulltext.test run pass on
      InnoDB FTS. There are a few queries got quoted out, mostly related to:
            
            1) "check table" command with InnoDB FTS (not yet supported)
            2) Character set and Collation (Will support later)
            3) "match column against" syntax support
            
            There are some difference between the results, mostly due to:
            1) Different Ranking calculation
            2) Apostrophe support
    ------------------------------------------------------------
    revno: 2876.468.40
    committer: Calvin Sun <calvin.sun@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Wed 2011-06-08 15:39:01 -0500
    message:
      Update result file.
    ------------------------------------------------------------
    revno: 2876.468.39
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Tue 2011-06-07 21:09:49 -0700
    message:
      Fix bugs in the code:
      1) Should skip NULL columns for tokenization in FIC
      2) Remove the table from optimizer thread during drop table could cause
      self deadlock with dict_sys->mutex
      3) For proximity/phrase search, break early if any tokens can't be found
    ------------------------------------------------------------
    revno: 2876.468.38
    committer: Vinay Fisrekar <vinay.fisrekar@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Tue 2011-06-07 17:12:31 +0530
    message:
      Adding the testcase files fulltext index support on InnoDB engine. 
      The existing test files are converted to use them with InnoDB.
    ------------------------------------------------------------
    revno: 2876.468.37
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Mon 2011-06-06 08:58:48 -0700
    message:
      Fix a bug that query graph could be left not freed in the special query
      expansion statement. Re-enable query expansion tests.
    ------------------------------------------------------------
    revno: 2876.468.36
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Fri 2011-06-03 03:26:27 -0700
    message:
      Add support to automatically create internal index on Doc ID columns
      supplied by user with the "FTS_DOC_ID_COL_NAME" name.
    ------------------------------------------------------------
    revno: 2876.468.35
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Thu 2011-06-02 23:40:36 -0700
    message:
      Add stopword check to the FIC (fast index creation) of FTS indexes.
    ------------------------------------------------------------
    revno: 2876.468.34
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Thu 2011-06-02 01:01:58 -0700
    message:
      This is to make sure cached FTS Docs in the FTS index cache are sync-ed
      onto corresponding auxiliary tables at the server shutdown time.
    ------------------------------------------------------------
    revno: 2876.468.33
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Tue 2011-05-31 19:41:43 -0700
    message:
      This is to deal with externally stored fields during run time insertion
      updates. Fetch external pages and tokenize text on the page.
    ------------------------------------------------------------
    revno: 2876.468.32
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Mon 2011-05-30 04:07:11 -0700
    message:
      Add support on FIC on FTS index with externally stored large text column
    ------------------------------------------------------------
    revno: 2876.468.31
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Thu 2011-05-26 07:14:25 -0700
    message:
      Fix a bug that we could missing tokenize a record just after the current
      sort buffer full. Also address a few compilation warnings.
    ------------------------------------------------------------
    revno: 2876.468.30
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Thu 2011-05-26 01:33:33 -0700
    message:
      Resolve FTS Doc ID issues with truncate table command. The Doc ID needs
      to be reset to 0 after the auxiliary tables recreated. Also update
      the next Doc ID in config table directly after each create FTS index.
      Added innodb-fts-ddl.test.
    ------------------------------------------------------------
    revno: 2876.468.29
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Wed 2011-05-25 07:05:53 -0700
    message:
      Add support of dropping FTS indexes. When dropping individual FTS index,
      only such index related auxiliary tables are dropped. The Common FTS
      auxiliary table are remain undropped. The internal created Doc ID
      column is also stay. And Doc ID will continue be generated and inserted
      for any insertion. So that if FTS index is to be re-created, we will not
      need to rebuild the whole table to add the Doc ID column. 
    ------------------------------------------------------------
    revno: 2876.468.28
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Fri 2011-05-20 03:30:29 -0700
    message:
      Re-enabled the optimze thread that would clean up Deleted Records from
      FTS index auxiliary table according to DOC IDs registered
      in the DELETED and BEING_DELETED tables. During the optimization, it also
      reorganizes the FTS index.
      
      Fixed issues found during testing, and add diagnostics information schema
      table to view all auxiliary tables.
    ------------------------------------------------------------
    revno: 2876.468.27
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Tue 2011-05-17 01:37:30 -0700
    message:
      Run tests with UNIV_SYNC enabled. Resolve a possible hang situation
      (event should reset before we spawn off parallel merge thread than
      after). And a couple of other miscellaneous fixes.
    ------------------------------------------------------------
    revno: 2876.468.26
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Mon 2011-05-16 08:02:45 -0700
    message:
      Add tests for parallel create FTS with FIC. Fix any minor bugs during the
      testing.
    ------------------------------------------------------------
    revno: 2876.468.25
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Fri 2011-05-13 09:15:21 -0700
    message:
      Check in miscellaneous fixes for bugs discovered during my own internal
      testings.
    ------------------------------------------------------------
    revno: 2876.468.24
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Wed 2011-05-11 05:46:21 -0700
    message:
      Enable FTS basic functional tests. Fix phrase and proximity search
      on records remain in the FTS index cache (not yet sync-ed to auxilliary
      tables).
    ------------------------------------------------------------
    revno: 2876.468.23
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Tue 2011-05-10 06:25:38 -0700
    message:
      Add support for wildcard search for records in the FTS index cache.
      The result will be added to those found from index table records.
    ------------------------------------------------------------
    revno: 2876.468.22
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Mon 2011-05-09 06:14:39 -0700
    message:
      Fix a couple merge related issues. So that all basic functionalities
      tests can run
    ------------------------------------------------------------
    revno: 2876.468.21
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Sun 2011-05-08 23:37:42 -0700
    message:
      Add support to use FTS_DOC_ID_INDEX to fetch index record and its
      corresponding cluster index records (including the text column) to
      instantiate FTS index for each insert. The parsing activity will
      now be solely conducted at the record insert time.
    ------------------------------------------------------------
    revno: 2876.468.20
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: fts3
    timestamp: Sun 2011-05-08 20:49:56 -0700
    message:
      Add fts0opt.h into the project.
    ------------------------------------------------------------
    revno: 2876.468.19 [merge]
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Wed 2011-03-02 00:26:50 -0800
    message:
      Merge from mysql-trunk-innodb to mysql-innodb-fts
        ------------------------------------------------------------
        revno: 2876.469.1 [merge]
        committer: Jimmy Yang <jimmy.yang@oracle.com>
        branch nick: mysql-trunk-innodb2
        timestamp: Wed 2011-02-23 19:24:18 -0800
        message:
          merge from mysql-5.5-innodb to mysql-trunk-innodb
    ------------------------------------------------------------
    revno: 2876.468.18
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Fri 2011-01-07 03:05:52 -0800
    message:
      Prototyped the work to truncate table with FTS index. In essential, we
      will drop all existing auxiliary tables for a table and recreate them.
    ------------------------------------------------------------
    revno: 2876.468.17
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Mon 2011-01-03 03:53:55 -0800
    message:
      Check in a diagnostic information schema table "innodb_fts_index_table"
      that display internal information for specified FTS index auxiliary tables.
      This along with "innodb_fts_index_cache" help FTS DML diagnotic and testing.
    ------------------------------------------------------------
    revno: 2876.468.16
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Mon 2010-12-27 00:55:39 -0800
    message:
      This implements the INFORMATION_SCHEMA.INNODB_FTS_INDEX_CACHE table
      that displays the content of FTS index in memory cache content. This
      is part of effort that enhance the diagnostic tools available for FTS
      DML activities.
    ------------------------------------------------------------
    revno: 2876.468.15
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Thu 2010-12-23 23:39:29 -0800
    message:
      This checkin includes following patches:
      
      1. Add INFORMATION_SCHEMA.INNODB_FTS_INSERTED and INNODB_FTS_DELETED table
      to diagnostic FTS DML through buffered insert/deletes
      2. Add fts_init_index() to add IDs in the ADDED table when the FTS index
      is first used after a crash recovery (we no longer have add thread).
      3. Adjust fts_get_total_document_count() to use table statistics, decouple
      it with Doc IDs.
      4. Fix a couple of merge errors (such as missing fts_drop_orphaned_tables)
    ------------------------------------------------------------
    revno: 2876.468.14
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Thu 2010-12-09 21:48:27 -0800
    message:
      Fix a couple of merge errors when merge with mysql-trunk-innodb, causing
      table with FTS index did not load after rebooting.
    ------------------------------------------------------------
    revno: 2876.468.13
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Thu 2010-12-09 02:11:14 -0800
    message:
      Set the selection tree cell with correct value if one or more incoming
      stream is empty.
    ------------------------------------------------------------
    revno: 2876.468.12
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Mon 2010-11-15 23:45:51 -0800
    message:
      This checkin disable the per table add thread. The tokenization operation
      will be done as part of user insert operation right before commit. The
      background add thread will be changed to server wide 'purge thread' to
      flush docs to disk when per table cache is full.
    ------------------------------------------------------------
    revno: 2876.468.11
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Mon 2010-11-08 19:47:38 -0800
    message:
      Include/move univ.i to the first line of generated parser files.
    ------------------------------------------------------------
    revno: 2876.468.10
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Mon 2010-11-08 17:54:36 -0800
    message:
      Our windows compiler does not recoganize attribute extension
      "__attribute__((unused))". Temporarily skip the post processing of
      parser files for these extensions.
    ------------------------------------------------------------
    revno: 2876.468.9
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Sun 2010-11-07 23:20:28 -0800
    message:
      Work done in this checkin:
      1) Regenerate FTS parser related files using GNU Bison 2.4.1 and Flex 2.5.35.
      2) Fix a couple of merge errors in fts0blex.l and fts0tlex.l. 
      3) Add __attribute__((unused)) back, but modified makr_parser.sh, so that
      attributes are added behind the variable.
    ------------------------------------------------------------
    revno: 2876.468.8
    committer: Calvin Sun <calvin.sun@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Fri 2010-11-05 15:08:53 -0500
    message:
      Fix coding style violations.
    ------------------------------------------------------------
    revno: 2876.468.7
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Fri 2010-11-05 06:26:16 -0700
    message:
      fix some compilation warnings and errors on windows.
    ------------------------------------------------------------
    revno: 2876.468.6
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Wed 2010-11-03 01:25:20 -0700
    message:
      Fix a merge error that did not convert "FTS doc count" to "storage" byte
      order before write to auxiliary table. 
    ------------------------------------------------------------
    revno: 2876.468.5
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Tue 2010-11-02 21:28:38 -0700
    message:
      Fix a bug in create FTS index with FIC when the ilist size exceed
      FTS_ILIST_MAX_SIZE (64k).
    ------------------------------------------------------------
    revno: 2876.468.4
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Tue 2010-10-19 07:27:39 -0700
    message:
      First batch code change for supporting parallel create Full Text
      Indexes.
    ------------------------------------------------------------
    revno: 2876.468.3
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts2
    timestamp: Fri 2010-10-08 03:16:08 -0700
    message:
      Last batch of files merged from innodb+ to mysql-innodb-fts.
    ------------------------------------------------------------
    revno: 2876.468.2
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Wed 2010-09-22 01:51:59 -0700
    message:
      Fix a merge error when port FTS from innofts+ to mysql-innodb-fts.
    ------------------------------------------------------------
    revno: 2876.468.1
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-innodb-fts
    timestamp: Mon 2010-09-20 05:48:08 -0700
    message:
      Merge FTS prototype code from innodb+ based svn repository innofts+
      branch to mysql-innodb-trunk base mysql-innodb-fts branch. This
      checkin includes all basic merge and fixes allow the server to
      run InnoDB basic tests and fts basic tests. It does not yet
      include related format changes which will come in subsequent checkins.
------------------------------------------------------------
revno: 3616
committer: Mattias Jonsson <mattias.jonsson@oracle.com>
branch nick: test-trunk
timestamp: Wed 2011-11-16 16:24:04 +0100
message:
  BUG#11766440 - 59546: ASSERTION M_SP == __NULL
  FAILS IN ITEM_FUNC_SP::INIT_RESULT_FIELD WITH FU
  
  Post push patch for fixing the failing partitioning debug tests.
  
  Reopen of tables under LOCK TABLES would fail, since
  an error was already set.
  
  Fixed by using a temporary Diagnostics_area during
  reopen of locked tables.
------------------------------------------------------------
revno: 3615 [merge]
committer: Luis Soares <luis.soares@oracle.com>
branch nick: mysql-trunk
timestamp: Wed 2011-11-16 01:19:40 +0000
message:
  BUG#11760927
  
  Manual merge from mysql-5.5.
    ------------------------------------------------------------
    revno: 2875.321.28
    committer: Luis Soares <luis.soares@oracle.com>
    branch nick: mysql-5.5
    timestamp: Wed 2011-11-16 01:18:03 +0000
    message:
      BUG#11760927
      
      Follow-up patch to fix valgrind warnings.
------------------------------------------------------------
revno: 3614 [merge]
committer: Dmitry Lenev <Dmitry.Lenev@oracle.com>
branch nick: mysql-trunk-mrg
timestamp: Tue 2011-11-15 22:51:44 +0400
message:
  Merged fix for bug #12695572 "IMPROVE MDL PERFORMANCE IN PRE-VISTA
  BY CACHING OR REDUCING CREATEEVENT CALLS" into mysql-trunk.
    ------------------------------------------------------------
    revno: 2875.321.27
    committer: Dmitry Lenev <Dmitry.Lenev@oracle.com>
    branch nick: mysql-5.5-12695572
    timestamp: Tue 2011-11-15 22:00:14 +0400
    message:
      Fix for bug#12695572 - "IMPROVE MDL PERFORMANCE IN PRE-VISTA
      BY CACHING OR REDUCING CREATEEVENT CALLS".
       
      5.5 versions of MySQL server performed worse than 5.1 versions 
      under single-connection workload in autocommit mode on Windows XP.
       
      Part of this slowdown can be attributed to overhead associated
      with constant creation/destruction of MDL_lock objects in the MDL
      subsystem. The problem is that creation/destruction of these
      objects causes creation and destruction of associated
      synchronization primitives, which are expensive on Windows XP.
       
      This patch tries to alleviate this problem by introducing a cache
      of unused MDL_object_lock objects. Instead of destroying such
      objects we put them into the cache and then reuse with a new
      key when creation of a new object is requested.
      
      To limit the size of this cache, a new --metadata-locks-cache-size
      start-up parameter was introduced.
------------------------------------------------------------
revno: 3613 [merge]
committer: Luis Soares <luis.soares@oracle.com>
branch nick: mysql-trunk
timestamp: Tue 2011-11-15 14:40:04 +0000
message:
  BUG#11760927
  
  Automerged mysql-5.5 into latest mysql-trunk.
    ------------------------------------------------------------
    revno: 2875.321.26
    committer: Luis Soares <luis.soares@oracle.com>
    branch nick: mysql-5.5
    timestamp: Tue 2011-11-15 14:38:58 +0000
    message:
      BUG#11760927
      
      Follow up to fix freebsd compile issue.
------------------------------------------------------------
revno: 3612 [merge]
committer: Luis Soares <luis.soares@oracle.com>
branch nick: mysql-trunk
timestamp: Tue 2011-11-15 13:04:11 +0000
message:
  BUG#11760927
        
  Manual merge from mysql-5.5 into latest mysql-trunk.
        
  Conflicts
  ---------
  Text conflict in sql/log_event.cc
  Text conflict in sql/rpl_rli.h
        
  Disabled warnings in test case when including master-slave.inc .
    ------------------------------------------------------------
    revno: 2875.321.25 [merge]
    committer: Luis Soares <luis.soares@oracle.com>
    branch nick: mysql-5.5
    timestamp: Tue 2011-11-15 12:55:54 +0000
    message:
      BUG#11760927
      
      Automerged approved bzr bundle in latest mysql-5.5.
        ------------------------------------------------------------
        revno: 2875.323.1
        committer: Luis Soares <luis.soares@oracle.com>
        branch nick: mysql-5.5
        timestamp: Fri 2011-11-11 17:26:56 +0000
        message:
          BUG#11760927: 53375: RBR + NO PK => HIGH LOAD ON SLAVE (TABLE 
                        SCAN/CPU) => SLAVE FAILURE
          
          When a statement containing a large amount of ROWs to be applied on
          the slave, and the slave's table does not contain a PK, it can take a
          considerable amount of time to find and change all the rows that are
          to be changed.
          
          The proper slave enhancement will be implemented in WL 5597. However,
          in this bug we are making it clear to the user what the problem is, by
          printing a message to the error log if the execution time, for a given
          statement in RBR, takes more than LONG_FIND_ROW_THRESHOLD (set to 60
          seconds). This shall help the DBA to diagnose what's happening when
          facing a slave server that is quiet for no apparent reason...
          
          The note is only printed to the error log if log_warnings is set to be
          greater than 1.
------------------------------------------------------------
revno: 3611 [merge]
committer: Nirbhay Choubey <nirbhay.choubey@oracle.com>
branch nick: mysql-trunk
timestamp: Tue 2011-11-15 18:04:23 +0530
message:
  Merge of fix for bug#11827359 from mysql-5.5.
    ------------------------------------------------------------
    revno: 2875.321.24
    committer: Nirbhay Choubey <nirbhay.choubey@oracle.com>
    branch nick: B11827359-5.5
    timestamp: Tue 2011-11-15 17:48:42 +0530
    message:
      Bug#11827359 60223: MYSQL_UPGRADE PROBLEM WITH
                          OPTION SKIP-WRITE-BINLOG
      
      System tables were not getting upgraded when
      mysql_upgrade was run with --skip-write-binlog
      option. (Same for --write-binlog.) Also, with
      this option, mysql_upgrade_info file was not
      getting created after the upgrade.
      
      mysql_upgrade makes use of mysql client tool in
      order to run upgrade scripts, while doing so it
      passes some of the command line options (used to
      start mysql_upgrade) directly to mysql client.
      The reason behind this bug being, some options
      like skip-write-binlog and upgrade-system-tables
      were being passed to mysql tool along with other
      options, and hence mysql execution failed due
      presence of these invalid options.
      
      Fixed this issue by filtering out the above mentioned
      options from the list of options that will be passed to
      mysql and mysqlcheck tools. However, since --write-binlog
      is supported by mysqlcheck, this option would be used
      explicitly while running mysqlcheck. (not part of patch,
      already there)
      
      Checking the contents of general log after the upgrade
      is not doable via an mtr test. So performed manual test.
      Added a test to verify the creation of mysql_upgrade_info.
------------------------------------------------------------
revno: 3610
committer: Marc Alff <marc.alff@oracle.com>
branch nick: mysql-trunk-bug13389196
timestamp: Tue 2011-11-15 11:55:52 +0100
message:
  Bug#13389196 BUILD FAILS IF P_S IS DISABLED WITH: -DWITH_PERFSCHEMA_STORAGE_ENGINE:BOOL=OFF
  
  Before this fix, the code failed to build without the performance schema.
  
  The problem was that in sql/sql_class.h, the structures:
  - PSI_statement_locker_state
  - PSI_idle_locker_state
  are undefined in this case.
  
  The fix is to use the proper #ifdef symbol when compiling with a given
  performance schema instrumentation:
  - HAVE_PSI_STATEMENT_INTERFACE for the statement instrumentation
  - HAVE_PSI_IDLE_INTERFACE for the idle instrumentation
------------------------------------------------------------
revno: 3609 [merge]
committer: Tor Didriksen <tor.didriksen@oracle.com>
branch nick: trunk
timestamp: Tue 2011-11-15 10:24:13 +0100
message:
  merge 5.5 => trunk
    ------------------------------------------------------------
    revno: 2875.321.23
    committer: Tor Didriksen <tor.didriksen@oracle.com>
    branch nick: 5.5-decimal
    timestamp: Tue 2011-11-15 10:01:29 +0100
    message:
      Bug#13261955 TRUNCATE(DBL_MAX) RETURNS DBL_MAX RATHER THAN 'INF'
      
      my_double_round(DBL_MAX, -12, ....)
      should return 'inf' rather than DBL_MAX
      
      The problem is that floor(value/tmp) * tmp
      is inlined, and optimized away.
      
      The solution seems to be to prevent inlining by pre-computing value/tmp and
      storing it in a variable.
      
      No new test case: main.type_float fails without this patch.
------------------------------------------------------------
revno: 3608
committer: Andrei Elkin <andrei.elkin@oracle.com>
branch nick: mysql-trunk
timestamp: Mon 2011-11-14 17:44:42 +0200
message:
  Fixing timeouts on rpl_parallel{_benchmark}. The latter test does not really check anything
  but rather was designed to produce benchmarking figures. On PB the test is just redundant and is removed
  by this patch.
------------------------------------------------------------
revno: 3607
committer: Inaam Rana <inaam.rana@oracle.com>
branch nick: mysql-trunk
timestamp: Mon 2011-11-14 09:35:39 -0500
message:
  Bug#13371000 - ADAPTIVE LRU FOR COMPRESSED PAGES BROKEN BY
  RECENT LRU CHANGES
  
  rb://812
  approved by: Marko Makela
  
  When calling buf_flush_LRU_list_batch() use appropriate LRU list
  i.e.: either the regular LRU list or the unzip_LRU for cleaning and
  eviction. If it is decided to use the unzip_LRU then we can simply
  skip the flushing part because we are going to keep the compressed
  frames. 
------------------------------------------------------------
revno: 3606
committer: Vasil Dimov <vasil.dimov@oracle.com>
branch nick: mysql-trunk
timestamp: Mon 2011-11-14 16:29:13 +0200
message:
  In row_mysql_store_col_in_innobase_format(): explicitly note that buf
  should be kept as long as dfield is used because dfield->data may end
  up pointing inside 'buf' after row_mysql_store_col_in_innobase_format()
  returns.
------------------------------------------------------------
revno: 3605
committer: Marko M?kel? <marko.makela@oracle.com>
branch nick: mysql-trunk
timestamp: Mon 2011-11-14 13:05:34 +0200
message:
  Bug#12682554 FAILED ASSERT AT HANDLER0ALTER.CC IN MANY TESTS
  
  ha_innobase::add_index(): Lock the data dictionary even when dropping
  a created PRIMARY KEY table (new_primary=TRUE). This should fix the assertion
  ut_a(!new_primary || prebuilt->table->n_ref_count == 1);
  
  Approved on IM by Jimmy Yang.
------------------------------------------------------------
revno: 3604 [merge]
committer: chuck.bell@oracle.com
branch nick: mysql-trunk
timestamp: Fri 2011-11-11 14:59:36 -0500
message:
  BUG#12929028 merge from mysql-5.5
    ------------------------------------------------------------
    revno: 2875.321.22
    committer: chuck.bell@oracle.com
    branch nick: mysql-12929028-rel
    timestamp: Fri 2011-11-11 14:44:51 -0500
    message:
      BUG#12929028: mysql_plugin : the --mysqld option is required, but not used
      
      This patch corrects a defect whereby the --mysqld, --my-print-defaults, 
      and --plugin-ini were required. These options are not required and the
      code has been fixed accordingly.
------------------------------------------------------------
revno: 3603 [merge]
committer: Luis Soares <luis.soares@oracle.com>
branch nick: mysql-trunk
timestamp: Fri 2011-11-11 17:44:28 +0000
message:
  WL#4143
  
  Automerged follow-up patch (fixing typo) into latest mysql-trunk 
  from mysql-trunk-wl4143.
    ------------------------------------------------------------
    revno: 3457.1.8
    committer: Luis Soares <luis.soares@oracle.com>
    branch nick: mysql-trunk-wl4143
    timestamp: Fri 2011-11-11 17:37:44 +0000
    message:
      WL#4143
      
      Follow-up patch to fix typo in the error code symbolic name:
      ER_SQLTHREAD_WITH_SECURE_SALVE --> ER_SQLTHREAD_WITH_SECURE_SLAVE
------------------------------------------------------------
revno: 3602
committer: Norvald H. Ryeng <norvald.ryeng@oracle.com>
branch nick: mysql-trunk-11766440
timestamp: Fri 2011-11-11 16:26:18 +0100
message:
  Bug#11766440 59546: Assertion m_sp == __null fails in
  Item_func_sp::init_result_field with functions
  
  Problem: An assertion is triggered when selecting from a view that
  selects from a view that uses a user defined function that has been
  deleted.
  
  During join preparation, Item_field::fix_fields() calls
  find_field_in_tables(), which discovers that the function is missing
  and reports an error. This error is not handled before a call to
  Item_field::fix_outer_field(), which in the end nests to
  Item_func_s::init_result_field(), where the assertion is triggered.
  
  Fix: Test for thd->is_error() after calling find_field_in_tables().
------------------------------------------------------------
revno: 3601 [merge]
committer: Jorgen Loland <jorgen.loland@oracle.com>
branch nick: mysql-trunk
timestamp: Fri 2011-11-11 13:36:01 +0100
message:
  Automerge opt-team -> trunk
    ------------------------------------------------------------
    revno: 2876.249.433
    committer: Sergey Glukhov <sergey.glukhov@oracle.com>
    branch nick: mysql-next-mr-opt-team
    timestamp: Fri 2011-11-11 11:17:08 +0300
    message:
      pushbuild failure fix
    ------------------------------------------------------------
    revno: 2876.249.432 [merge]
    committer: Jorgen Loland <jorgen.loland@oracle.com>
    branch nick: mysql-next-mr-opt-team
    timestamp: Thu 2011-11-10 14:07:00 +0100
    message:
      Automerge opt-backporting -> opt-team
        ------------------------------------------------------------
        revno: 2876.466.15
        committer: Roy Lyseng <roy.lyseng@oracle.com>
        branch nick: mysql-review
        timestamp: Thu 2011-11-10 14:01:02 +0100
        message:
          Bug#13106350: MRR initialization on a derived table caused crash
          
          Temporary test file modifications that should be reversed when backporting
          is merged to trunk.
    ------------------------------------------------------------
    revno: 2876.249.431 [merge]
    committer: Jorgen Loland <jorgen.loland@oracle.com>
    branch nick: mysql-next-mr-opt-team
    timestamp: Thu 2011-11-10 14:05:08 +0100
    message:
      Merge opt-backporting -> opt-team
        ------------------------------------------------------------
        revno: 2876.466.14
        committer: Sergey Glukhov <sergey.glukhov@oracle.com>
        branch nick: mysql-next-mr-opt-backporting
        timestamp: Thu 2011-11-10 10:42:43 +0300
        message:
          Bug#13358379 EXPLAIN SELECT ... PROCEDURE ANALYZE CRASHES THE SERVER
          Problem: code which is realted to PROCEDURE resultpreparation
                   is missing in JOIN::explain().
          Fix:     code which is related to PROCEDURE result preparation
                   is moved into JOIN::prepare_result.
        ------------------------------------------------------------
        revno: 2876.466.13
        committer: Roy Lyseng <roy.lyseng@oracle.com>
        branch nick: mysql-sb5
        timestamp: Wed 2011-11-09 10:04:15 +0100
        message:
          Bug#13334882: assertion table->sort.record_pointers == __null
          
          When assigning ref access methods for a join operation, references
          to expressions in an outer query context are also considered.
          However, such expressions are not available when materializing a
          semi-join nest, so they have to be masked away. This happened only
          half-way: OUTER_REF_TABLE_BIT was masked away in
          JOIN::set_access_methods() when calling create_ref_for_key(), but it was
          not masked away when analyzing ref expressions in best_access_path().
          The results was that the ref access object was incomplete when
          accessing the storage layer, and an assert was raised.
          
          mysql-test/include/subquery_sj.inc
            Added test case for bug#13334882
          
          mysql-test/r/subquery_sj_all.result
          mysql-test/r/subquery_sj_all_bka.result
          mysql-test/r/subquery_sj_all_bka_nixbnl.result
          mysql-test/r/subquery_sj_all_bkaunique.result
          mysql-test/r/subquery_sj_dupsweed.result
          mysql-test/r/subquery_sj_dupsweed_bka.result
          mysql-test/r/subquery_sj_dupsweed_bka_nixbnl.result
          mysql-test/r/subquery_sj_dupsweed_bkaunique.result
          mysql-test/r/subquery_sj_firstmatch.result
          mysql-test/r/subquery_sj_firstmatch_bka.result
          mysql-test/r/subquery_sj_firstmatch_bka_nixbnl.result
          mysql-test/r/subquery_sj_firstmatch_bkaunique.result
          mysql-test/r/subquery_sj_loosescan.result
          mysql-test/r/subquery_sj_loosescan_bka.result
          mysql-test/r/subquery_sj_loosescan_bka_nixbnl.result
          mysql-test/r/subquery_sj_loosescan_bkaunique.result
          mysql-test/r/subquery_sj_mat.result
          mysql-test/r/subquery_sj_mat_bka.result
          mysql-test/r/subquery_sj_mat_bka_nixbnl.result
          mysql-test/r/subquery_sj_mat_bkaunique.result
          mysql-test/r/subquery_sj_mat_nosj.result
          mysql-test/r/subquery_sj_none.result
          mysql-test/r/subquery_sj_none_bka.result
          mysql-test/r/subquery_sj_none_bka_nixbnl.result
          mysql-test/r/subquery_sj_none_bkaunique.result
            Added test case results for bug#13334882
          
          sql/sql_select.cc
            When initializing excluded_tables in Optimize_table_order, add
            OUTER_REF_TABLE_BIT as an excluded table.
            Also in make_join_select(): make sure that outer tables are not
            available when pushing condition parts into a materialized semi-join
            nests.
        ------------------------------------------------------------
        revno: 2876.466.12
        committer: Roy Lyseng <roy.lyseng@oracle.com>
        branch nick: mysql-sb1
        timestamp: Tue 2011-11-08 13:06:01 +0100
        message:
          Bug#13335319: Segmentation fault when analyzing FirstMatch semi-join strategy
          
          There was a segmentation fault inside
          semijoin_firstmatch_loosescan_access_paths() because it was called
          with first_firstmatch_table = MAX_TABLES. The reason for this was that
          first_firstmatch_table was copied from the previous position, then
          the test (outer_corr_tables & pos->first_firstmatch_rtbl) caused
          first_firstmatch_table to be set to MAX_TABLES, but we nevertheless
          called the access path calculation function.
          
          The fix is to always copy first_firstmatch_table from the previous
          position (the old behaviour was using some heuristics that FirstMatch
          would not be considered if FirstMatch was really selected for the
          previous position, but it would be considered if a different strategy
          was select), and to never call the access path calculation function
          if the semi-join tables were dependent on outer tables in
          remaining_tables.
          
          mysql-test/include/subquery_sj.inc
            Added test case for bug#13335319
          
          mysql-test/r/subquery_sj_all.result
          mysql-test/r/subquery_sj_all_bka.result
          mysql-test/r/subquery_sj_all_bka_nixbnl.result
          mysql-test/r/subquery_sj_all_bkaunique.result
          mysql-test/r/subquery_sj_dupsweed.result
          mysql-test/r/subquery_sj_dupsweed_bka.result
          mysql-test/r/subquery_sj_dupsweed_bka_nixbnl.result
          mysql-test/r/subquery_sj_dupsweed_bkaunique.result
          mysql-test/r/subquery_sj_firstmatch.result
          mysql-test/r/subquery_sj_firstmatch_bka.result
          mysql-test/r/subquery_sj_firstmatch_bka_nixbnl.result
          mysql-test/r/subquery_sj_firstmatch_bkaunique.result
          mysql-test/r/subquery_sj_loosescan.result
          mysql-test/r/subquery_sj_loosescan_bka.result
          mysql-test/r/subquery_sj_loosescan_bka_nixbnl.result
          mysql-test/r/subquery_sj_loosescan_bkaunique.result
          mysql-test/r/subquery_sj_mat.result
          mysql-test/r/subquery_sj_mat_bka.result
          mysql-test/r/subquery_sj_mat_bka_nixbnl.result
          mysql-test/r/subquery_sj_mat_bkaunique.result
          mysql-test/r/subquery_sj_mat_nosj.result
          mysql-test/r/subquery_sj_none.result
          mysql-test/r/subquery_sj_none_bka.result
          mysql-test/r/subquery_sj_none_bka_nixbnl.result
          mysql-test/r/subquery_sj_none_bkaunique.result
            Added test case results for bug#13335319
          
          sql/sql_select.cc
            Assigns pos->first_firstmatch_table unconditionally from
            strategy decision from previous position.
            Adds the tables of a semi-join nest to pos->firstmatch_need_tables
            only once per position.
            Assures that semijoin_firstmatch_loosescan_access_paths() is not
            called when semi-join nest is dependent on outer table that is not
            in the join prefix. 
        ------------------------------------------------------------
        revno: 2876.466.11
        committer: Jorgen Loland <jorgen.loland@oracle.com>
        branch nick: mysql-next-mr-opt-backporting-review
        timestamp: Tue 2011-11-08 12:37:54 +0100
        message:
          WL#5860: Make COST_VECT a properly encapsulated C++ class
                
          This changeset:
           * Changes name of COST_VECT to Cost_estimate
           * Encapsulates variables
           * Merges io_count and io_avg_cost into one variable: io_cost
           * Modifies code that used COST_VECT to use Cost_estimate instead
           * Adds unit tests for the Cost_estimate class
                
          This changeset does NOT change any cost calculations. It is 
          purely a refactoring to an encapsulated C++ class following
          our coding guidelines.
        ------------------------------------------------------------
        revno: 2876.466.10
        committer: Oystein Grovlen <oystein.grovlen@oracle.com>
        branch nick: mysql-next-mr-opt-backporting
        timestamp: Tue 2011-11-08 11:20:56 +0100
        message:
          WL#5559 -  Factor tmp table out of optimizer.
            Part 3: Unify the code for creation of temporary tables
                    for GROUP BY/ORDER BY
          
          Changed JOIN::create_intermediate_table() so that it 
          can be used to create both temporary tables, and let it
          return a pointer to the created table, and use it to also
          create JOIN::exec_tmp_table2.
          	
        ------------------------------------------------------------
        revno: 2876.466.9
        committer: Oystein Grovlen <oystein.grovlen@oracle.com>
        branch nick: mysql-next-mr-opt-backporting
        timestamp: Tue 2011-11-08 11:17:04 +0100
        message:
          WL#5559 -  Factor tmp table out of optimizer.
            Patch 2: Remove curr_join references from JOIN::exec
          
          Most references in JOIN::exec to member fields are indirect
          through local variable curr_join, which may either refer to
          the original JOIN object or a temporary copy of it.  This
          complicates the code significantly.
          
          In order to simplify the code and ease further refactoring
          of JOIN::exec, this patch removes the need for curr_join by, 
          when a temporary copy is used, executing the code directly 
          on the temporary object.
          
          This is achieved by creating a private method, 
          JOIN::execute(JOIN *parent) to be called from JOIN::exec(),
          and move all code after creation of the first temporary table
          to this method. If a temporary copy is needed, then 
          tmp_join->execute(this) is called. Otherwise,
          this->execute(NULL).
          
          The code makes sure that necessary execution data is copied
          from the temporary JOIN object and back to its parent in order
          to be able to reuse it for later executions as before.
          
          A limited number of example queries has been used to verify that
          there is no performance regression.  Also, using gprof it has been
          verified that the functions previously called from JOIN::exec, 
          is still called the same number of times with the new approach.
        ------------------------------------------------------------
        revno: 2876.466.8
        committer: Oystein Grovlen <oystein.grovlen@oracle.com>
        branch nick: mysql-next-mr-opt-backporting
        timestamp: Tue 2011-11-08 11:14:06 +0100
        message:
          WL#5559 -  Factor tmp table out of optimizer. Part 1.
          
          This patch moves the creation of the table to be used 
          for the intermediate step required by DISTINCT/ORDER BY/
          GROUP BY processing, from optimization phase to 
          execution phase.
            
          The code for creating this tables has been moved to a new 
          function, JOIN::create_intermediate_table().
        ------------------------------------------------------------
        revno: 2876.466.7 [merge]
        committer: Jorgen Loland <jorgen.loland@oracle.com>
        branch nick: mysql-next-mr-opt-backporting-review
        timestamp: Tue 2011-11-08 10:02:58 +0100
        message:
          Merge WL#5585 to opt-backporting
            ------------------------------------------------------------
            revno: 2876.467.1
            committer: Sergey Glukhov <sergey.glukhov@oracle.com>
            branch nick: mysql-next-mr-opt-backporting
            timestamp: Mon 2011-10-10 13:08:15 +0400
            message:
              WL#5585 Factor EXPLAIN handling out of JOIN::exec
        ------------------------------------------------------------
        revno: 2876.466.6
        committer: Roy Lyseng <roy.lyseng@oracle.com>
        branch nick: mysql-sb4
        timestamp: Mon 2011-11-07 15:00:01 +0100
        message:
          Bug#13340270: assertion table->sort.record_pointers == __null
          
          bug#12694872 fixed a memory leak in Unique::get(), but did not expect
          Unique::get() to be called twice before the end of the query, where
          buffers are freed.
          
          The solution to this problem is to free the filesort buffers if the
          Unique object is reused.
          
          mysql-test/include/subquery_sj.inc
            Added test case for bug#13340270
          
          mysql-test/r/subquery_sj_all.result
          mysql-test/r/subquery_sj_all_bka.result
          mysql-test/r/subquery_sj_all_bka_nixbnl.result
          mysql-test/r/subquery_sj_all_bkaunique.result
          mysql-test/r/subquery_sj_dupsweed.result
          mysql-test/r/subquery_sj_dupsweed_bka.result
          mysql-test/r/subquery_sj_dupsweed_bka_nixbnl.result
          mysql-test/r/subquery_sj_dupsweed_bkaunique.result
          mysql-test/r/subquery_sj_firstmatch.result
          mysql-test/r/subquery_sj_firstmatch_bka.result
          mysql-test/r/subquery_sj_firstmatch_bka_nixbnl.result
          mysql-test/r/subquery_sj_firstmatch_bkaunique.result
          mysql-test/r/subquery_sj_loosescan.result
          mysql-test/r/subquery_sj_loosescan_bka.result
          mysql-test/r/subquery_sj_loosescan_bka_nixbnl.result
          mysql-test/r/subquery_sj_loosescan_bkaunique.result
          mysql-test/r/subquery_sj_mat.result
          mysql-test/r/subquery_sj_mat_bka.result
          mysql-test/r/subquery_sj_mat_bka_nixbnl.result
          mysql-test/r/subquery_sj_mat_bkaunique.result
          mysql-test/r/subquery_sj_mat_nosj.result
          mysql-test/r/subquery_sj_none.result
          mysql-test/r/subquery_sj_none_bka.result
          mysql-test/r/subquery_sj_none_bka_nixbnl.result
          mysql-test/r/subquery_sj_none_bkaunique.result
            Added test case results for bug#13340270
          
          sql/opt_range.cc
            In QUICK_INDEX_MERGE_SELECT::read_keys_and_merge(), delete existing
            filesort buffers when reusing a Unique buffer.
        ------------------------------------------------------------
        revno: 2876.466.5
        committer: Guilhem Bichot <guilhem.bichot@oracle.com>
        branch nick: opt-back
        timestamp: Wed 2011-11-02 13:47:31 +0100
        message:
          fix for Bug#13335170 - ASSERT IN PLAN_CHANGE_WATCHDOG::~PLAN_CHANGE_WATCHDOG() ON SELECT DISTINCT 
          the "no_changes" parameter of test_if_skip_sort_order() was not honoured.
        ------------------------------------------------------------
        revno: 2876.466.4
        committer: Roy Lyseng <roy.lyseng@oracle.com>
        branch nick: mysql-sb4
        timestamp: Thu 2011-11-03 15:17:25 +0100
        message:
          Bug#12407753: Time to compare a row is missing in cost calculation of semi-join
          
          Stage 3: Fix the bug(s)
          
          What has been done:
           - Adjusted costs for handling temporary tables based on benchmarks.
          
           - Added cost of evaluating a row for all semi-join strategies.
          
           - Semi-join FirstMatch: Intermediate cost calculation assumed join
             buffering was always possible, final cost calculation assumed that
             join buffering could never be used. The truth: Join buffering can be
             used if semi-join nest contains only one table.
          
           - Semi-join LooseScan: Intermediate cost calculation assumed join
             buffering was possible for outer tables (correct), final cost
             calculation assumed that join buffering could never be used.
             Join buffering for outer tables has been enabled.
          
           - Semi-join MaterializeLookup: Join buffering was calculated into
             the cost for materialization, but later turned off.
             Join buffering for this strategy has been enabled.
          
           - Semi-join MaterializeScan: Join buffering was calculated into
             the cost for materialization, but later turned off.
             Join buffering for this strategy has been enabled.
             Made sure that join buffering for semi-join materialization
             is not linked with an immediately following join buffer.
          
           - Semi-join DuplicateWeedout: Prefix cost was erroneously picked from
             positions[first_tab] instead of positions[first_tab-1].
             See also bug#11757320.
          
           - Prefix cost was sometimes picked erroneously, when the previous
             table combination was also a semi-join.
          
          mysql-test/r/derived.result
            Recorded new result file.
          
          mysql-test/r/group_by.result
            Semi-join strategy changed from FirstMatch to Materialize.
            Occurs because materialization strategy has fewer compares than FM.
          
          mysql-test/r/innodb_explain_non_select_all.result
            Handler calls are reduced with new plan.
          
          mysql-test/r/join_cache_bka.result
          mysql-test/r/join_cache_bka_nixbnl.result
          mysql-test/r/join_cache_bkaunique.result
          mysql-test/r/join_cache_bnl.result
          mysql-test/r/join_cache_nojb.result
            Strategy change from DupsWeedout to MaterializeScan seems OK.
          
          mysql-test/r/myisam_explain_non_select_all.result
            Two tables swapped in FirstMatch strategy. Number of handler calls
            reduced. Change seems reasonable.
          
          mysql-test/r/subquery_all.result
          mysql-test/r/subquery_all_bka.result
            Handler calls (Handler_read_rnd_next) have increased, but there is
            also a decrease for Handler_read_key and Handler_read_next.
          
          mysql-test/r/subquery_mat_all.result
            Strategy changes from FirstMatch to Materialize seem OK.
            Strategy change from Materialize to FirstMatch seems OK.
          
          mysql-test/r/subquery_sj_all.result
          mysql-test/r/subquery_sj_all_bka.result
          mysql-test/r/subquery_sj_all_bkaunique.result
            Strategy changes from Materialize to FirstMatch seem OK.
            Caused by adding cost of materialization table creation.
            Strategy changes from DupsWeedout to Materialize(Scan) seems OK.
            Caused because materialization table is less costly than weedout table.
            Strategy changes from DupsWeedout to FirstMatch seem OK.
            Caused because added cost for DupsWeedout.
            Strategy change from FirstMatch to Materialize is correct.
            Strategy changes from LooseScan/BNL to Materialize seem OK.
          
          mysql-test/r/subquery_sj_all_bka_nixbnl.result
            Strategy changes from Materialize to FirstMatch seem OK.
            Strategy changes from DupsWeedout to MaterializeScan seem OK.
            Strategy changes from DupsWeedout to FirstMatch seem OK.
            Strategy changes from FirstMatch to Materialize seem OK.
          
          mysql-test/r/subquery_sj_dupsweed.result
          mysql-test/r/subquery_sj_dupsweed_bkaunique.result
            Table plan order change for DupsWeed seems OK, BNL for last table
            decreases number of rows read.
          
          mysql-test/r/subquery_sj_dupsweed_bka.result
          mysql-test/r/subquery_sj_dupsweed_bka_nixbnl.result
            Changes are OK.
          
          mysql-test/r/subquery_sj_firstmatch.result
          mysql-test/r/subquery_sj_firstmatch_bka.result
          mysql-test/r/subquery_sj_firstmatch_bka_nixbnl.result
          mysql-test/r/subquery_sj_firstmatch_bkaunique.result
            Table order changes seems OK, number of rows scanned is reduced.
            Strategy changes from DupsWeedout to FirstMatch seem OK.
          
          mysql-test/r/subquery_sj_innodb_all.result
          mysql-test/r/subquery_sj_innodb_all_bkaunique.result
            Strategy changes from DupsWeedout to MaterializeScan seem OK.
          
          mysql-test/r/subquery_sj_loosescan.result
          mysql-test/r/subquery_sj_loosescan_bka.result
          mysql-test/r/subquery_sj_loosescan_bka_nixbnl.result
          mysql-test/r/subquery_sj_loosescan_bkaunique.result
            Strategy changes from LooseScan to DupsWeedout seem OK.
          
          mysql-test/r/subquery_sj_mat.result
          mysql-test/r/subquery_sj_mat_bka.result
          mysql-test/r/subquery_sj_mat_bka_nixbnl.result
          mysql-test/r/subquery_sj_mat_bkaunique.result
            Strategy changes from DupsWeedout to Materialize seem OK.
          
          mysql-test/suite/opt_trace/r/bugs_no_prot_all.result
          mysql-test/suite/opt_trace/r/bugs_ps_prot_all.result
          mysql-test/suite/opt_trace/r/general_no_prot_all.result
          mysql-test/suite/opt_trace/r/general_ps_prot_all.result
            Some changes, mostly because of changed costs.
          
          mysql-test/t/derived.test
            Plan changed, needed to force use of DuplicateWeedout
          
          sql/sql_const.h
            Adjusted cost factors for creation of temporary tables based on
            actual benchmarks.
            Adjusted costs for temporary table row operations based on benchmark.
            Actually, lookup and write operations are equally costly.
          
          sql/sql_select.cc
            optimize_semijoin_nests(): Added cost for creation of temporary table.
            Adjusted size of materialized table because of duplicate elimination.
          
            get_best_combination(): Set JOIN_TAB reference in best_positions
            to NULL when creating final JOIN_TAB array. Forgotten refactoring.
          
            setup_join_buffering(): Sets up join buffering based on corrected
            decisions for all semi-join strategies. Prevent linking with previous
            join cache when previous operation is Materialization.
          
            semijoin_fm_ls_access_paths() will now calculate new access paths
            and cost for FirstMatch and LooseScan semi-join strategies,
            based on corrected join buffering choices. ROW_EVALUATE_COST
            is added to the cost calculation.
          
            semijoin_mat_scan_access_paths(): ROW_EVALUATE_COST is added to
            the cost calculation.
          
            semijoin_dupsweedout_access_paths(): ROW_EVALUATE_COST is added to
            the cost calculation.
            Prefix cost is adjusted, see bug#11757320.
          
            advance_sj_state(): Best semi-join cost is written back to
            prefix_cost and prefix_record_count. These are actually the same
            values as the output arguments current_cost and current_rowcount,
            only with a different representation.
            They must be adjusted because they are needed when looking for
            prefix cost inside the semijoin_*_access_paths() functions.  
        ------------------------------------------------------------
        revno: 2876.466.3
        committer: Evgeny Potemkin <evgeny.potemkin@oracle.com>
        branch nick: mysql-next-mr-opt-backporting
        timestamp: Wed 2011-11-02 16:52:33 +0400
        message:
          Bug#13261277: Unchecked key length caused missing records.
          When a key for derived table is created it wasn't checked that key length is
          below tmp table engine's maximum supported key length. Too long key caused
          wrong key generated when switching from heap to myisam. This led to
          missing rows and errors when storing rows in tmp table.
          
          Now TABLE::add_tmp_key checks if the key length is below allowed limit and
          ignores the key otherwise.
        ------------------------------------------------------------
        revno: 2876.466.2 [merge]
        committer: Evgeny Potemkin <evgeny.potemkin@oracle.com>
        branch nick: mysql-next-mr-opt-backporting
        timestamp: Tue 2011-11-01 10:25:07 +0400
        message:
          Auto-merge.
            ------------------------------------------------------------
            revno: 2876.465.6
            committer: Jorgen Loland <jorgen.loland@oracle.com>
            branch nick: mysql-next-mr-opt-backporting
            timestamp: Mon 2011-10-31 11:13:09 +0100
            message:
              Fixed test failure in derived.test: result file had not been 
              recorded after update of an "--echo"
        ------------------------------------------------------------
        revno: 2876.466.1
        committer: Evgeny Potemkin <evgeny.potemkin@oracle.com>
        branch nick: mysql-next-mr-opt-backporting
        timestamp: Mon 2011-10-31 14:05:49 +0400
        message:
          Fixed silly test failure.
    ------------------------------------------------------------
    revno: 2876.249.430 [merge]
    committer: Jorgen Loland <jorgen.loland@oracle.com>
    branch nick: mysql-next-mr-opt-team
    timestamp: Thu 2011-11-10 10:43:41 +0100
    message:
      Null-merge opt-backporting -> opt-team
        ------------------------------------------------------------
        revno: 2876.465.5 [merge]
        committer: Jorgen Loland <jorgen.loland@oracle.com>
        branch nick: mysql-next-mr-opt-backporting
        timestamp: Mon 2011-10-31 09:27:57 +0100
        message:
          Null-merge mysql-trunk -> opt-backporting
    ------------------------------------------------------------
    revno: 2876.249.429 [merge]
    committer: Jorgen Loland <jorgen.loland@oracle.com>
    branch nick: mysql-next-mr-opt-team
    timestamp: Thu 2011-11-10 10:42:26 +0100
    message:
      Merge opt-backporting -> opt-team
        ------------------------------------------------------------
        revno: 2876.465.4 [merge]
        committer: Jorgen Loland <jorgen.loland@oracle.com>
        branch nick: mysql-next-mr-opt-backporting
        timestamp: Mon 2011-10-31 09:25:18 +0100
        message:
          Automerge mysql-trunk -> opt-backporting.
        ------------------------------------------------------------
        revno: 2876.465.3
        committer: Evgeny Potemkin <evgeny.potemkin@oracle.com>
        branch nick: mysql-next-mr-opt-backporting
        timestamp: Fri 2011-10-28 17:09:17 +0400
        message:
          Bug#13105833: Crash when using LooseScan sj-strategy for a view.
          Key generation for derived tables weren't supposed to be used with semijoin
          subquery transformation. This caused server crash when optimizer tried to
          initialize LooseScan strategy over a materialisable view. To avoid this
          LooseScan strategy is temporary denied for materializable views/derived
          tables as enabling it requires better cost model and thorough testing.
          This will be addressed in a separate WL.
        ------------------------------------------------------------
        revno: 2876.465.2 [merge]
        committer: Evgeny Potemkin <evgeny.potemkin@oracle.com>
        branch nick: mysql-next-mr-opt-backporting
        timestamp: Thu 2011-10-27 17:38:23 +0400
        message:
          Auto-merged fix for bug#13107577.
        ------------------------------------------------------------
        revno: 2876.465.1
        committer: Evgeny Potemkin <evgeny.potemkin@oracle.com>
        branch nick: mysql-next-mr-opt-backporting
        timestamp: Thu 2011-10-27 14:22:55 +0400
        message:
          Bug#13107577: Derived table in a semi-join caused failed assertion.
          SELECT_LEX has two table lists - table_list and leaf_tables. The first one
          is built during query parsing, linked via TABLE_LIST::next_local field and
          represents list of tables noted in FROM clause. The second one is build by
          make_leaves_list, linked via TABLE_LIST::next_leaf and represents list of
          all tables for the SELECT_LEX node including tables from mergeable views.
          When query uses mergeable views table_list/next_local chain gets broken by
          last tables from views, for which next_local field is NULL.
          When a subquery is being converted to a semi-join the leaf_tables list is
          used as the subquery's table list. Due to this when JOIN::exec
          tries to instantiate derived result tables SELECT_LEX::handle_derived
          follows table_list/next_local chain and as it doesn't link all tables in
          select a derived result tables following a mergeable view didn't get
          instantiated. This caused failed assertion during derived table
          materialization.
          
          Now SELECT_LEX::handle_derived uses leaf_table/next_leaf chain for
          traversing table list.
          convert_subquery_to_semijoin now uses SELECT_LEX::table_list as the head of
          next_local table chain.
    ------------------------------------------------------------
    revno: 2876.249.428 [merge]
    committer: Jorgen Loland <jorgen.loland@oracle.com>
    branch nick: mysql-next-mr-opt-team
    timestamp: Mon 2011-10-31 09:53:38 +0100
    message:
      Automerge mysql-trunk to opt-team
    ------------------------------------------------------------
    revno: 2876.249.427 [merge]
    committer: Jorgen Loland <jorgen.loland@oracle.com>
    branch nick: mysql-next-mr-opt-team
    timestamp: Mon 2011-10-31 09:25:11 +0100
    message:
      Automerge mysql-trunk -> opt-team.
------------------------------------------------------------
revno: 3600
committer: Tor Didriksen <tor.didriksen@oracle.com>
branch nick: trunk
timestamp: Fri 2011-11-11 13:25:23 +0100
message:
  WL#5825 Using C++ Standard Library with MySQL code
  
  Post-push cleanups.
------------------------------------------------------------
revno: 3599 [merge]
committer: Sergey Glukhov <sergey.glukhov@oracle.com>
branch nick: mysql-trunk
timestamp: Fri 2011-11-11 13:15:35 +0300
message:
  automerge
    ------------------------------------------------------------
    revno: 3597.1.1 [merge]
    committer: Luis Soares <luis.soares@oracle.com>
    branch nick: mysql-trunk-push
    timestamp: Fri 2011-11-11 10:06:39 +0000
    message:
      WL#4143
      
      Automerged mysql-trunk-wl4143 into latest mysql-trunk.
        ------------------------------------------------------------
        revno: 3457.1.7
        committer: Luis Soares <luis.soares@oracle.com>
        branch nick: mysql-trunk-wl4143
        timestamp: Wed 2011-11-09 13:22:47 +0000
        message:
          WL#4143
          
          Fixing a -Werror on behalf of Alfranio (slave_was_killed= 0).
          
          In addition, deployed an error message when get_password
          fails to retrieve a password when attempting to connect to the
          master and made the function return immediately. Before, there
          could be the case that the slave failed to retrieve the password
          and later assumed that the connection was established, when 
          indeed it was not.
        ------------------------------------------------------------
        revno: 3457.1.6
        committer: Alfranio Correia <alfranio.correia@oracle.com>
        branch nick: mysql-trunk-wl4143
        timestamp: Wed 2011-11-09 10:07:45 +0000
        message:
          The test case rewrite_general_log is executed in both embedded and
          non-embedded mode thus causing result mismatches after the WL#4143.
          To fix this, we disable warning messages when "CHANGE MASTER TO"
          is executed.
        ------------------------------------------------------------
        revno: 3457.1.5
        committer: Alfranio Correia <alfranio.correia@oracle.com>
        branch nick: mysql-trunk-wl4143
        timestamp: Wed 2011-11-09 09:33:14 +0000
        message:
          Fixed test cases after merging with trunk due to changes in the error code.
        ------------------------------------------------------------
        revno: 3457.1.4
        committer: Alfranio Correia <alfranio.correia@oracle.com>
        branch nick: mysql-trunk-wl4143
        timestamp: Mon 2011-11-07 16:17:30 +0000
        message:
          WL#4143
          
          Fixed test cases after merging with trunk as the error numbers were changed.
        ------------------------------------------------------------
        revno: 3457.1.3 [merge]
        committer: Alfranio Correia <alfranio.correia@oracle.com>
        branch nick: mysql-trunk-wl4143
        timestamp: Fri 2011-11-04 16:07:37 +0000
        message:
          merge mysql-trunk --> mysql-trunk-wl4143
        ------------------------------------------------------------
        revno: 3457.1.2
        committer: Alfranio Correia <alfranio.correia@oracle.com>
        branch nick: mysql-trunk-wl4143
        timestamp: Fri 2011-11-04 15:25:28 +0000
        message:
          BUG#13083642 - START SLAVE SQL_THREAD USER="USER" PASSWORD="PASSWORD" 
          
          Using START SLAVE SQL_THREAD when user's authentication information
          is provided does not make much sense as such information is only
          used by the IO_THREAD.
          
          So we forbid users from use SQL_THREAD when user's authentication
          information is provided.
          
          Notice though that it is possible to use START SLAVE IO_THREAD with
          the "UNTIL" clause although it only affects SQL_THREAD's behavior.
        ------------------------------------------------------------
        revno: 3457.1.1
        committer: Alfranio Correia <alfranio.correia@oracle.com>
        branch nick: mysql-trunk
        timestamp: Sun 2011-10-02 09:25:38 +0100
        message:
          WL#4143
------------------------------------------------------------
revno: 3598
committer: Sergey Glukhov <sergey.glukhov@oracle.com>
branch nick: mysql-trunk
timestamp: Fri 2011-11-11 13:08:13 +0300
message:
  Bug#13362660 ASSERTION `FIELD_POS < FIELD_COUNT' FAILED. IN PROTOCOL_TEXT::STORE
  The problem is that Item_func_spatial_operation::val_str() method
  does not return zero value in case of null_value result and
  it breaks the logic of Item::send() method where non-zero
  result is treated as not null value.
  The fix is to return 0 if null_value is TRUE.
------------------------------------------------------------
revno: 3597 [merge]
committer: Sneha Modi<sneha.modi@oracle.com>
branch nick: mysql-trunk
timestamp: Fri 2011-11-11 14:55:18 +0530
message:
  BUG#11748731 - 37248: SOME 'BIG' TESTS FAILING ON 6.0 :
  
  Merging from mysql-5.5 -> mysql-trunk
    ------------------------------------------------------------
    revno: 2875.321.21
    committer: Sneha Modi<sneha.modi@oracle.com>
    branch nick: mysql-5.5
    timestamp: Fri 2011-11-11 14:53:50 +0530
    message:
      BUG#11748731 - 37248: SOME 'BIG' TESTS FAILING ON 6.0 :
      
      A change has been made in the sql/sql_table.cc file to include debug_sync.
------------------------------------------------------------
revno: 3596
committer: Jon Olav Hauglid <jon.hauglid@oracle.com>
branch nick: mysql-trunk-test
timestamp: Fri 2011-11-11 09:43:43 +0100
message:
  BUG#11761014 - 53466: END_CONNECTION() SHOULD REFERENCE
                 GLOBAL_SYSTEM_VARIABLES.LOG_WARNINGS 
  
  Post-push fix: Update result file for 32 bit version
  og log_warnings test.
------------------------------------------------------------
revno: 3595
committer: Jorgen Loland <jorgen.loland@oracle.com>
branch nick: mysql-trunk
timestamp: Fri 2011-11-11 09:11:38 +0100
message:
  Bug#12578908: SELECT SQL_BUFFER_RESULT OUTPUTS TOO MANY ROWS 
                WHEN GROUP IS CONSTANT
  
  For all but simple grouped queries, temporary tables are used to
  resolve grouping. In these cases, the list of grouping fields is
  stored in the temporary table and grouping is resolved
  there (e.g. by adding a unique constraint on the involved
  fields). Because of this, grouping is not done when inserting
  rows into the temporary table.
  
  In the case where a group clause may be optimized away, grouping
  does not have to be resolved using a temporary table. However, if
  a temporary table is explicitly requested (e.g. because the
  SQL_BUFFER_RESULT hint is used, or the statement is
  INSERT...SELECT), a temporary table is used anyway. In this case,
  the temporary table is created with an empty group list (because
  the group clause was optimized away) and it will therefore not
  create groups. At the same time, make_simple_join() assumes that
  since a temporary table is used, grouping will be taken care of
  and sets JOIN::group to false. 
  
  The fix is in make_simple_join(), and is to not set JOIN::group
  to false in the unlikely event that a temporary table is used for
  a query where the group clause was optimized away. With this
  change, end_{send|write}_group() is used when reading from the
  temporary table. This is the same function as is used when a
  temporary table is not explicitly requested.
------------------------------------------------------------
revno: 3594
committer: Sunny Bains <Sunny.Bains@Oracle.Com>
branch nick: trunk
timestamp: Fri 2011-11-11 17:14:11 +1100
message:
  Fix bug#13363044 FAILING ASSERTION: ERR == DB_SUCCESS IN FILE ROW0VERS.C LINE 144
  
  Checking for DB_SUCCES alone is not sufficient. Not being able to find a
  previous version of the record is a perfectly valid state. This can happen
  because the transaction that created the record has committed and is not
  in purge's view. The caller of row_vers_impl_x_locked_low() has to check
  again whether the transaction is active or not, which it does.
  
  Approved by Jimmy over IM.
------------------------------------------------------------
revno: 3593
committer: Olav Sandstaa <olav.sandstaa@oracle.com>
branch nick: disabled-test
timestamp: Thu 2011-11-10 19:15:44 +0100
message:
  Follow-up patch for Bug#54398 Explain output for estimated number of
  rows varies between runs on InnoDB.
  
  Re-enable two test cases that was disabled due to variations in
  row estimates in explain output. The fix is to replace the row estimate
  column with a # pattern.
------------------------------------------------------------
revno: 3592 [merge]
committer: Marko M?kel? <marko.makela@oracle.com>
branch nick: mysql-trunk
timestamp: Thu 2011-11-10 16:58:37 +0200
message:
  Merge mysql-5.5 to mysql-trunk.
    ------------------------------------------------------------
    revno: 2875.321.20 [merge]
    committer: Marko M?kel? <marko.makela@oracle.com>
    branch nick: mysql-5.5
    timestamp: Thu 2011-11-10 16:50:34 +0200
    message:
      Merge mysql-5.1 to mysql-5.5.
        ------------------------------------------------------------
        revno: 2661.809.55
        committer: Marko M?kel? <marko.makela@oracle.com>
        branch nick: mysql-5.1
        timestamp: Thu 2011-11-10 16:45:47 +0200
        message:
          Bug #12842206 INNODB LOCKING REGRESSION FOR INSERT IGNORE: Add a test case.
          The bug was accidentally fixed by fixing
          Bug#11759688 52020: InnoDB can still deadlock on just INSERT...ON DUPLICATE KEY
          a.k.a. the reintroduction of
          Bug#7975 deadlock without any locking, simple select and update
------------------------------------------------------------
revno: 3591 [merge]
committer: Sneha Modi<sneha.modi@oracle.com>
branch nick: mysql-trunk
timestamp: Thu 2011-11-10 17:29:23 +0530
message:
  Bug#11748731 - 37248: SOME 'BIG' TESTS FAILING ON 6.0:
    
   Merging from mysql-5.5 -> mysql-trunk
    ------------------------------------------------------------
    revno: 2875.321.19
    committer: Sneha Modi<sneha.modi@oracle.com>
    branch nick: mysql-5.5
    timestamp: Thu 2011-11-10 17:18:41 +0530
    message:
      Bug#11748731 - 37248: SOME 'BIG' TESTS FAILING ON 6.0:
      
      alter_treable-big.test was failing due to the use of RAND() function which is no more 
      replication safe.
      This has been modified using static values.
      
      Also, 'sleep' has been replaced using 'debug_sync' and the execution time of the 
      test has been reduced significantly.
      
      This test is now taken out of the disabled.def file and is being enabled.
------------------------------------------------------------
revno: 3590
committer: kevin.lewis@oracle.com
branch nick: mysql-trunk
timestamp: Thu 2011-11-10 05:55:42 -0600
message:
  Bug#13357607 - New test suite/innodb/innodb-restart.test fails in embedded mode.
  Use -- source include/not_embedded.inc
------------------------------------------------------------
revno: 3589 [merge]
committer: Marko M?kel? <marko.makela@oracle.com>
branch nick: mysql-trunk
timestamp: Thu 2011-11-10 13:28:09 +0200
message:
  Merge mysql-5.5 to mysql-trunk.
    ------------------------------------------------------------
    revno: 2875.321.18 [merge]
    committer: Marko M?kel? <marko.makela@oracle.com>
    branch nick: mysql-5.5
    timestamp: Thu 2011-11-10 13:08:42 +0200
    message:
      Merge mysql-5.1 to mysql-5.5.
        ------------------------------------------------------------
        revno: 2661.809.54
        committer: Marko M?kel? <marko.makela@oracle.com>
        branch nick: mysql-5.1
        timestamp: Thu 2011-11-10 12:49:31 +0200
        message:
          Bug#11759688 52020: InnoDB can still deadlock on just INSERT...ON DUPLICATE KEY
          a.k.a. Bug#7975 deadlock without any locking, simple select and update
          
          Bug#7975 was reintroduced when the storage engine API was made
          pluggable in MySQL 5.1. Instead of looking at thd->lex directly, we
          rely on handler::extra(). But, we were looking at the wrong extra()
          flag, and we were ignoring the TRX_DUP_REPLACE flag in places where we
          should obey it.
          
          innodb_replace.test: Add tests for hopefully all affected statement
          types, so that bug should never ever resurface. This kind of tests
          should have been added when fixing Bug#7975 in MySQL 5.0.3 in the
          first place.
          
          rb:806 approved by Sunny Bains
------------------------------------------------------------
revno: 3588 [merge]
committer: Sergey Vojtovich <sergey.vojtovich@oracle.com>
branch nick: mysql-trunk-push
timestamp: Thu 2011-11-10 13:56:51 +0400
message:
  (no message)
    ------------------------------------------------------------
    revno: 2875.321.17 [merge]
    committer: Sergey Vojtovich <sergey.vojtovich@oracle.com>
    branch nick: mysql-5.5-push
    timestamp: Thu 2011-11-10 13:53:08 +0400
    message:
      (no message)
------------------------------------------------------------
revno: 3587 [merge]
committer: Sergey Vojtovich <sergey.vojtovich@oracle.com>
branch nick: mysql-trunk-push
timestamp: Thu 2011-11-10 13:55:20 +0400
message:
  (no message)
    ------------------------------------------------------------
    revno: 3585.1.1 [merge]
    committer: Sergey Vojtovich <sergey.vojtovich@oracle.com>
    branch nick: mysql-trunk-bug56652
    timestamp: Thu 2011-11-10 10:54:33 +0400
    message:
      (no message)
        ------------------------------------------------------------
        revno: 2875.322.1
        committer: Sergey Vojtovich <sergey.vojtovich@oracle.com>
        branch nick: mysql-5.5-bug56652
        timestamp: Thu 2011-11-10 10:43:34 +0400
        message:
          BUG#11763882 - 56652: VALGRIND WARNINGS FOR MEMORY LEAK IN
                                ALTER TABLE AND/OR PLUGIN/SEMISYNC
          
          If a plugin was uninstalled, thread local values for plugin
          variables of string type with PLUGIN_VAR_MEMALLOC flag were
          not freed.
          
          With this patch these variables are freed when thread is
          done (like all other variables).
------------------------------------------------------------
revno: 3586
committer: Raghav Kapoor <raghav.kapoor@oracle.com>
branch nick: mysql-trunk-bug-11761014
timestamp: Thu 2011-11-10 12:23:27 +0530
message:
  BUG#11761014 - 53466: END_CONNECTION() SHOULD REFERENCE GLOBAL_SYSTEM_VARIABLES.LOG_WARNINGS 
  
  BACKGROUND:
  end_connection prints out messages like this, depending on *session*
  log_warnings value:
  Aborted connection 2 to db: 'unconnected' user: 'root' 
  host: '' (Got timeout reading communication packets).
  This is wrong because it allows a minimally privileged user
  to write copious amounts of errors to the .err file, unless 
  he is restricted by the number of MAX_CONNECTIONS_PER_HOUR 
  in his user account.
  
  FIX:
  "Aborted connection..." messages are now printed based on 
  the *global* log_warnings value. Since this was the only real
  remaining use of the session value of log_warnings, the 
  log_warnings system variable has now been made to a global 
  only variable. This is a change of behavior and must be 
  reflected in the documentation.  
------------------------------------------------------------
revno: 3585 [merge]
committer: Sneha Modi<sneha.modi@oracle.com>
branch nick: mysql-trunk
timestamp: Thu 2011-11-10 12:07:03 +0530
message:
   Bug#11754170:45729: TEST CASE FOR BUG#28211 IS DISABLED IN QUERY_CACHE.TEST
        
      Merging from mysql-5.5 -> mysql-trunk
    ------------------------------------------------------------
    revno: 2875.321.16
    committer: Sneha Modi<sneha.modi@oracle.com>
    branch nick: mysql-5.5
    timestamp: Thu 2011-11-10 12:04:23 +0530
    message:
       Bug#11754170:45729: TEST CASE FOR BUG#28211 IS DISABLED IN QUERY_CACHE.TEST
            
            A patch for this bug has already been pushed. A minor change is made here.
            The database to be used after re-enabling the disabled code is 'TEST'.
            But instead, 'MYSQL' was being used. 
            This is the minor change that is being made here.
------------------------------------------------------------
revno: 3584
committer: Anitha Gopi <anitha.gopi@oracle.com>
branch nick: mysql-trunk
timestamp: Thu 2011-11-10 11:30:06 +0530
message:
  Bug#11750645 : Failure was only on Open Solaris which is now obsolete
------------------------------------------------------------
revno: 3583
committer: kevin.lewis@oracle.com
branch nick: mysql-trunk
timestamp: Wed 2011-11-09 08:11:59 -0600
message:
  Bug #13357607 INNODB: WRONG ERROR ON STARTUP AFTER CREATING A COMPRESSED TABLE
        
  The patch for WL#5873 - Table Flags Refactor contained a bug in
  dict_sys_tables_type_validate() which validates the SYS_TABLES.TYPE field
  for each table.  It reported a valid zip_ssize as invalid.  This caused
  compressed tables to not be opened on startup.  Surprisingly, there is no MTR
  test that caught this. So this patch adds a simple innodb-restart.test and
  fixes the bad condition.
  
  Approved by Jimmy Yang in http://bur03.no.oracle.com/rb/r/805/
------------------------------------------------------------
revno: 3582 [merge]
committer: Bjorn Munch <bjorn.munch@oracle.com>
branch nick: main-tr
timestamp: Wed 2011-11-09 14:17:06 +0100
message:
  null upmerge
    ------------------------------------------------------------
    revno: 2875.321.15 [merge]
    committer: Bjorn Munch <bjorn.munch@oracle.com>
    branch nick: main-55
    timestamp: Wed 2011-11-09 14:08:55 +0100
    message:
      merge 5.5-mtr => 5.5
------------------------------------------------------------
revno: 3581 [merge]
committer: Bjorn Munch <bjorn.munch@oracle.com>
branch nick: main-tr
timestamp: Wed 2011-11-09 14:16:02 +0100
message:
  merge trunk-mtr => trunk
    ------------------------------------------------------------
    revno: 3076.1.61 [merge]
    committer: Bjorn Munch <bjorn.munch@oracle.com>
    branch nick: mtr-tr
    timestamp: Wed 2011-11-09 10:09:22 +0100
    message:
      null upmerge
        ------------------------------------------------------------
        revno: 2875.125.190 [merge]
        committer: Bjorn Munch <bjorn.munch@oracle.com>
        branch nick: mtr-55
        timestamp: Wed 2011-11-09 10:06:40 +0100
        message:
          merge 5.5 => 5.5-mtr
    ------------------------------------------------------------
    revno: 3076.1.60 [merge]
    committer: Bjorn Munch <bjorn.munch@oracle.com>
    branch nick: mtr-tr
    timestamp: Wed 2011-11-09 10:08:24 +0100
    message:
      merge trunk => trunk-mtr
    ------------------------------------------------------------
    revno: 3076.1.59 [merge]
    committer: Bjorn Munch <bjorn.munch@oracle.com>
    branch nick: mtr-tr
    timestamp: Wed 2011-11-09 10:05:26 +0100
    message:
      upmerge small test fix from 5.5-mtr
        ------------------------------------------------------------
        revno: 2875.125.189
        committer: Bjorn Munch <bjorn.munch@oracle.com>
        branch nick: mtr-55
        timestamp: Wed 2011-11-09 09:58:18 +0100
        message:
          Followup test fix after 13055685:
            Un-needed replace_result accidentally messed up a variable used
            *if* not running parallel.
            Removed the bogus --replace_result
    ------------------------------------------------------------
    revno: 3076.1.58 [merge]
    committer: Bjorn Munch <bjorn.munch@oracle.com>
    branch nick: mtr-tr
    timestamp: Tue 2011-11-08 16:01:50 +0100
    message:
      upmerge 13055685,13096353
        ------------------------------------------------------------
        revno: 2875.125.188
        committer: Bjorn Munch <bjorn.munch@oracle.com>
        branch nick: dacopy-55
        timestamp: Tue 2011-11-08 15:55:25 +0100
        message:
            Bug #13055685 NO WAY TO REPLACE NON-DETERMINISTIC FRAGMENTS IN OUTPUT OF MTR'S ECHO
              Don't do this for echo, instead:
              1) Enable replacements also for assignment from backquoted SQL
              2) Allow replace_regex to take a variable for the *entire* argument list
            
              With this, the test can be amended, but only in its version in trunk
        ------------------------------------------------------------
        revno: 2875.125.187
        committer: Bjorn Munch <bjorn.munch@oracle.com>
        branch nick: dacopy-55
        timestamp: Thu 2011-11-03 15:57:18 +0100
        message:
          Bug #13096353 62712: RPM-BASED INSTALL OF THE TEST SUITE IS USELESS FOR NON-ROOT USERS
            Simplified fix avoiding changes to mysys:
            Use the MY_HOLD_ORIGINAL_MODES flag when calling my_copy(),
              this also stops it from attempting to chown() the file.
            Yes this behavior is a bit confusing....
            The only case this might change the behavior is if the destination file
              exists, but since we also use MY_DONT_OVERWRITE_FILE, it would fail
              in those cases anyway.
    ------------------------------------------------------------
    revno: 3076.1.57 [merge]
    committer: Bjorn Munch <bjorn.munch@oracle.com>
    branch nick: mtr-tr
    timestamp: Fri 2011-11-04 15:25:44 +0100
    message:
      merge trunk => trunk-mtr
------------------------------------------------------------
revno: 3580
committer: Raghav Kapoor <raghav.kapoor@oracle.com>
branch nick: mysql-trunk-bug-13247871
timestamp: Wed 2011-11-09 16:25:44 +0530
message:
  BUG#13247871 - ER_EVENT_CANNOT_ALTER_IN_THE_PAST HAS WRONG MESSAGE 
  
  BACKGROUND:
  ALTER EVENT, produces the *error* ER_EVENT_CANNOT_ALTER_IN_THE_PAST, 
  but the message is wrong. The message string is the exact 
  same as for the CREATE EVENT warning: "Event execution
  time is in the past and ON COMPLETION NOT PRESERVE is set.
  The event was dropped immediately after creation."
  
  FIX:
  The error message for ER_EVENT_CANNOT_ALTER_IN_THE_PAST has
  been updated and says like this 
  "Event execution time is in the past and ON COMPLETION NOT PRESERVE 
  is set.The event was not changed. Specify a time in the future."
------------------------------------------------------------
revno: 3579
committer: Guilhem Bichot <guilhem.bichot@oracle.com>
branch nick: trunk3
timestamp: Tue 2011-11-08 20:52:19 +0100
message:
  Fix for Bug#13357462 - "OPTIMIZER TRACE BROKE THE INFORMATION SCHEMA, CAUSES MYSQLADMIN CRASH";
  same cause/fix as bug 35997: define a dummy OPTIMIZER_TRACE table when
  the OPTIMIZER_TRACE preprocessor symbol is not defined.
  Otherwise enum_schema_tables and schema_tables[] are not in sync.
------------------------------------------------------------
revno: 3578
committer: Manish Kumar <manish.4.kumar@oracle.com>
branch nick: mysql-trunk-
timestamp: Tue 2011-11-08 20:24:44 +0530
message:
  BUG 11764459 - 57291: BINLOG.BINLOG_TRUNCATE_INNODB IS DISABLED
  
  Problem: As a result of Bug#42643 test binlog.binlog_truncate_innodb was disabled.
           This is a replication test, which stopped to make sense in the new 
           semantics of truncate (42643 changed the semantics).
  
  Fix: The bug is fixed by removing the test and the corresponding result file.
------------------------------------------------------------
revno: 3577
committer: Tor Didriksen <tor.didriksen@oracle.com>
branch nick: trunk
timestamp: Tue 2011-11-08 15:48:33 +0100
message:
  Bug#11748783 37359: FILESORT CAN BE MORE EFFICIENT
  
  Post-push fix: function find_all_keys() changed signature,
  so valgrind suppression must change.
------------------------------------------------------------
revno: 3576
committer: Tor Didriksen <tor.didriksen@oracle.com>
branch nick: trunk
timestamp: Tue 2011-11-08 15:33:41 +0100
message:
  WL#5825 Using C++ Standard Library with MySQL code
  
  Post-push fix: scripts/mysql_config* must distinguish between cflags and cxxflags.
------------------------------------------------------------
revno: 3575 [merge]
committer: Marko M?kel? <marko.makela@oracle.com>
branch nick: mysql-trunk
timestamp: Tue 2011-11-08 14:35:19 +0200
message:
  Merge mysql-5.5 to mysql-trunk.
    ------------------------------------------------------------
    revno: 2875.321.14 [merge]
    committer: Marko M?kel? <marko.makela@oracle.com>
    branch nick: mysql-5.5
    timestamp: Tue 2011-11-08 14:30:58 +0200
    message:
      Merge mysql-5.1 to mysql-5.5.
        ------------------------------------------------------------
        revno: 2661.809.53
        committer: Marko M?kel? <marko.makela@oracle.com>
        branch nick: mysql-5.1
        timestamp: Tue 2011-11-08 14:15:22 +0200
        message:
          Bug#13358468 ASSERTION FAILURE IN BTR_PCUR_GET_BLOCK
          
          btr_pcur_restore_position_func(): When the cursor was positioned at
          the tree infimum or supremum, initialize pos_state and latch_mode. The
          assertion failed, because pos_state was BTR_PCUR_WAS_POSITIONED.  In
          the test failure of WL#5874, the purge thread attempted to restore the
          cursor position on the infimum record (the clustered index was empty).
          
          btr_pcur_detach(), btr_pcur_is_detached(): Unused functions, remove.
          
          rb:804 approved by Inaam Rana
------------------------------------------------------------
revno: 3574
committer: Jon Olav Hauglid <jon.hauglid@oracle.com>
branch nick: mysql-trunk-test
timestamp: Tue 2011-11-08 10:59:12 +0100
message:
  Fix gcc 4.6.1 compilation error:
  error: variable ?info? set but not used
------------------------------------------------------------
revno: 3573
committer: Tor Didriksen <tor.didriksen@oracle.com>
branch nick: trunk-filesort-buffer
timestamp: Tue 2011-11-08 08:51:49 +0100
message:
  Bug#11748783 37359: FILESORT CAN BE MORE EFFICIENT
  
  Post-push fix: sort_buffer_size depends on platform (32 vs 64 bit)
------------------------------------------------------------
revno: 3572 [merge]
committer: Marko M?kel? <marko.makela@oracle.com>
branch nick: mysql-trunk
timestamp: Tue 2011-11-08 09:02:03 +0200
message:
  Merge mysql-5.5 to mysql-trunk.
    ------------------------------------------------------------
    revno: 2875.321.13
    committer: Marko M?kel? <marko.makela@oracle.com>
    branch nick: mysql-5.5
    timestamp: Tue 2011-11-08 08:54:52 +0200
    message:
      Replace void pointer arithmetics with byte pointer arithmetics.
------------------------------------------------------------
revno: 3571
committer: Mayank Prasad <mayank.prasad@oracle.com>
branch nick: emb_defect
timestamp: Tue 2011-11-08 12:10:03 +0530
message:
  bug#12561297 : Disabling mysql_embedded test case
  
  Innodb behavior to expect /usr/local/mysql directory, 
  causes this test case to fail. Therefore disabling it.
------------------------------------------------------------
revno: 3570
committer: Marc Alff <marc.alff@oracle.com>
branch nick: mysql-trunk-cleanup
timestamp: Mon 2011-11-07 21:28:05 -0700
message:
  Fixed several issues affecting the embedded build.
  
  1) in psi.h, do not compile with the performance schema instrumentation,
  for the embedded build.
  
  2) in mysql_socket.h, cleanup compiler warnings when building
  without the socket instrumentation
  
  3) in mysqld.cc, remove un needed code for embedded builds
  
  4) in sql_class.h, remove un needed instrumentation state,
  when compiling for embedded
------------------------------------------------------------
revno: 3569
committer: Tor Didriksen <tor.didriksen@oracle.com>
branch nick: trunk-filesort-buffer
timestamp: Mon 2011-11-07 16:32:36 +0100
message:
  Bug#11748783 37359: FILESORT CAN BE MORE EFFICIENT
  
  filesort() initializes space for
  MIN(Estimate rows in table, max rows that can fit in sort buffer) rows
  before doing the sort. For queries that have a "where" clause, the
  number of rows estimated by estimate_rows_upper_bound can be much
  higher than rows that match the where clause.
  
  The initialization is done via make_char_array() in filesort.cc and is
  very expensive when the estimate is off.
  
  Solution: lazy-init of the pointers in the sort buffer.
------------------------------------------------------------
revno: 3568
committer: Tor Didriksen <tor.didriksen@oracle.com>
branch nick: trunk
timestamp: Mon 2011-11-07 13:17:24 +0100
message:
  WL#5825 Using C++ Standard Library with MySQL code
  
  Post-push fix: different library layout for stlport on intel/sparc.
------------------------------------------------------------
revno: 3567
committer: Marko M?kel? <marko.makela@oracle.com>
branch nick: mysql-trunk
timestamp: Mon 2011-11-07 14:04:41 +0200
message:
  Remove a debug assertion that fails in innodb.innodb_mysql in a join.
------------------------------------------------------------
revno: 3566 [merge]
committer: Marko M?kel? <marko.makela@oracle.com>
branch nick: mysql-trunk
timestamp: Mon 2011-11-07 14:01:16 +0200
message:
  Merge mysql-5.5 to mysql-trunk.
    ------------------------------------------------------------
    revno: 2875.321.12 [merge]
    committer: Marko M?kel? <marko.makela@oracle.com>
    branch nick: mysql-5.5
    timestamp: Mon 2011-11-07 13:51:11 +0200
    message:
      Merge mysql-5.1 to mysql-5.5.
        ------------------------------------------------------------
        revno: 2661.809.52
        committer: Marko M?kel? <marko.makela@oracle.com>
        branch nick: mysql-5.1
        timestamp: Mon 2011-11-07 13:37:19 +0200
        message:
          Add debug assertions to catch Bug#13345378 earlier.
          
          In all callers of row_sel_convert_mysql_key_to_innobase(), assert
          that the converted key is empty or nonempty when it should be.
------------------------------------------------------------
revno: 3565 [merge]
committer: Marko M?kel? <marko.makela@oracle.com>
branch nick: mysql-trunk
timestamp: Mon 2011-11-07 10:00:13 +0200
message:
  Merge mysql-5.5 to mysql-trunk.
    ------------------------------------------------------------
    revno: 2875.321.11
    committer: Marko M?kel? <marko.makela@oracle.com>
    branch nick: mysql-5.5
    timestamp: Mon 2011-11-07 09:28:02 +0200
    message:
      Bug#13340047 LATCHING ORDER VIOLATION IN IBUF_SET_ENTRY_COUNTER()
      
      ibuf_insert_low(), the only caller of ibuf_set_entry_counter(), will
      have latched an insert buffer bitmap page in bitmap_mtr before
      invoking ibuf_set_entry_counter(). The latching order forbids any
      further pages to be latched.
      
      ibuf_set_entry_counter(): Renamed to ibuf_get_entry_counter(),
      simplified the code and added comments.
      
      Added the following symbols for predefined field numbers in change
      buffer records:
      
      #define IBUF_REC_FIELD_SPACE	0	/*!< in the pre-4.1 format,
      					the page number. later, the space_id */
      #define IBUF_REC_FIELD_MARKER	1	/*!< starting with 4.1, a marker
      					consisting of 1 byte that is 0 */
      #define IBUF_REC_FIELD_PAGE	2	/*!< starting with 4.1, the
      					page number */
      #define IBUF_REC_FIELD_METADATA	3	/* the metadata field */
      #define IBUF_REC_FIELD_USER	4	/* first user field */
      
      rb:802 approved by Sunny Bains
------------------------------------------------------------
revno: 3564
committer: Jorgen Loland <jorgen.loland@oracle.com>
branch nick: mysql-trunk-12997905
timestamp: Fri 2011-11-04 16:22:50 +0100
message:
  BUG#12997905 Followup patch
  
  Hopefully PB stops barking about two VALGRIND errors after push
  of this bug.
------------------------------------------------------------
revno: 3563
committer: Jorgen Loland <jorgen.loland@oracle.com>
branch nick: mysql-trunk-12997905
timestamp: Fri 2011-11-04 16:20:13 +0100
message:
  Bug#12997905: VALGRIND: SYSCALL PARAM PWRITE64(BUF) 
                POINTS TO UNINITIALISED BYTE(S)
  
  When a record is inserted into a MyISAM temporary table using 
  static write, the entire content of the record[0] buffer is 
  written to the table which resides on disk. If one or more of
  the columns is a varchar, the trailing space may be 
  uninitialized and even contain secrets. Valgrind barked because
  of this.
  
  The fix is to reset the record buffer for MyISAM temporary 
  tables in addition to restricting the copying of fields from
  one table to another to the bytes actually used by the varchar.
  
  Bonus: Restricting Copy_field to copy only used varchar bytes 
  instead of the full column length also has a performance 
  benefit.
------------------------------------------------------------
revno: 3562
committer: Jon Olav Hauglid <jon.hauglid@oracle.com>
branch nick: mysql-trunk
timestamp: Fri 2011-11-04 15:15:17 +0100
message:
  Fix trunk tree_name.
------------------------------------------------------------
revno: 3561 [merge]
committer: Tor Didriksen <tor.didriksen@oracle.com>
branch nick: trunk
timestamp: Fri 2011-11-04 14:11:50 +0100
message:
  local merge
    ------------------------------------------------------------
    revno: 3558.1.2 [merge]
    committer: chuck.bell@oracle.com
    branch nick: mysql-trunk
    timestamp: Fri 2011-11-04 09:04:48 -0400
    message:
      Merge with mysql-5.5 tree after push for WL#5710 PB fix.
        ------------------------------------------------------------
        revno: 2875.321.10
        committer: chuck.bell@oracle.com
        branch nick: mysql-5.5-wl-5710
        timestamp: Fri 2011-11-04 08:59:28 -0400
        message:
          WL#5710 : mysql_plugin client - Windows PB fix
          
          This patch corrects the test mysql_plugin so that it correctly masks
          the library extension of the plugin daemon_example.
------------------------------------------------------------
revno: 3560 [merge]
committer: Tor Didriksen <tor.didriksen@oracle.com>
branch nick: trunk
timestamp: Fri 2011-11-04 14:02:39 +0100
message:
  local merge
    ------------------------------------------------------------
    revno: 3558.1.1 [merge]
    committer: Bjorn Munch <bjorn.munch@oracle.com>
    branch nick: once-tr
    timestamp: Fri 2011-11-04 13:51:52 +0100
    message:
      merge trunk-mtr => trunk: simplify some tests with ONCE modifier to --disable_xxx
        ------------------------------------------------------------
        revno: 3076.1.56 [merge]
        committer: Bjorn Munch <bjorn.munch@oracle.com>
        branch nick: mtr-tr
        timestamp: Thu 2011-11-03 12:32:07 +0100
        message:
          null upmerge
            ------------------------------------------------------------
            revno: 2875.125.186 [merge]
            committer: Bjorn Munch <bjorn.munch@oracle.com>
            branch nick: mtr-55
            timestamp: Thu 2011-11-03 10:52:32 +0100
            message:
              null upmerge
                ------------------------------------------------------------
                revno: 2661.412.178 [merge]
                committer: Bjorn Munch <bjorn.munch@oracle.com>
                branch nick: merge-51
                timestamp: Wed 2011-11-02 13:39:28 +0100
                message:
                  merge 5.1 => 5.1-mtr
            ------------------------------------------------------------
            revno: 2875.125.185 [merge]
            committer: Bjorn Munch <bjorn.munch@oracle.com>
            branch nick: mtr-55
            timestamp: Thu 2011-11-03 10:50:56 +0100
            message:
              merge 5.5 => 5.5-mtr, redo
        ------------------------------------------------------------
        revno: 3076.1.55 [merge]
        committer: Bjorn Munch <bjorn.munch@oracle.com>
        branch nick: mtr-tr
        timestamp: Thu 2011-11-03 12:14:39 +0100
        message:
          merge trunk => trunk-mtr
        ------------------------------------------------------------
        revno: 3076.1.54 [merge]
        committer: Bjorn Munch <bjorn.munch@oracle.com>
        branch nick: mtr-tr
        timestamp: Thu 2011-10-20 13:56:38 +0200
        message:
          null upmerge
            ------------------------------------------------------------
            revno: 2875.125.184 [merge]
            committer: Bjorn Munch <bjorn.munch@oracle.com>
            branch nick: mtr-55
            timestamp: Thu 2011-10-20 13:21:12 +0200
            message:
              merge 5.5 -> 5.5-mtr
        ------------------------------------------------------------
        revno: 3076.1.53 [merge]
        committer: Bjorn Munch <bjorn.munch@oracle.com>
        branch nick: mtr-tr
        timestamp: Thu 2011-10-20 13:25:01 +0200
        message:
          merge trunk -> trunk-mtr
        ------------------------------------------------------------
        revno: 3076.1.52
        committer: Bjorn Munch <bjorn.munch@oracle.com>
        branch nick: once-tr
        timestamp: Wed 2011-10-19 12:15:25 +0200
        message:
          Followup to 12956584
          Use ONCE modifier to --disable_XXX in some selected tests, simplifying
        ------------------------------------------------------------
        revno: 3076.1.51 [merge]
        committer: Bjorn Munch <bjorn.munch@oracle.com>
        branch nick: mtr-tr
        timestamp: Wed 2011-10-12 17:56:38 +0200
        message:
          null upmerge
            ------------------------------------------------------------
            revno: 2875.125.183 [merge]
            committer: Bjorn Munch <bjorn.munch@oracle.com>
            branch nick: mtr-55
            timestamp: Wed 2011-10-12 17:30:51 +0200
            message:
              null upmerge
                ------------------------------------------------------------
                revno: 2661.412.177 [merge]
                committer: Bjorn Munch <bjorn.munch@oracle.com>
                branch nick: merge-51
                timestamp: Wed 2011-10-12 17:26:32 +0200
                message:
                  merge 5.1 => 5.1-mtr
            ------------------------------------------------------------
            revno: 2875.125.182 [merge]
            committer: Bjorn Munch <bjorn.munch@oracle.com>
            branch nick: mtr-55
            timestamp: Wed 2011-10-12 17:29:19 +0200
            message:
              merge 5.5 => 5.5-mtr
        ------------------------------------------------------------
        revno: 3076.1.50 [merge]
        committer: Bjorn Munch <bjorn.munch@oracle.com>
        branch nick: mtr-tr
        timestamp: Wed 2011-10-12 17:55:11 +0200
        message:
          merge trunk => trunk-mtr
        ------------------------------------------------------------
        revno: 3076.1.49 [merge]
        committer: Bjorn Munch <bjorn.munch@oracle.com>
        branch nick: mtr-tr
        timestamp: Thu 2011-10-06 13:02:25 +0200
        message:
          merge trunk => trunk-mtr
------------------------------------------------------------
revno: 3559 [merge]
committer: Tor Didriksen <tor.didriksen@oracle.com>
branch nick: trunk
timestamp: Fri 2011-11-04 13:59:47 +0100
message:
  Merge: WL#5825 Using C++ Standard Library with MySQL code
    ------------------------------------------------------------
    revno: 3437.1.13 [merge]
    committer: Tor Didriksen <tor.didriksen@oracle.com>
    branch nick: trunk-merge-stl
    timestamp: Thu 2011-11-03 17:03:34 +0100
    message:
      merge trunk => wl5825
    ------------------------------------------------------------
    revno: 3437.1.12
    committer: Tor Didriksen <tor.didriksen@oracle.com>
    branch nick: trunk-merge-stl
    timestamp: Thu 2011-11-03 15:37:51 +0100
    message:
      WL#5825 Using C++ Standard Library with MySQL code
      
      libstlport.so isn't installed by default on solaris,
      so we pack, and re-distribute it.
    ------------------------------------------------------------
    revno: 3437.1.11
    committer: Tor Didriksen <tor.didriksen@oracle.com>
    branch nick: trunk-merge-stl
    timestamp: Tue 2011-11-01 07:44:28 +0100
    message:
      fix test failure on windows
    ------------------------------------------------------------
    revno: 3437.1.10
    committer: Tor Didriksen <tor.didriksen@oracle.com>
    branch nick: trunk-merge-stl
    timestamp: Mon 2011-10-31 18:50:31 +0100
    message:
      Fix test failure on windows
    ------------------------------------------------------------
    revno: 3437.1.9 [merge]
    committer: Tor Didriksen <tor.didriksen@oracle.com>
    branch nick: trunk-merge-stl
    timestamp: Fri 2011-10-28 14:45:35 +0200
    message:
      merge trunk => wl5825
    ------------------------------------------------------------
    revno: 3437.1.8
    committer: Tor Didriksen <tor.didriksen@oracle.com>
    branch nick: trunk-merge-stl
    timestamp: Mon 2011-10-17 14:50:40 +0200
    message:
      WL#5825 Using C++ Standard Library with MySQL code
      
      Figure out how to use std::hash_map<> and variants.
    ------------------------------------------------------------
    revno: 3437.1.7
    committer: Tor Didriksen <tor.didriksen@oracle.com>
    branch nick: trunk-merge-stl
    timestamp: Mon 2011-10-17 12:30:47 +0200
    message:
      Remove -icc- build files
    ------------------------------------------------------------
    revno: 3437.1.6
    committer: Tor Didriksen <tor.didriksen@oracle.com>
    branch nick: trunk-merge-stl
    timestamp: Mon 2011-10-17 12:28:01 +0200
    message:
      WL#5825 Using C++ Standard Library with MySQL code 
      
      Handle review comments.
    ------------------------------------------------------------
    revno: 3437.1.5 [merge]
    committer: Tor Didriksen <tor.didriksen@oracle.com>
    branch nick: trunk-merge-stl
    timestamp: Thu 2011-10-13 09:26:28 +0200
    message:
      merge trunk => wl5825
    ------------------------------------------------------------
    revno: 3437.1.4
    committer: Tor Didriksen <tor.didriksen@oracle.com>
    branch nick: trunk-merge-stl
    timestamp: Tue 2011-10-11 16:52:17 +0200
    message:
      Release build fails on APPLE: duplicate symbol _ut_crc32
      
      Remove -fno-common from APPLE gcc flags.
      It prohibits common symbols in *all* libraries/executables.
      I guess it is a leftover from the autoconf scripts, which
      specify -fno-common to enforce behaviour needed for creating .dylib files.
      
      Remove -felide-constructors (which is default anyways)
    ------------------------------------------------------------
    revno: 3437.1.3
    committer: Tor Didriksen <tor.didriksen@oracle.com>
    branch nick: trunk-merge-stl
    timestamp: Tue 2011-10-11 10:21:17 +0200
    message:
      Remove -static-libgcc
      build failed with /usr/local/gcc-4.3.4
      (http://gcc.gnu.org/bugzilla/show_bug.cgi?id=27880)
      but we probably want -dynamic-libgcc anyways ...
      
      Add explicit -fabi-version=2
    ------------------------------------------------------------
    revno: 3437.1.2
    committer: Tor Didriksen <tor.didriksen@oracle.com>
    branch nick: trunk-merge-stl
    timestamp: Tue 2011-10-11 06:27:52 +0200
    message:
      WL#5825 Using C++ Standard Library with MySQL code
      
      The goal of this worklog is to allow the use of the C++ Standard Library
      inside the code and to enable exceptions and RTTI for the MyQL code
      base. The goal is *not* to start using the the standard C++ library
      throughout the code base, just to ensure that it is possible.
    ------------------------------------------------------------
    revno: 3437.1.1 [merge]
    committer: Tor Didriksen <tor.didriksen@oracle.com>
    branch nick: trunk-merge-stl
    timestamp: Mon 2011-09-26 14:42:12 +0200
    message:
      Merge bundle from Mats
        ------------------------------------------------------------
        revno: 3402.12.1 [merge]
        committer: Tor Didriksen <tor.didriksen@oracle.com>
        branch nick: trunk-stl
        timestamp: Mon 2011-08-29 14:08:58 +0200
        message:
          Merge bundle from Mats
            ------------------------------------------------------------
            revno: 3139.1.1 [merge]
            committer: Mats Kindahl <mats.kindahl@oracle.com>
            branch nick: w5223-trunk
            timestamp: Wed 2011-06-01 16:16:01 +0200
            message:
              WL#5825: Using C++ Standard Library with MySQL code
              
              This patch will make it possible to use the C++
              Standard Library by removing the min/max macros
              from the code.
              
              The patch makes the following changes:
              
              - Define macros MY_MIN and MY_MAX instead of min and max.
              - Use MY_MIN/MY_MAX in C code
              - Use MY_MIN/MY_MAX in array declarations
              - Include <algorithm> to get min/max from std
              - Add using-declarations in source files
              - Use std:: prefix for min/max in header files
              - Turning some constant declarations unsigned
              - Removing an overloaded use of 'min' as both
                macro name and variable.
              - It enables C++ builds for all files
                ------------------------------------------------------------
                revno: 2876.464.1
                committer: Mats Kindahl <mats.kindahl@oracle.com>
                branch nick: w5223-trunk
                timestamp: Wed 2011-06-01 15:47:36 +0200
                message:
                  WL#5825: Using C++ Standard Library with MySQL code
                  
                  This patch will make it possible to use the C++
                  Standard Library by removing the min/max macros
                  from the code.
                  
                  The patch makes the following changes:
                  
                  - Define macros MY_MIN and MY_MAX instead of min and max.
                  - Use MY_MIN/MY_MAX in C code
                  - Use MY_MIN/MY_MAX in array declarations
                  - Include <algorithm> to get min/max from std
                  - Add using-declarations in source files
                  - Use std:: prefix for min/max in header files
                  - Turning some constant declarations unsigned
                  - Removing an overloaded use of 'min' as both
                    macro name and variable.
                  - It enables C++ builds for all files
------------------------------------------------------------
revno: 3558
committer: Mayank Prasad <mayank.prasad@oracle.com>
branch nick: emb_defect
timestamp: Fri 2011-11-04 14:48:36 +0530
message:
  Bug#12561297 : Enabled mysql_embedded.test test case
  
  Detail:
  - Added code to look for mysql_embedded executable in 
    bin directory.
------------------------------------------------------------
revno: 3557
committer: Sunny Bains <Sunny.Bains@Oracle.Com>
branch nick: trunk
timestamp: Fri 2011-11-04 17:05:42 +1100
message:
  Bug 12980094 - ASSERTION IN INNODB DETECTED IN RQG_PARTITION_DDL
  
  This bug is a debug code bug, it is only possible on platforms that don't
  support atomics.
  
  Release the rw_lock before freeing the underlying mutex. This fixes a race
  condition in rw_lock_list_print_info(), where the underlying mutex was freed
  but the rw_lock was still in the rw_lock_list.
  
  Approved by Jimmy Yang over IM.
------------------------------------------------------------
revno: 3556
committer: Hery Ramilison <hery.ramilison@oracle.com>
branch nick: mysql-trunk
timestamp: Thu 2011-11-03 20:40:03 +0100
message:
  Fixing milestone number according to #42576
------------------------------------------------------------
revno: 3555
committer: Andrei Elkin <andrei.elkin@oracle.com>
branch nick: trunk-bug13033076-mts-rpl_parallel_ddl-win
timestamp: Thu 2011-11-03 20:33:01 +0200
message:
  Bug#13334470 - SLAVE_START_WORKERS() USES BOGUS VALUE INSTEAD OF --SLAVE_PARALLEL_WORKERS OPT
  
  The value of number of workers appeared to be not set when MTS starts automatically at server
  bootstrap.
  
  Fixed with caching of the global opt_mts_slave_parallel_workers into
  rli->opt_slave_parallel_workers similarly to the manual start slave branch.
------------------------------------------------------------
revno: 3554
committer: Tor Didriksen <tor.didriksen@oracle.com>
branch nick: trunk
timestamp: Thu 2011-11-03 17:10:53 +0100
message:
  Bug#12711108 61708: INCORRECT HANDLING OF C-COMPILER THAT DOES NOT SUPPORT INLINE KEYWORD
  
  All currently supported C compilers have 'inline'.
  If the cmake test for inline fails, then there's something else going wrong,
  and doing
  #define inline
  is not the right solution: 
  changing the meaning of reserved words is undefined behaviour.
------------------------------------------------------------
revno: 3553 [merge]
committer: Jimmy Yang <jimmy.yang@oracle.com>
branch nick: trunk3
timestamp: Thu 2011-11-03 04:10:52 -0700
message:
  Merge from mysql-5.5 to mysql-trunk
    ------------------------------------------------------------
    revno: 2875.321.9
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-5.5
    timestamp: Thu 2011-11-03 04:07:00 -0700
    message:
      Fix Bug #12941439 - WITH UNIV_SYNC_DEBUG, PERF SCHEMA, INITIALIZATION
      OF 16G BUFFER POOL TAKES HOURS
      
      rb://787 approved by Sunny
------------------------------------------------------------
revno: 3552
committer: Norvald H. Ryeng <norvald.ryeng@oracle.com>
branch nick: mysql-trunk-11764313
timestamp: Thu 2011-11-03 11:15:06 +0100
message:
  Bug#11764313 57135: CRASH IN ITEM_FUNC_CASE::FIND_ITEM WITH CASE WHEN
  ELSE CLAUSE
  
  Problem: During optimization, ZEROFILL values, which includes YEAR
  values, may be converted to string constants. However, the CASE
  function does not handle switching datatypes after planning, leading
  to CASE finding a null pointer instead of its argument.
  
  Item_func_case creates a table of cmp_items, one for each datatype
  used in the comparison. This table is created during query planning by
  fix_length_and_dec(). During optimization,
  Item_field::equal_fields_propagator() converts ZEROFILL numbers to
  strings, but the comparison table in Item_func_case is not
  updated. Later in optimization, the condition is evaluated as part of
  removing trivial comparisons from the query. During evaluation, the
  position in the comparison table is found by examining the result
  types of the fields to be compared. Since the result type of the
  fields have changed, the wrong position in the comparison table is
  inferred, and this position contains a null pointer.
  
  This bug is similar to bug#11764818, which affects the IN
  function. Item_func_in and Item_func_case are the only functions using
  the cmp_items construct.
  
  Fix: Set the cmp_context of WHEN arguments to Item_func_case so that
  Item_field::equal_fields_propagator() will not convert them to
  strings.
------------------------------------------------------------
revno: 3551
committer: Anitha Gopi <anitha.gopi@oracle.com>
branch nick: mysql-trunk
timestamp: Thu 2011-11-03 13:50:46 +0530
message:
  Bug#11755645: LOCK_MULTI_BUG38499 does not fail anymore. Remove the test from experimental group
------------------------------------------------------------
revno: 3550
committer: Anitha Gopi <anitha.gopi@oracle.com>
branch nick: mysql-trunk
timestamp: Thu 2011-11-03 13:35:39 +0530
message:
  Bug#11750645: Remove test from experimental group. Problem was only on Open Solaris and that platform is not supported anymore
------------------------------------------------------------
revno: 3549 [merge]
committer: Sneha Modi<sneha.modi@oracle.com>
branch nick: mysql-trunk
timestamp: Thu 2011-11-03 12:31:49 +0530
message:
  Merging from mysql-5.5 -> mysql-trunk
    ------------------------------------------------------------
    revno: 2875.321.8
    committer: Sneha Modi<sneha.modi@oracle.com>
    branch nick: mysql-5.5
    timestamp: Thu 2011-11-03 12:30:09 +0530
    message:
      BUG#11754168: Reverting back changes as it is making other tests fail.
------------------------------------------------------------
revno: 3548
committer: Marc Alff <marc.alff@oracle.com>
branch nick: mysql-trunk-cleanup
timestamp: Wed 2011-11-02 17:29:01 -0600
message:
  Fixed build break, when compiling without the performance schema.
------------------------------------------------------------
revno: 3547
committer: Marc Alff <marc.alff@oracle.com>
branch nick: mysql-trunk-cleanup
timestamp: Wed 2011-11-02 12:11:26 -0600
message:
  Bug#12981100 PERFORMANCE_SCHEMA NET IO IDLE AND RECV EVENTS NEST WITHIN THE WRONG STATEMENT
  
  Post push cleanup, to fix a remaining assert.
  
  Instrument incomplete statements as "statement/com/error",
  when a full network packet can not be read.
------------------------------------------------------------
revno: 3546
committer: Marc Alff <marc.alff@oracle.com>
branch nick: mysql-trunk-cleanup
timestamp: Wed 2011-11-02 10:07:18 -0600
message:
  bug#12981100, post fix cleanup
------------------------------------------------------------
revno: 3545 [merge]
committer: Sneha MOdi<sneha.modi@oracle.com>
branch nick: mysql-trunk
timestamp: Wed 2011-11-02 18:58:15 +0530
message:
  Merging from mysql-5.5 -> mysql-trunk
    ------------------------------------------------------------
    revno: 2875.321.7
    committer: Sneha MOdi<sneha.modi@oracle.com>
    branch nick: mysql-5.5
    timestamp: Wed 2011-11-02 18:42:52 +0530
    message:
      BUG#11754170: TEST CASE FOR BUG#28211 IS DISABLED IN QUERY_CACHE.TEST as RENAME DATABASE
      and query_cache don't play along nicely.
      
      An alternative for RENAME DATABSE using RENAME TABLE has been used to implement this.
------------------------------------------------------------
revno: 3544
committer: Marc Alff <marc.alff@oracle.com>
branch nick: mysql-trunk-bug12981100
timestamp: Wed 2011-11-02 05:55:03 -0600
message:
  Fixed code review comments.
  
  Table io and table lock events should set the nesting event type and nesting event id
------------------------------------------------------------
revno: 3543 [merge]
committer: Marc Alff <marc.alff@oracle.com>
branch nick: mysql-trunk-bug12981100
timestamp: Wed 2011-11-02 05:38:35 -0600
message:
  Local merge from mysql-trunk
    ------------------------------------------------------------
    revno: 3540.1.5 [merge]
    committer: Sneha MOdi<sneha.modi@oracle.com>
    branch nick: mysql-trunk
    timestamp: Wed 2011-11-02 16:57:07 +0530
    message:
      Merging from mysql-5.5 -> mysql-trunk
        ------------------------------------------------------------
        revno: 2875.321.6
        committer: Sneha MOdi<sneha.modi@oracle.com>
        branch nick: mysql-5.5
        timestamp: Wed 2011-11-02 16:53:41 +0530
        message:
          BUG#11754168:PARTS OF INDEX_MERGE_INNODB.TEST ARE DISABLED DUE TO EXPLAIN DIFFS
          
          Parts of index_merge_innodb were disabled.These have been enabled with a few changes 
          and the test is being made experimental to study it's behaviour.
------------------------------------------------------------
revno: 3542 [merge]
committer: Marc Alff <marc.alff@oracle.com>
branch nick: mysql-trunk-bug12981100
timestamp: Wed 2011-11-02 05:37:46 -0600
message:
  Local merge from mysql-trunk
    ------------------------------------------------------------
    revno: 3540.1.4
    committer: Norvald H. Ryeng <norvald.ryeng@oracle.com>
    branch nick: mysql-trunk-13098726
    timestamp: Tue 2011-11-01 14:54:56 +0100
    message:
      Bug #13098726 MY_TIME.C:786: CALC_DAYNR: ASSERTION `DELSUM+(INT)
      Y/4-TEMP > 0' FAILED
      
      Problem: The date 0000-01-00 triggers an assertion guarding against
      invalid results in calc_daynr().
      
      An initial check in calc_daynr() returns day number 0 for all dates in
      month 0, year 0. The assertion at the end of the function states that
      other return values should be greater than 0. However, because of the
      way day numbers are calculated, the fictitious date 0000-01-00 is also
      represented as day number 0, and this wrongly triggers the assertion.
      
      In most cases, the NO_ZERO_IN_DATE SQL mode causes the problematic
      date to be handled outside calc_daynr(), but not all time functions
      check for such fictitious dates.
      
      Fix: Change assertion so that it states that return values should be
      greater than or equal to zero.
    ------------------------------------------------------------
    revno: 3540.1.3
    committer: Tor Didriksen <tor.didriksen@oracle.com>
    branch nick: trunk
    timestamp: Tue 2011-11-01 12:48:27 +0100
    message:
      Bug#13063317 62623: 5.5 "MAKE TEST" ONLY RUNS CTEST UNIT TESTS NOT FULL SUITE LIKE IT DID IN
      
      Remove of misc (unused) mtr tests targets.
      Write a new one: test-mtr
    ------------------------------------------------------------
    revno: 3540.1.2
    committer: Jon Olav Hauglid <jon.hauglid@oracle.com>
    branch nick: mysql-trunk-bug13326965
    timestamp: Tue 2011-11-01 09:47:32 +0100
    message:
      Bug#13326965 THD->CURRENT_UTIME() CALLED WHEN NOT NEEDED IN
                   LOG_SLOW_STATEMENT()
      
      The problem was that thd->current_utime() was called before
      writing to the slow log even if no log entries ended up being
      written. This is unneccessary and potentially a performance
      problem (thd->current_utime() -> my_micro_time() -> 
      __gettimeofday()).
      
      This patch fixes the problem by not calling thd->current_utime()
      before it is known that a log entry will in fact be written.
      
      The patch doesn't contain a test case since it is hard to test
      for performance improvements in our test framework.
    ------------------------------------------------------------
    revno: 3540.1.1 [merge]
    committer: Tor Didriksen <tor.didriksen@oracle.com>
    branch nick: trunk-merge
    timestamp: Tue 2011-11-01 07:53:43 +0100
    message:
      empty merge 5.5 => trunk
        ------------------------------------------------------------
        revno: 2875.321.5 [merge]
        committer: Tor Didriksen <tor.didriksen@oracle.com>
        branch nick: 5.5
        timestamp: Tue 2011-11-01 07:52:04 +0100
        message:
          NULL merge 5.1 => 5.5
            ------------------------------------------------------------
            revno: 2661.809.51
            committer: Tor Didriksen <tor.didriksen@oracle.com>
            branch nick: 5.1
            timestamp: Tue 2011-11-01 07:50:54 +0100
            message:
              Bug#12406055 post-push fix: unused variable 'num_chars' in optimized build.
              Also fixed possibly uninitialized use of need_copy_table_res.
------------------------------------------------------------
revno: 3541
committer: Marc Alff <marc.alff@oracle.com>
branch nick: mysql-trunk-bug12981100
timestamp: Tue 2011-11-01 10:33:58 -0600
message:
  Bug#12981100 PERFORMANCE_SCHEMA NET IO IDLE AND RECV EVENTS NEST WITHIN THE WRONG STATEMENT
  
  This bug is caused by the lack of integration between:
  - the IDLE instrumentation
  - the SOCKET instrumentation
  - the STATEMENT instrumentation
  - the STAGE instrumentation
  in the server.
  
  While each instrumentation taken individually works,
  the overall result is events that do not properly relate to each others.
  
  The fix consist of several parts.
  
  1) Define a network call back interface for the NET structure,
     so that the network layer can notify events when a packet header is seen.
  
  This part is critical to isolate all the SQL layer performance schema related
  instrumentation from the NET code.
  
  2) Use this call back interface internally in mysqld,
  to call the IDLE / SOCKET / STATEMENT / STAGE instrumentation
  in a coherent way, respecting the logical order or events.
  
  3) IDLE instrumentation:
  - IDLE events are generated with a NULL NESTING_EVENT_ID parent
  - HAVE_PSI_IDLE_INTERFACE was missing and has been added,
  to facilitate building without the IDLE instrumentation.
  
  4) STATEMENT instrumentation:
  Statements are now created (MYSQL_START_STATEMENT) much sooner,
  when a new packet header is seen.
  As a result, a new statement instrument "statement/com/",
  has been defined to represent a statement just started.
  
  Also, in release builds only, a spurious "statement/sql/"
  statement existed, due to a bug related to SHOW PROCEDURE CODE
  and SHOW FUNCTION CODE, for which no statement name was defined in release builds.
  This has been fixed.
  
  4) SOCKET instrumentation:
  no changes in the code itself.
  SOCKET events are now properly recorded as childrens of a statement,
  due to the reordering of MYSQL_START_STATEMENT.
  
  5) STAGES instrumentation
  no changes in the code itself.
  The first stage ("stage/sql/init") is now started right after a statement starts.
  
  6) Existing test cases
  
  tests events_aggregates* were missing instrumentation for "statement/com/Query",
  so that SQL statements that were intended to be recorded were not.
  This has been fixed in the tests.
  
  Tests outputs have been adjusted, as there is a new statement class.
  
  A new test, nesting.test, shows precise events dependencies between all events.
------------------------------------------------------------
revno: 3540
committer: Andrei Elkin <andrei.elkin@oracle.com>
branch nick: mysql-trunk
timestamp: Mon 2011-10-31 15:52:32 +0200
message:
  windows sometimes times out on rpl_parallel,sequential.
  The tests load is made smaller on win platform.
------------------------------------------------------------
revno: 3539
committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
branch nick: mysql-trunk-bug61392
timestamp: Mon 2011-10-31 15:52:20 +0400
message:
  Fix for Bug#12652873 - 61392: CONTINUE HANDLER FOR NOT FOUND BEING
  TRIGGERED FROM INTERNAL STORED FUNCTION.
  
  The problem was that RETURN statement in stored programs did not
  clear the Diagnostics Area, as it should have done according to
  the SQL Standard.
  
  The user-visible problem was that in some cases an SQL-condition,
  raised in the nested function call, would be visible in the outer
  scope, which in turn would lead to incorrect handler activation.
  
  The fix is to clear the Diagnostics Area before executing RETURN
  statement.
  
  Note, that after the patch, there is no way to throw an SQL-warning
  out of a stored function. From the user's view point, he/she will not
  get any warning, even if there were warnings, raised during
  the function execution.
  
  This change is backward incompatible, but it makes the behaviour of
  stored programs more in line with The Standard.
------------------------------------------------------------
revno: 3538 [merge]
committer: Tor Didriksen <tor.didriksen@oracle.com>
branch nick: trunk
timestamp: Mon 2011-10-31 10:13:54 +0100
message:
  empty merge 5.5 => trunk
    ------------------------------------------------------------
    revno: 2875.321.4 [merge]
    committer: Tor Didriksen <tor.didriksen@oracle.com>
    branch nick: 5.5
    timestamp: Mon 2011-10-31 10:12:20 +0100
    message:
      null merge 5.1 => 5.5
        ------------------------------------------------------------
        revno: 2661.809.50
        committer: Tor Didriksen <tor.didriksen@oracle.com>
        branch nick: 5.1
        timestamp: Mon 2011-10-31 10:10:04 +0100
        message:
          Bug#12406055 post-push fix: unused variable 'num_chars' in optimized build.
------------------------------------------------------------
revno: 3537 [merge]
committer: Jorgen Loland <jorgen.loland@oracle.com>
branch nick: mysql-trunk
timestamp: Mon 2011-10-31 09:11:22 +0100
message:
  Automerge opt-team -> trunk
    ------------------------------------------------------------
    revno: 2876.249.426
    committer: Jorgen Loland <jorgen.loland@oracle.com>
    branch nick: mysql-next-mr-opt-team
    timestamp: Thu 2011-10-27 13:53:33 +0200
    message:
      Record derived.result after merge opt-backporting -> opt-team
    ------------------------------------------------------------
    revno: 2876.249.425 [merge]
    committer: Jorgen Loland <jorgen.loland@oracle.com>
    branch nick: mysql-next-mr-opt-team
    timestamp: Thu 2011-10-27 13:52:50 +0200
    message:
      Automerge opt-backporting -> opt-team
        ------------------------------------------------------------
        revno: 2876.339.185
        committer: Roy Lyseng <roy.lyseng@oracle.com>
        branch nick: mysql-review
        timestamp: Thu 2011-10-27 13:39:49 +0200
        message:
          Bug#13106350: MRR initialization on a derived table caused crash
          
          Followup patch to make test behave in trunk.
          
          mysql-test/r/derived.result
            Updated result file for bug#13106350.
          
          mysql-test/t/derived.test
            Deleted setting of semi-join related optimizer switches.
            Added explain to notify of plan changes.
    ------------------------------------------------------------
    revno: 2876.249.424 [merge]
    committer: Jorgen Loland <jorgen.loland@oracle.com>
    branch nick: mysql-next-mr-opt-team
    timestamp: Thu 2011-10-27 13:51:33 +0200
    message:
      Automerge opt-backporting -> opt-team
        ------------------------------------------------------------
        revno: 2876.339.184
        committer: Roy Lyseng <roy.lyseng@oracle.com>
        branch nick: mysql-sb1
        timestamp: Wed 2011-10-26 15:23:01 +0200
        message:
          Bug#113106350: crash in memcpy from join_cache::write_record_data
          
          This problem may happen if we combine the Duplicate Weedout semi-join
          strategy with join buffering, and the outer table is a derived table.
          
          The problem is that Duplicate Weedout needs the row id of all involved
          tables, hence the table is instructed to save the row id.
          Join buffering needs to save and restore the rowid into a buffer,
          for that purpose an st_cache_field object is allocated. This object
          contains a pointer to the row id buffer, but at the time of object
          creation, the table (being a derived table) has not yet been opened
          and the buffer pointer is NULL.
          
          The fix is to save a reference to the st_cache_field object in the
          corresponding JOIN_TAB and bind it with the buffer after the derived
          table has been materialized.
          
          mysql-test/t/derived.test
            Added test case for bug#113106350.
          
          mysql-test/r/derived.result
            Added test case results for bug#113106350.
          
          sql/sql_join_cache.cc
            Save reference to rowid copy object when setting up fields to copy.
          
          sql/sql_select.cc
            Bind the rowid buffer of a TABLE object to a copy object that is
            used to copy a rowid. Needed when temporary tables are opened
            as part of execution.
            
          sql/sql_select.h
            Added reference to copy object used to copy rowid in JOIN_TAB.
            Added a bind_buffer() access function for st_cache_field.
        ------------------------------------------------------------
        revno: 2876.339.183
        committer: Roy Lyseng <roy.lyseng@oracle.com>
        branch nick: mysql-sb4
        timestamp: Tue 2011-10-25 12:28:05 +0200
        message:
          Bug#12407753: Time to compare a row is missing in cost calculation of semi-join
          
          Stage 2: Refactor optimize_wo_join_buffering, best_access_path and others.  
          
          Refactored how costs are re-calculated for the semi-join strategies,
          now the intermediate and final calculations are done the same way.
          Added new calculation functions to class Optimize_table_order.
          In addition, a few minor inconsistencies around semi-join optimization
          have been fixed.
          
          The following changes were developed by Guilhem Bichot and incorporated
          in this refactoring patch:
          
          Moving cur_sj_inner_tables and emb_sjm_nest to Optimize_table_order,
          where they naturally belong (emb_sjm_nest added by me).
          
          After choosing the final plan, cur_sj_inner_tables should be 0,
          as our plan normally covers all sj-inner tables. So we add an assert.
          However there was a bug: backout_nj_sj_state() actually never restored
          cur_sj_inner_tables, because it was assuming (wrongly) that
          remaining_tables didn't contain the table-to-remove, whereas it always does.
          
          mysql-test/r/opt_trace.bugs_ps_prot_all.result
          mysql-test/r/opt_trace.general_ps_prot_all.result
          mysql-test/r/opt_trace.bugs_no_prot_all.result
            Some changes necessitated by refactoring.
            Aligned some text with other terminology.
          
          mysql-test/r/opt_trace.general_no_prot_all.result
            For query 'select * from t3 where (a,a,b) in (select * from t1,t2,t4)',
            (where t3 has one row and is thus a "system" table), plan
            (t4,t1,t2)+firstmatch was not considered, which was wrong.
            Here's how it happened.
             - plan (t2) is tested: cur_sj_inner_tables is set to t1+t2+t4,
               then plan is pruned; cur_sj_inner_tables remains non-zero
               because of the bug in backout_nj_sj_state()
             - plan (t1) is tested: this if() below is not entered because
               cur_sj_inner_tables is non-zero:
               if (cur_sj_inner_tables == 0 &&                    // (2)
                   !(remaining_tables & outer_corr_tables) &&     // (3)
                   (sj_inner_tables ==                            // (4)
                   ((remaining_tables | new_join_tab->table->map) & sj_inner_tables)))
               {
                 /* Start tracking potential FirstMatch range */
               And thus firstmatch won't be tested.
          
          sql/sql_const.h
            Added cost factors for creation of temporary tables.
            Currently, the old values are still used.
            Removed unused constant RAID_BLOCK_SIZE.
          
          sql/sql_select.cc
            optimize_semijoin_nests(): Restructured assignments to cost data.
            Added cost for creation of temporary table (currently zero).
          
            best_access_path() is now a member function of Optimize_table_order.
            Argument join is eliminated as it is passed through object.
            The "excluded_tables" variable that was sometimes OR'ed to
            remaining_tables is now a member variable in Optimize_table_order
            and need not be passed by callers to best_access_path().
          
            choose_table_order(): Exclude unnecessary book-keeping when processing
            semi-join materialization nests. Call fix_semijoin_strategies()
            when needed (makes it possible to make fix_semijoin_strategies()
            a member function of Optimize_table_order).
          
            fix_semijoin_strategies() is now a member function of
            Optimize_table_order.
            Renamed from fix_semijoin_strategies_for_picked_join_order()
            because the full function name became extremely long.
            Rewritten to use the new access path calculation functions.
          
            semijoin_fm_ls_access_paths() is renamed from optimize_wo_join_buffering.
            It will now correctly calculate new access path information for
            FirstMatch and LooseScan semi-join strategies. and it is modified
            to be able to make final calculations as well as intermediate.
            It makes the same join buffering choice in both cases.
            Notice: Aligned with old strategy for this commit.
          
            semijoin_materialize_access_paths() calculates access paths
            for the MaterializeScan semi-join strategy. It can be used both in
            intermediate and final stages of table order estimation.
          
            semijoin_dupweedout_access_paths() calculates access paths
            for the DuplicateWeedout semi-join strategy. No corrections are needed
            for the final stage of table order estimation, so intermediate
            decisions are kept as final decisions.
          
            advance_sj_state() is simplified by using the new access path
            calculation functions. Some refactoring of variable names done
            (read_time -> cost, record_count -> rowcount). This cleanup was done
            since most of the code lines were touched anyway.
            Also introduced new local variables sj_strategy for simpler logic.
          
            After call to greedy_search(), assert that cur_sj_inner_tables is 0.
          
            In backout_nj_sj_state(), cur_sj_inner_tables was wrongly backed out:
            "if ((remaining_tables & emb_sj_nest->sj_inner_tables) ==
                 (emb_sj_nest->sj_inner_tables & ~tab->table->map))"
            was never entered:
            - if 'tab' is sj-inner, (remaining_tables & emb_sj_nest->sj_inner_tables)
              contains 'tab', but (emb_sj_nest->sj_inner_tables & ~tab->table->map)
              doesn't
            - if 'tab' is not sj-inner, emb_sj_nest is NULL.
          
          sql/sql_select.h
            Member variables cur_sj_inner_tables and emb_sjm_nest moved from
            class JOIN to class Optimize_table_order.
        ------------------------------------------------------------
        revno: 2876.339.182
        committer: Roy Lyseng <roy.lyseng@oracle.com>
        branch nick: mysql-sb1
        timestamp: Mon 2011-10-24 16:01:11 +0200
        message:
          Bug#12664936: Same query executed as where subquery gives different
                        results on in() compare #2
          
          Step 2 of 2 - Bugfix
          
          The problem here is that ref access is set up wrongly for a table
          inside a materialized semi-join nest. The reference is made to a table
          outside of the semi-join nest, which obviously is not available when
          performing the materialization.
          
          However, best_access_path() has successfully found a ref access pattern
          based on a table inside the semi-join nest, the problem is only that
          create_ref_for_key() gets invalid used_tables data when setting up the
          ref access. Instead of considering all tables that have been traversed
          already in get_best_combination(), we need to ignore tables that are
          outside of the semi-join nest.
          
          mysql-test/include/subquery_sj.inc
            Added test for bug#12664936.
          
          mysql-test/r/subquery_sj_all.result
          mysql-test/r/subquery_sj_all_bka.result
          mysql-test/r/subquery_sj_all_bkaunique.result
          mysql-test/r/subquery_sj_dupsweed.result
          mysql-test/r/subquery_sj_dupsweed_bka.result
          mysql-test/r/subquery_sj_dupsweed_bka_nixbnl.result
          mysql-test/r/subquery_sj_dupsweed_bkaunique.result
          mysql-test/r/subquery_sj_firstmatch.result
          mysql-test/r/subquery_sj_firstmatch_bka.result
          mysql-test/r/subquery_sj_firstmatch_bka_nixbnl.result
          mysql-test/r/subquery_sj_firstmatch_bkaunique.result
          mysql-test/r/subquery_sj_loosescan.result
          mysql-test/r/subquery_sj_loosescan_bka.result
          mysql-test/r/subquery_sj_loosescan_bka_nixbnl.result
          mysql-test/r/subquery_sj_loosescan_bkaunique.result
          mysql-test/r/subquery_sj_mat.result
          mysql-test/r/subquery_sj_mat_bka.result
          mysql-test/r/subquery_sj_mat_bkaunique.result
          mysql-test/r/subquery_sj_mat_nosj.result
          mysql-test/r/subquery_sj_none.result
          mysql-test/r/subquery_sj_none_bka.result
          mysql-test/r/subquery_sj_none_bka_nixbnl.result
          mysql-test/r/subquery_sj_none_bkaunique.result
            Added test results for bug#12664936.
          
          mysql-test/r/subquery_sj_all_bka_nixbnl.result
          mysql-test/r/subquery_sj_mat_bka_nixbnl.result
            Plan is corrected to not use a reference to an outside column
            in a materialized semi-join nest.
            Added test results for bug#12664936.
          
          sql/sql_select.cc
            In JOIN::set_access_methods(), calculated "available tables" as the
            set of used tables found inside the materialized semi-join nest.
            Added some cross references to other places where tables from
            outside the semi-join nest must be excluded.
        ------------------------------------------------------------
        revno: 2876.339.181
        committer: Roy Lyseng <roy.lyseng@oracle.com>
        branch nick: mysql-sb1
        timestamp: Mon 2011-10-24 15:25:03 +0200
        message:
          Bug#12664936: Same query executed as where subquery gives different
                        results on in() compare #2
          
          Step 1 of 2 - Refactoring
          
          This is a local refactoring done before the actual bugfix.
          It makes get_best_combination() a public member function of class
          JOIN, and splits the main work over a few smaller functions.
          It also changes the order of some evaluations so that compiled
          semi-join information is now available in the JOIN_TAB objects at
          an earlier stage.
          get_best_combination() should actually be private, because it is
          only called from make_join_statistics(), which is a free function
          that should also be a private member function of class JOIN.
          
          sql/sql_select.cc
            get_best_combination() is refactored according to pseudo code:
             - Fix semi-join strategies after table order selection.
             - Create the new JOIN_TAB array.
             - A loop that initializes this JOIN_TAB array.
             - A function set_semijoin_info() that sets semi-join information
               for the selected table order in the JOIN_TAB array.
             - A function set_access_methods() that sets up access methods
               based on key information.
             - Update dependencies between tables based on the selected
               key access patterns.
          
          sql/sql_select.h
            Defined get_best_combination() as public member function of JOIN.
            Created set_semijoin_info() and set_access_methods() as private
            member functions of class JOIN. 
        ------------------------------------------------------------
        revno: 2876.339.180
        committer: Jorgen Loland <jorgen.loland@oracle.com>
        branch nick: mysql-next-mr-opt-backporting
        timestamp: Wed 2011-10-19 10:13:00 +0200
        message:
          Recorded result files after merge mysql-trunk -> opt-backporting
    ------------------------------------------------------------
    revno: 2876.249.423 [merge]
    committer: Jorgen Loland <jorgen.loland@oracle.com>
    branch nick: mysql-next-mr-opt-team
    timestamp: Thu 2011-10-27 10:52:27 +0200
    message:
      Nullmerge opt-backporting -> opt-team
        ------------------------------------------------------------
        revno: 2876.339.179 [merge]
        committer: Jorgen Loland <jorgen.loland@oracle.com>
        branch nick: mysql-next-mr-opt-backporting
        timestamp: Wed 2011-10-19 08:26:28 +0200
        message:
          Null-merge mysql-trunk -> opt-backporting
    ------------------------------------------------------------
    revno: 2876.249.422 [merge]
    committer: Jorgen Loland <jorgen.loland@oracle.com>
    branch nick: mysql-next-mr-opt-team
    timestamp: Thu 2011-10-27 10:50:50 +0200
    message:
      Automerge opt-backporting -> opt-team
        ------------------------------------------------------------
        revno: 2876.339.178 [merge]
        committer: Jorgen Loland <jorgen.loland@oracle.com>
        branch nick: mysql-next-mr-opt-backporting
        timestamp: Wed 2011-10-19 08:24:46 +0200
        message:
          Merge mysql-trunk -> opt-backporting. Resolved conflict in
          mysql-test/suite/opt_trace/r/range_{no|ps}_prot.result
    ------------------------------------------------------------
    revno: 2876.249.421 [merge]
    committer: Jorgen Loland <jorgen.loland@oracle.com>
    branch nick: mysql-next-mr-opt-team
    timestamp: Wed 2011-10-19 08:25:51 +0200
    message:
      Automerge mysql-trunk -> opt-team
    ------------------------------------------------------------
    revno: 2876.249.420 [merge]
    committer: Jorgen Loland <jorgen.loland@oracle.com>
    branch nick: mysql-next-mr-opt-team
    timestamp: Wed 2011-10-19 08:23:30 +0200
    message:
      Merge mysql-trunk -> opt-team. Resolved conflict in
      mysql-test/suite/opt_trace/r/range_{no|ps}_prot.result
------------------------------------------------------------
revno: 3536 [merge]
committer: Andrei Elkin <andrei.elkin@oracle.com>
branch nick: trunk-bug11763573_56299_dl_dump_thread_inv
timestamp: Sat 2011-10-29 00:22:19 +0300
message:
  merge from 5.5 to trunk.
    ------------------------------------------------------------
    revno: 2875.321.3
    committer: Andrei Elkin <andrei.elkin@oracle.com>
    branch nick: 5.5-bug11763573_56299_dl_dump_thread_inv
    timestamp: Sat 2011-10-29 00:07:16 +0300
    message:
      BUG#11763573
      
      post-push fixes for show_slave_io_error= 1 of wait_for_slave_io_error.inc;
      Unix and win format path specifically so few tests have to change show_slave_io_error
      to zero.
    ------------------------------------------------------------
    revno: 2875.321.2 [merge]
    committer: Andrei Elkin <andrei.elkin@oracle.com>
    branch nick: 5.5-bug11763573_56299_dl_dump_thread_inv
    timestamp: Fri 2011-10-28 16:11:26 +0300
    message:
      merge from 5.5 to local tree.
------------------------------------------------------------
revno: 3535 [merge]
committer: Andrei Elkin <andrei.elkin@oracle.com>
branch nick: trunk-bug11763573_56299_dl_dump_thread_inv
timestamp: Fri 2011-10-28 16:08:51 +0300
message:
  merge from trunk to local tree.
    ------------------------------------------------------------
    revno: 3402.10.17
    committer: Sergey Glukhov <sergey.glukhov@oracle.com>
    branch nick: mysql-trunk
    timestamp: Fri 2011-10-28 13:45:28 +0400
    message:
      Additional fix for Bug#11747423: 32254: INDEX MERGE USED UNNECESSARILY
      fixed mistake which was done during porting the fix into trunk
      (opposite logic, wrong object type).
    ------------------------------------------------------------
    revno: 3402.10.16
    committer: Tor Didriksen <tor.didriksen@oracle.com>
    branch nick: trunk
    timestamp: Fri 2011-10-28 11:25:48 +0200
    message:
      Bug#11747423 post-push fix: change of plans
    ------------------------------------------------------------
    revno: 3402.10.15
    committer: Tor Didriksen <tor.didriksen@oracle.com>
    branch nick: trunk
    timestamp: Fri 2011-10-28 11:18:35 +0200
    message:
      Default value for sort_buffer_size changed from 2M to 256K
    ------------------------------------------------------------
    revno: 3402.10.14
    committer: Marc Alff <marc.alff@oracle.com>
    branch nick: mysql-trunk
    timestamp: Fri 2011-10-28 09:25:00 +0200
    message:
      Merge cleanup, fixed tree name
    ------------------------------------------------------------
    revno: 3402.10.13
    committer: Sunny Bains <Sunny.Bains@Oracle.Com>
    branch nick: trunk
    timestamp: Fri 2011-10-28 16:11:42 +1100
    message:
      Add missing mutex exit in debug code.
      
      Approved by Inaam over IM.
    ------------------------------------------------------------
    revno: 3402.10.12 [merge]
    committer: Christopher Powers <chris.powers@oracle.com>
    branch nick: mysql-trunk-wl5908
    timestamp: Thu 2011-10-27 16:18:19 -0500
    message:
      downmerge from mysql-trunk
        ------------------------------------------------------------
        revno: 3533.1.2
        committer: kevin.lewis@oracle.com
        branch nick: mysql-trunk
        timestamp: Thu 2011-10-27 15:06:13 -0500
        message:
          Cosmetic changes approved in http://bur03.no.oracle.com/rb/r/763/
        ------------------------------------------------------------
        revno: 3533.1.1
        committer: kevin.lewis@oracle.com
        branch nick: mysql-trunk
        timestamp: Thu 2011-10-27 09:09:11 -0500
        message:
          A debug assertion approved by marko in http://bur03.no.oracle.com/rb/r/763/
          Also added comments and cleaned up white space.
    ------------------------------------------------------------
    revno: 3402.10.11 [merge]
    committer: Marc Alff <marc.alff@oracle.com>
    branch nick: mysql-trunk-wl5908
    timestamp: Wed 2011-10-26 00:56:30 +0200
    message:
      Merge mysql-trunk --> mysql-trunk-wl5908
    ------------------------------------------------------------
    revno: 3402.10.10
    committer: Christopher Powers <chris.powers@oracle.com>
    branch nick: mysql-trunk-wl5908
    timestamp: Wed 2011-10-12 15:32:02 -0500
    message:
      WL#5908 PERFORMANCE_SCHEMA File IO Summary Extensions
      
      Updated mysql-test result files per schema changes
    ------------------------------------------------------------
    revno: 3402.10.9
    committer: Christopher Powers <chris.powers@oracle.com>
    branch nick: mysql-trunk-wl5908
    timestamp: Wed 2011-10-12 15:15:19 -0500
    message:
      WL#5908 PERFORMANCE_SCHEMA File IO Summary Extensions
      
      Changes per code review
    ------------------------------------------------------------
    revno: 3402.10.8 [merge]
    committer: Christopher Powers <chris.powers@oracle.com>
    branch nick: mysql-trunk-wl5908
    timestamp: Wed 2011-10-12 14:56:06 -0500
    message:
      WL#5908 PERFORMANCE_SCHEMA File IO Summary Extensions
      
      - Downmerge from mysql-trunk
    ------------------------------------------------------------
    revno: 3402.10.7 [merge]
    committer: Christopher Powers <chris.powers@oracle.com>
    branch nick: mysql-trunk-wl5908
    timestamp: Thu 2011-10-06 11:06:40 -0500
    message:
      downmerge with mysql-trunk
    ------------------------------------------------------------
    revno: 3402.10.6 [merge]
    committer: Christopher Powers <chris.powers@oracle.com>
    branch nick: mysql-trunk-wl5908
    timestamp: Sat 2011-10-01 12:46:33 -0500
    message:
      downmerge from mysql-trunk
    ------------------------------------------------------------
    revno: 3402.10.5 [merge]
    committer: Christopher Powers <chris.powers@oracle.com>
    branch nick: mysql-trunk-wl5908
    timestamp: Wed 2011-09-21 07:47:15 -0500
    message:
      downmerge with mysql-trunk
    ------------------------------------------------------------
    revno: 3402.10.4 [merge]
    committer: Christopher Powers <chris.powers@oracle.com>
    branch nick: mysql-trunk-wl5908
    timestamp: Fri 2011-09-09 12:57:32 -0500
    message:
      WL#5908 "Performance Schema File Summary Extensions"
      
      Merge w/ mysql-trunk
    ------------------------------------------------------------
    revno: 3402.10.3 [merge]
    committer: Christopher Powers <chris.powers@oracle.com>
    branch nick: base_mysql-trunk-wl5908
    timestamp: Fri 2011-09-02 15:17:31 -0500
    message:
      local merge
        ------------------------------------------------------------
        revno: 3402.11.1 [merge]
        committer: Christopher Powers <chris.powers@oracle.com>
        branch nick: mysql-trunk-wl5908
        timestamp: Wed 2011-08-31 12:49:24 -0500
        message:
          WL#5908 "Performance Schema File IO Summary Table Extensions"
          
          Merge from mysql-trunk
    ------------------------------------------------------------
    revno: 3402.10.2
    committer: Christopher Powers <chris.powers@oracle.com>
    branch nick: mysql-trunk-wl5908
    timestamp: Fri 2011-09-02 15:03:36 -0500
    message:
      WL#5908 "File IO Summary Table Extensions"
      
      Full worklog implementation to track file timer and IO per operation:
      - Split file_summary_by_instance and _by_event_name into separate files
      - Removed file_summary.cc
      - Updated file visitor methods
      - Updated test cases
    ------------------------------------------------------------
    revno: 3402.10.1
    committer: Marc Alff <marc.alff@oracle.com>
    branch nick: mysql-trunk-wl5908
    timestamp: Mon 2011-08-29 21:38:59 +0200
    message:
      New branch
------------------------------------------------------------
revno: 3534 [merge]
committer: Andrei Elkin <andrei.elkin@oracle.com>
branch nick: trunk-bug11763573_56299_dl_dump_thread_inv
timestamp: Thu 2011-10-27 22:28:15 +0300
message:
  merge 5.5 -> trunk carrying bug11763573_56299 fixes.
    ------------------------------------------------------------
    revno: 2875.321.1
    committer: Andrei Elkin <andrei.elkin@oracle.com>
    branch nick: 5.5-bug11763573_56299_dl_dump_thread_inv
    timestamp: Thu 2011-10-27 17:14:41 +0300
    message:
      Bug#11763573 - 56299: MUTEX DEADLOCK WITH COM_BINLOG_DUMP, BINLOG PURGE, AND PROCESSLIST/KILL
      
      The bug case is similar to one fixed earlier bug_49536.
      Deadlock involving LOCK_log appears to be possible because the purge running thread
      is holding LOCK_log whereas there is no sense of doing that and which fact was
      exploited by the earlier bug fixes.
      
      Fixed with small reengineering of rotate_and_purge(), adding two new methods and
      setting up a policy to execute those instead of the former
      rotate_and_purge(RP_LOCK_LOG_IS_ALREADY_LOCKED).
      The policy for using rotate(), purge() is that if the caller acquires LOCK_log itself,
      it should call rotate(), release the mutex and run purge().
      
      Side effect of this patch is refining error message of bug@11747416 to print
      the whole path.
------------------------------------------------------------
revno: 3533
committer: Andrei Elkin <andrei.elkin@oracle.com>
branch nick: mysql-trunk
timestamp: Thu 2011-10-27 16:28:31 +0300
message:
  Fixing two issues.
  One is with rpl_alter_repository which was pushed with an extra line, removed.
  
  The other is in that MIXED mode of rpl_*_crash_safe had been merged with STM ago.
  At WL5569 merging time
  the test was renamed to indicate the fact of that and unintentionally added two .THIS files.
  This patch removes them.
------------------------------------------------------------
revno: 3532 [merge]
committer: Marko M?kel? <marko.makela@oracle.com>
branch nick: mysql-trunk
timestamp: Thu 2011-10-27 15:39:16 +0300
message:
  Merge mysql-5.5 to mysql-trunk.
    ------------------------------------------------------------
    revno: 2875.314.46 [merge]
    committer: Marko M?kel? <marko.makela@oracle.com>
    branch nick: mysql-5.5
    timestamp: Thu 2011-10-27 15:23:58 +0300
    message:
      Merge mysql-5.1 to mysql-5.5.
        ------------------------------------------------------------
        revno: 2661.809.49
        committer: Marko M?kel? <marko.makela@oracle.com>
        branch nick: mysql-5.1
        timestamp: Thu 2011-10-27 14:58:12 +0300
        message:
          Bug #12884631 62146: TABLES ARE LOST FOR DDL
          
          row_rename_table_for_mysql(): Return DB_ERROR instead of DB_SUCCESS
          when fil_rename_tablespace() returns an error. This bug was introduced
          in the InnoDB Plugin.
          
          Approved by Sunny Bains over IM.
------------------------------------------------------------
revno: 3531
committer: Jon Olav Hauglid <jon.hauglid@oracle.com>
branch nick: mysql-trunk-bug13251277
timestamp: Thu 2011-10-27 14:13:46 +0200
message:
  Bug#13251277 CHECK_GRANT SHOULDN'T LOCK/UNLOCK LOCK_GRANT
               WITHOUT NEEDING TO
  
  The problem was that check_table_access() was called for each
  stored routine instruction even if the instruction did not use
  any tables. This is a performance problem since
  check_table_access() causes the LOCK_grant rw lock to be taken
  (by calling check_grant()). For example, it caused up to 20 %
  slowdown in a simple stored routine calculating Fibonacci's
  numbers.
  
  This patch fixes the problem by changing the code so that
  check_table_access() is only called for stored routine
  instructions that actually use tables.
  
  The patch doesn't contain a test case since it is hard to test
  for performance improvements in our test framework.
------------------------------------------------------------
revno: 3530 [merge]
committer: Alfranio Correia <alfranio.correia@oracle.com>
branch nick: mysql-trunk-merge
timestamp: Thu 2011-10-27 12:19:32 +0100
message:
  merge mysql-trunk (local) --> mysql-trunk
    ------------------------------------------------------------
    revno: 3516.1.2
    committer: Alfranio Correia <alfranio.correia@oracle.com>
    branch nick: mysql-trunk
    timestamp: Thu 2011-10-20 14:06:58 +0100
    message:
      Due to a bug on how workers' repositories are migrated a null-pointer is being
      returned and this was not being checked thus causing a crash.
      
      In the context of this patch, we check if null-pointer is returned and avoid
      crashes. Howerver, the problem in the migration procedure is not fixed here
      and will be fixed in another bug (maybe BUG#12334346).
    ------------------------------------------------------------
    revno: 3516.1.1
    committer: Alfranio Correia <alfranio.correia@oracle.com>
    branch nick: mysql-trunk
    timestamp: Thu 2011-10-20 10:01:41 +0100
    message:
      BUG#12402875 - BUG#60902: MYSQLDUMP DOES NOT DUMP THE REPLICATION *_INFO TABLES
        
      Post-push fix.
      
      Fixed error in test case: The SET command should have its value wrapped up
      by quotes to avoid syntax errors.
------------------------------------------------------------
revno: 3529 [merge]
committer: Inaam Rana <inaam.rana@oracle.com>
branch nick: mysql-trunk
timestamp: Thu 2011-10-27 07:09:44 -0400
message:
  merge from parent
    ------------------------------------------------------------
    revno: 3527.1.10
    committer: Jon Olav Hauglid <jon.hauglid@oracle.com>
    branch nick: mysql-trunk-bug13113222
    timestamp: Thu 2011-10-27 11:26:31 +0200
    message:
      Bug#13113222 RQG_SIGNAL_RESIGNAL FAILED WITH ASSERTION.
      
      The triggered assert checks that a matching condition is
      found inside the diagnostics area when a handler is activated.
      It was triggered in this case if the diagnostics area was
      full when the condition was reported (e.g. the area already
      contains max_error_count conditions). This meant that the
      diagnostics area did not contain a matching condition when
      the handler code tried to look for it.
      
      This was a regression introduced by WL#5986.
      
      This patch fixes the problem by temporarily making a condition
      in such cases so it can be handled properly.
      
      Test case added to sp-error.test.
    ------------------------------------------------------------
    revno: 3527.1.9
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: trunk2
    timestamp: Thu 2011-10-27 02:07:40 -0700
    message:
      Fix Bug #12622592 - UT_AD ASSERT IGNORE_ERR!=DICT_ERR_IGNORE_NONE||
      TABLE->CORRUPTET==0
      
      rb://791 approved by Sunny Bains
    ------------------------------------------------------------
    revno: 3527.1.8
    committer: Sergey Glukhov <sergey.glukhov@oracle.com>
    branch nick: mysql-trunk
    timestamp: Thu 2011-10-27 12:43:56 +0400
    message:
      Bug#11746275 24986: CALLS TO HANDLER::RND_INIT AND HANDLER::INDEX_INIT IGNORE RETURN VALUE
      Changes in init_read_record(), init_read_record_idx functions():
      --return type is changed from void to bool
      --added error message generation when it's necessary
    ------------------------------------------------------------
    revno: 3527.1.7
    committer: Sergey Glukhov <sergey.glukhov@oracle.com>
    branch nick: mysql-trunk
    timestamp: Thu 2011-10-27 12:40:40 +0400
    message:
      Bug#11747423 32254: INDEX MERGE USED UNNECESSARILY
      There was an assumption that quick select is always faster
      than ref access for InnoDB tables. But some test cases show
      that it's not true for index merge access. In some cases
      ref access by compound single key is better than
      index merge access by several keys. The fix is to
      add a check that INDEX MERGE access is not more expensive
      than ref access.
    ------------------------------------------------------------
    revno: 3527.1.6
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: mysql-trunk
    timestamp: Thu 2011-10-27 01:20:56 -0700
    message:
      Fix Bug #11755924 - 47764: PARTITIONED INNODB TABLES CAN'T BE MOVED DIRECTLY
      FROM WINDOWS TO LINUX
                              
      rb://786 approved by Sunny Bains
    ------------------------------------------------------------
    revno: 3527.1.5 [merge]
    committer: Jimmy Yang <jimmy.yang@oracle.com>
    branch nick: trunk3
    timestamp: Thu 2011-10-27 01:10:22 -0700
    message:
      merge from mysql-5.5 to mysql-trunk
        ------------------------------------------------------------
        revno: 2875.314.45 [merge]
        committer: Jimmy Yang <jimmy.yang@oracle.com>
        branch nick: mysql-5.5
        timestamp: Thu 2011-10-27 00:40:53 -0700
        message:
          Fix Bug #11835889 - INNODB ASSERTS ON BAD FILE READ, INDEX TRANSLATION
          TABLE ERROR, RECOVERY
                      
          rb://792 approved by Sunny Bains
            ------------------------------------------------------------
            revno: 2661.820.1
            committer: Jimmy Yang <jimmy.yang@oracle.com>
            branch nick: mysql-5.1
            timestamp: Wed 2011-09-07 21:42:14 -0700
            message:
              Fix Bug #12885783 - BLOCK LOADING TABLE WITH LARGE COLLATION NUMBER
              FROM 5.6 SERVER
              
              rb://747 approved by Marko
    ------------------------------------------------------------
    revno: 3527.1.4
    committer: Norvald H. Ryeng <norvald.ryeng@oracle.com>
    branch nick: mysql-trunk-11764372
    timestamp: Thu 2011-10-27 10:08:46 +0200
    message:
      Bug #11764372 57197: EVEN MORE USER VARIABLE CRASHING FUN
      
      Problem: Some assignments of subselect results to user variables
      causes the server to crash.
      
      During query execution, copy_fields() tries to read a Copy_field from
      a null pointer. The Copy_field has already been freed and the pointer
      set to null during TMP_TABLE_PARAM::cleanup(). However, copy_field_end
      is not reset. The copy_field() function is expected to handle a null
      copy_field pointer, but only if copy_field_end is also null.
      
      Fix: Set copy_field_end and save_copy_field_end to null when deleting
      copy fields in TMP_TABLE_PARAM::cleanup() and add assertion in
      copy_fields() to check parameters.
    ------------------------------------------------------------
    revno: 3527.1.3 [merge]
    committer: Marc Alff <marc.alff@oracle.com>
    branch nick: mysql-trunk-merge
    timestamp: Thu 2011-10-27 09:30:10 +0200
    message:
      Merge mysql-trunk-wl5863 --> mysql-trunk
      
      WL#5863 PERFORMANCE SCHEMA, NESTED-SET data model 
        ------------------------------------------------------------
        revno: 3398.3.10 [merge]
        committer: Marc Alff <marc.alff@oracle.com>
        branch nick: mysql-trunk-wl5863
        timestamp: Thu 2011-10-27 09:12:23 +0200
        message:
          Merge mysql-trunk --> mysql-trunk-wl5863
        ------------------------------------------------------------
        revno: 3398.3.9 [merge]
        committer: Marc Alff <marc.alff@oracle.com>
        branch nick: mysql-trunk-wl5863
        timestamp: Thu 2011-10-27 08:56:31 +0200
        message:
          Merge mysql-trunk --> mysql-trunk-wl5863
        ------------------------------------------------------------
        revno: 3398.3.8 [merge]
        committer: Marc Alff <marc.alff@oracle.com>
        branch nick: mysql-trunk-wl5863
        timestamp: Wed 2011-10-26 00:54:22 +0200
        message:
          Merge mysql-trunk --> mysql-trunk-wl5863
        ------------------------------------------------------------
        revno: 3398.3.7 [merge]
        committer: Marc Alff <marc.alff@oracle.com>
        branch nick: mysql-trunk-wl5863
        timestamp: Mon 2011-10-10 12:33:31 +0200
        message:
          Merge mysql-trunk --> mysql-trunk-wl5863
        ------------------------------------------------------------
        revno: 3398.3.6 [merge]
        committer: Marc Alff <marc.alff@oracle.com>
        branch nick: mysql-trunk-wl5863
        timestamp: Mon 2011-10-10 12:15:46 +0200
        message:
          Merge mysql-trunk --> mysql-trunk-wl5863
        ------------------------------------------------------------
        revno: 3398.3.5 [merge]
        committer: Marc Alff <marc.alff@oracle.com>
        branch nick: mysql-trunk-wl5863
        timestamp: Thu 2011-10-06 16:36:15 +0200
        message:
          Merge mysql-trunk --> mysql-trunk-wl5863
        ------------------------------------------------------------
        revno: 3398.3.4 [merge]
        committer: Marc Alff <marc.alff@oracle.com>
        branch nick: mysql-trunk-wl5863
        timestamp: Fri 2011-09-23 15:36:29 +0200
        message:
          Merge mysql-trunk --> mysql-trunk-wl5863
        ------------------------------------------------------------
        revno: 3398.3.3 [merge]
        committer: Marc Alff <marc.alff@oracle.com>
        branch nick: mysql-trunk-wl5863
        timestamp: Fri 2011-09-23 14:10:08 +0200
        message:
          Merge mysql-trunk --> mysql-trunk-wl5863
        ------------------------------------------------------------
        revno: 3398.3.2 [merge]
        committer: Marc Alff <marc.alff@oracle.com>
        branch nick: mysql-trunk-wl5863
        timestamp: Mon 2011-09-19 19:13:42 +0200
        message:
          Merge mysql-trunk --> mysql-trunk-wl5863
        ------------------------------------------------------------
        revno: 3398.3.1
        committer: Marc Alff <marc.alff@oracle.com>
        branch nick: mysql-trunk-wl5863
        timestamp: Fri 2011-08-26 10:42:40 +0200
        message:
          WL#5863 PERFORMANCE SCHEMA, NESTED-SET data model
          
          Added the END_EVENT_ID column to events tables.
    ------------------------------------------------------------
    revno: 3527.1.2
    committer: Norvald H. Ryeng <norvald.ryeng@oracle.com>
    branch nick: mysql-trunk-11764818
    timestamp: Thu 2011-10-27 09:03:49 +0200
    message:
      Bug #11764818 57692: CRASH IN ITEM_FUNC_IN::VAL_INT() WITH ZEROFILL
      
      Problem: During optimization, ZEROFILL values may be converted to
      string constants. However, the IN function does not handle switching
      datatypes after planning, leading to IN finding a null pointer instead
      of its argument.
      
      Item_func_in creates a table of cmp_items, one for each datatype used
      in the comparison. This table is created during query planning by
      fix_length_and_dec(). During optimization,
      Item_field::equal_fields_propagator() converts ZEROFILL numbers to
      strings, but the comparison table in Item_func_in is not
      updated. During execution, the position in the comparison table is
      found by examining the result types of the fields to be
      compared. Since the result type of the fields have changed, the wrong
      position in the comparison table is inferred, and this position
      contains a null pointer.
      
      Fix: Set the cmp_context of arguments to Item_func_in so that
      Item_field::equal_fields_propagator() will not convert them to
      strings.
    ------------------------------------------------------------
    revno: 3527.1.1 [merge]
    committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
    branch nick: mysql-trunk
    timestamp: Thu 2011-10-27 10:17:58 +0400
    message:
      Null merge from mysql-5.5.
        ------------------------------------------------------------
        revno: 2875.314.44 [merge]
        committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
        branch nick: mysql-5.5
        timestamp: Thu 2011-10-27 10:16:36 +0400
        message:
          Null-merge from mysql-5.1.
            ------------------------------------------------------------
            revno: 2661.809.48
            committer: Karen Langford <karen.langford@oracle.com>
            branch nick: mysql-5.1
            timestamp: Wed 2011-10-26 20:48:42 +0200
            message:
              Increased version number after cloning 5.1.60
        ------------------------------------------------------------
        revno: 2875.314.43
        committer: Hery Ramilison <hery.ramilison@oracle.com>
        branch nick: mysql-5.5
        timestamp: Wed 2011-10-26 20:44:18 +0200
        message:
          cloning 5.5.18 off
------------------------------------------------------------
revno: 3528
committer: Inaam Rana <inaam.rana@oracle.com>
branch nick: mysql-trunk
timestamp: Tue 2011-10-25 12:32:23 -0400
message:
  Bug#13006056 ASSERT AT BUF0BUF.IC IN THE TEST INNODB_BUG59733
  
  Approved by: Marko
  
  In buf_page_get_gen() block_mutex and block->mutex should always be
  pointing to the same mutex. This was broken when reread a page
  during ibuf_debug processing.
------------------------------------------------------------
revno: 3527 [merge]
committer: Nirbhay Choubey <nirbhay.choubey@oracle.com>
branch nick: mysql-trunk
timestamp: Mon 2011-10-24 13:50:32 +0530
message:
  Local merge from mysql-5.5.
    ------------------------------------------------------------
    revno: 2875.314.42 [merge]
    committer: Nirbhay Choubey <nirbhay.choubey@oracle.com>
    branch nick: mysql-5.5
    timestamp: Mon 2011-10-24 13:48:54 +0530
    message:
      Local merge from mysql-5.1.
        ------------------------------------------------------------
        revno: 2661.809.47
        committer: Nirbhay Choubey <nirbhay.choubey@oracle.com>
        branch nick: mysql-5.1
        timestamp: Mon 2011-10-24 13:35:28 +0530
        message:
          WL#5945 - Improve libedit library
          
          Fixed a misplaced parenthesis, injected due to
          syncing from libedit CVS head.
------------------------------------------------------------
revno: 3526 [merge]
committer: Dmitry Lenev <Dmitry.Lenev@oracle.com>
branch nick: mysql-trunk-mrg
timestamp: Mon 2011-10-24 11:49:46 +0400
message:
  Merge of fix for bug #13116518 "OPEN_TABLES() SHOULD NOT ALLOCATE
  AND FREE NEW_FRM_MEM WITHOUT NEEDING TO".
    ------------------------------------------------------------
    revno: 2875.314.41
    committer: Dmitry Lenev <Dmitry.Lenev@oracle.com>
    branch nick: mysql-5.5-13116518
    timestamp: Sun 2011-10-23 09:37:35 +0400
    message:
      Fix for bug #13116518 - "OPEN_TABLES() SHOULD NOT ALLOCATE AND FREE 
      NEW_FRM_MEM WITHOUT NEEDING TO".
      
      During the process of opening tables for a statement, we allocated
      memory which was used only during view loading even in cases when the
      statement didn't use any views. Such an unnecessary allocation (and
      corresponding freeing) might have caused significant performance
      overhead in some workloads. For example, it caused up to 15% slowdown
      in a simple stored routine calculating Fibonacci's numbers.
      
      This memory was pre-allocated as part of "new_frm_mem" MEM_ROOT
      initialization at the beginning of open_tables(). 
      
      This patch addresses this issue by turning off memory pre-allocation
      during initialization for this MEM_ROOT. Now, memory on this root
      will be allocated only at the point when the first .FRM for a view is 
      opened.
      
      The patch doesn't contain a test case since it is hard to test the
      performance improvements or the absence of memory allocation in our
      test framework.
------------------------------------------------------------
revno: 3525 [merge]
committer: Ashish Agarwal<ashish.y.agarwal@oracle.com>
branch nick: mysql-trunk
timestamp: Sat 2011-10-22 18:57:18 +0530
message:
  #BUG#11758979 - 51252: merge from mysql-5.5
    ------------------------------------------------------------
    revno: 2875.314.40 [merge]
    committer: Ashish Agarwal<ashish.y.agarwal@oracle.com>
    branch nick: bug_793_5.5
    timestamp: Sat 2011-10-22 17:04:38 +0530
    message:
      bug#11758979 - 51252: ARCHIVE TABLES STILL FAIL UNDER STRESS
                            TESTS: CRASH, CORRUPTION, 4G MEMOR
      
      Issue: Valgrind errors due to checksum and optimize
             query against archive tables with null columns.
             Table record buffer was not initialized.
      
      Solution: Initialize the record buffer.
        ------------------------------------------------------------
        revno: 2875.320.1
        committer: Ashish Agarwal<ashish.y.agarwal@oracle.com>
        branch nick: bug_793_5.5
        timestamp: Fri 2011-10-21 16:19:58 +0530
        message:
          bug#11758979 - 51252: ARCHIVE TABLES STILL FAIL UNDER STRESS
                                TESTS: CRASH, CORRUPTION, 4G MEMOR
          
          Issue: Valgrind errors due to checksum and optimize 
                 query angaist archive tables with null columns.
                 Table record buffer was not initialized.
          
          Solution: Initialize the record buffer.
------------------------------------------------------------
revno: 3524
committer: kevin.lewis@oracle.com
branch nick: mysql-trunk
timestamp: Fri 2011-10-21 10:46:57 -0500
message:
  WL5873 - TABLE FLAGS REFACTORING
  ** This is a non-functional change.
  
  Isolate all table flag handling to inline functions.
  Separate handing of table flags from tablespace flags, table flags
  and SYS_TABLES.TYPE.  Add and clarify lots of comments.
  Make conversion routines between the three versions of these flags.
  Make validation routines for tablespace flags and table flags.
  Updated copyright on touched files and other code cleanup.
------------------------------------------------------------
revno: 3523
committer: Vasil Dimov <vasil.dimov@oracle.com>
branch nick: mysql-trunk
timestamp: Fri 2011-10-21 17:59:52 +0300
message:
  Revert vasil.dimov@oracle.com-20111021105028-0qlfem4n84d6uf2l
------------------------------------------------------------
revno: 3522 [merge]
committer: Nirbhay Choubey <nirbhay.choubey@oracle.com>
branch nick: mysql-trunk
timestamp: Fri 2011-10-21 18:30:10 +0530
message:
  Merge of fix for bug#13106585 from mysql-5.5.
    ------------------------------------------------------------
    revno: 2875.314.39 [merge]
    committer: Nirbhay Choubey <nirbhay.choubey@oracle.com>
    branch nick: mysql-5.5
    timestamp: Fri 2011-10-21 18:14:35 +0530
    message:
      Merge of fix for bug#13106585 from mysql-5.1.
        ------------------------------------------------------------
        revno: 2661.809.46
        committer: Nirbhay Choubey <nirbhay.choubey@oracle.com>
        branch nick: B13106585-5.1
        timestamp: Fri 2011-10-21 18:10:12 +0530
        message:
          Bug#13106585 PUSH FOR "WL#5945 : IMPROVE LIBEDIT LIBRARY"
                       BREAKS SOURCE RELEASE BUILD
          
          Some of the required files were not getting copied while
          performing 'make dist' and hence the build failed for
          the created distribution source.
          
          Added the missing files to Makefile.am.
------------------------------------------------------------
revno: 3521
committer: Olav Sandstaa <olav.sandstaa@oracle.com>
branch nick: no-opt-trace
timestamp: Fri 2011-10-21 13:13:05 +0200
message:
  Fix for Bug#13242509 - COMPILE ERROR WHEN COMPILING WITHOUT OPTIMIZER TRACE
  
  The compilation failed due to the member function add(const char*, ulong) was
  missing from the "empty" implementation of Opt_trace_object that is used when
  compiling without support for optimizer traces. The fix is to add the function
  to the empty Opt_trace_object.
------------------------------------------------------------
revno: 3520
committer: Vasil Dimov <vasil.dimov@oracle.com>
branch nick: mysql-trunk
timestamp: Fri 2011-10-21 13:50:28 +0300
message:
  Fix Bug#12661768 UPDATE IGNORE CRASHES SERVER IF TABLE IS INNODB AND IT IS
  PARENT FOR OTHER ONE
  
  When "UPDATE t1 SET c = 1" is prevented by a duplicate entry in t2 (where
  there is a FK on t1 and t2 and ON UPDATE CASCADE), then InnoDB returns the
  number of the offending index from t2, but the MySQL part of the code
  assumes this is the Nth index from t1. If t1 contains less indexes, then a
  crash may occur, or if the returned number is less than the number of the
  indexes - then a bogus data is printed.
  
  Since MySQL is not aware of the second table, the option here is to return
  its name and the index name from InnoDB to MySQL instead of just a bare
  number (designating the number of the index).
  
  Approved by:	Jimmy, Marko, Jon Olav Hauglid (rb://768)
------------------------------------------------------------
revno: 3519 [merge]
committer: Sergey Vojtovich <sergey.vojtovich@oracle.com>
branch nick: mysql-trunk-push
timestamp: Fri 2011-10-21 09:42:01 +0400
message:
  Merge.
    ------------------------------------------------------------
    revno: 2875.314.38 [merge]
    committer: Sergey Vojtovich <sergey.vojtovich@oracle.com>
    branch nick: mysql-5.5-push
    timestamp: Fri 2011-10-21 09:35:07 +0400
    message:
      Merge.
        ------------------------------------------------------------
        revno: 2661.809.45 [merge]
        committer: Sergey Vojtovich <sergey.vojtovich@oracle.com>
        branch nick: mysql-5.1-push
        timestamp: Fri 2011-10-21 09:30:56 +0400
        message:
          Merge.
            ------------------------------------------------------------
            revno: 2661.819.1
            committer: Sergey Vojtovich <sergey.vojtovich@oracle.com>
            branch nick: mysql-5.1-bug49030
            timestamp: Thu 2011-10-20 15:03:22 +0400
            message:
              BUG#11757032 - 49030: OPTIMIZE TABLE BREAKS MYISAM TABLE WHEN
                             USING MYISAM_USE_MMAP ON WINDOWS
              
              When OPTIMIZE/REPAIR TABLE is switching to new data file,
              old data file is removed while memory mapping is still
              active.
              
              With 5.1 implementation of nt_share_delete() it is not
              permitted to remove mmaped file.
              
              This fix disables memory mapping for mi_repair() operations.
------------------------------------------------------------
revno: 3518 [merge]
committer: Marko M?kel? <marko.makela@oracle.com>
branch nick: mysql-trunk
timestamp: Fri 2011-10-21 07:04:07 +0300
message:
  Merge mysql-5.5 to mysql-trunk.
    ------------------------------------------------------------
    revno: 2875.314.37 [merge]
    committer: Marko M?kel? <marko.makela@oracle.com>
    branch nick: mysql-5.5
    timestamp: Fri 2011-10-21 06:54:49 +0300
    message:
      Merge mysql-5.1 to mysql-5.5.
        ------------------------------------------------------------
        revno: 2661.809.44
        committer: Marko M?kel? <marko.makela@oracle.com>
        branch nick: mysql-5.1
        timestamp: Fri 2011-10-21 06:32:16 +0300
        message:
          Bug#13116045 Compilation failure using GCC 4.6.1 in btr/btr0cur.c
          
          btr_record_not_null_field_in_rec(): Remove the parameter rec.
          Use rec_offs_nth_sql_null() instead of rec_get_nth_field().
          
          rb:788 approved by Jimmy Yang
------------------------------------------------------------
revno: 3517
committer: Jimmy Yang <jimmy.yang@oracle.com>
branch nick: trunk2
timestamp: Thu 2011-10-20 18:15:11 -0700
message:
  Fix Bug #12941439 - WITH UNIV_SYNC_DEBUG, PERF SCHEMA, INITIALIZATION OF
  16G BUFFER POOL TAKES HOURS. "block->debug"_latch should be under
  "PFS_SKIP_BUFFER_MUTEX_RWLOCK" control and being skipped by default
------------------------------------------------------------
revno: 3516
committer: Jimmy Yang <jimmy.yang@oracle.com>
branch nick: trunk2
timestamp: Wed 2011-10-19 18:55:27 -0700
message:
  Fix bug #12320827 INNODB.INNODB_MONITOR TEST FAILS WITH DIFF IN 
  METADATA_TABLE_REFERENCE_COUNT
  Disable all counters at the beginning of innodb_monitor.test, so that result
  from previous runs will not affect subsequent runs. Also reset metadata
  module to clean up any possible left over values to "contaminate" the testing
  result
------------------------------------------------------------
revno: 3515 [merge]
committer: Bjorn Munch <bjorn.munch@oracle.com>
branch nick: testcr-tr
timestamp: Wed 2011-10-19 23:49:22 +0200
message:
  Removing copyright headers from test files
    ------------------------------------------------------------
    revno: 2875.314.36 [merge]
    committer: Bjorn Munch <bjorn.munch@oracle.com>
    branch nick: testcr-55
    timestamp: Wed 2011-10-19 23:44:17 +0200
    message:
      Removing copyright headers from test files
        ------------------------------------------------------------
        revno: 2661.809.43
        committer: Bjorn Munch <bjorn.munch@oracle.com>
        branch nick: testcr-51
        timestamp: Wed 2011-10-19 13:36:57 +0200
        message:
          Remove copyright header from parser_stack.test
------------------------------------------------------------
revno: 3514
committer: Marc Alff <marc.alff@oracle.com>
branch nick: mysql-trunk-cleanup
timestamp: Wed 2011-10-19 19:56:04 +0200
message:
  Misc merge cleanup for the socket instrumentation.
------------------------------------------------------------
revno: 3513 [merge]
committer: Joerg Bruehe <joerg.bruehe@oracle.com>
branch nick: mysql-trunk
timestamp: Wed 2011-10-19 13:42:46 +0200
message:
  Upmerge 5.5.17 stuff into 5.6.
    ------------------------------------------------------------
    revno: 2875.314.35 [merge]
    committer: Joerg Bruehe <joerg.bruehe@oracle.com>
    branch nick: mysql-5.5
    timestamp: Wed 2011-10-19 13:39:43 +0200
    message:
      Merge the changes of 5.5.17 back into main 5.5
        ------------------------------------------------------------
        revno: 2875.319.4
        tags: mysql-5.5.17
        committer: Joerg Bruehe <joerg.bruehe@oracle.com>
        branch nick: clone-5.5
        timestamp: Tue 2011-10-04 12:28:30 +0200
        message:
          Exclude NDB man pages from a source tarball,
          these sources don't have any current NDB.
        ------------------------------------------------------------
        revno: 2875.319.3
        committer: Joerg Bruehe <joerg.bruehe@oracle.com>
        branch nick: clone-5.5
        timestamp: Fri 2011-09-30 13:37:22 +0200
        message:
          Transferring a change from main 5.5 into the 5.5.17 build:
          
          | revision-id: inaam.rana@oracle.com-20110930110219-vnpaqghj9hm0grds
          | parent: rohit.kalhans@oracle.com-20110930094635-hjhrv55tg6z6pz7y
          | committer: Inaam Rana <inaam.rana@oracle.com>
          | branch nick: mysql-5.5
          | timestamp: Fri 2011-09-30 07:02:19 -0400
          | message:
          |   Revert original fix for Bug 12612184 and the follow up fix for
          |   Bug 12704861.
          |
          |   Bug 12704861 fix was revno: 3504.1.1 (rb://693)
          |   Bug 12612184 fix was revno: 3445.1.10 (rb://678)
        ------------------------------------------------------------
        revno: 2875.319.2
        committer: Joerg Bruehe <joerg.bruehe@oracle.com>
        branch nick: clone-5.5
        timestamp: Fri 2011-09-30 13:27:29 +0200
        message:
          Transferring a change from main 5.5 into the 5.5.17 build:
          
          | revision-id: rafal.somla@oracle.com-20110929150216-jl3y54s54w04y2vu
          | parent: marko.makela@oracle.com-20110929123146-03lcg1vixncyviyn
          | committer: Rafal Somla <rafal.somla@oracle.com>
          | branch nick: bug12982926
          | timestamp: Thu 2011-09-29 17:02:16 +0200
          | message:
          |   Bug#12982926  CLIENT CAN OVERRIDE ZERO-LENGTH-ALLOCATE BUFFER
          | 
          |   Changes in client plugin needed for testing the issue (test instrumentation).
        ------------------------------------------------------------
        revno: 2875.319.1
        committer: Joerg Bruehe <joerg.bruehe@oracle.com>
        branch nick: clone-5.5
        timestamp: Wed 2011-09-28 11:43:16 +0200
        message:
          Fix the spec file: Files must not be mentioned twice in a "%files" list.
------------------------------------------------------------
revno: 3512 [merge]
committer: sayantan.dutta@oracle.com
branch nick: mysql-trunk
timestamp: Wed 2011-10-19 12:59:57 +0530
message:
  upmerge 11754855 5.5 => trunk
    ------------------------------------------------------------
    revno: 2875.314.34
    committer: sayantan.dutta@oracle.com
    branch nick: mysql5.5
    timestamp: Wed 2011-10-19 12:53:52 +0530
    message:
      Bug #11754855 46528: NEED A WAY TO PASS A VARIABLE TO MTR COMMANDS
      
      modified function do_get_error in mysqltest.cc to handle multiple variable passed
      added test case to mysqltest.test to verify handling to multiple errors passed
------------------------------------------------------------
revno: 3511 [merge]
committer: Jorgen Loland <jorgen.loland@oracle.com>
branch nick: mysql-trunk
timestamp: Wed 2011-10-19 08:13:35 +0200
message:
  Automerge opt-team -> trunk
    ------------------------------------------------------------
    revno: 2876.249.419 [merge]
    committer: Jorgen Loland <jorgen.loland@oracle.com>
    branch nick: mysql-next-mr-opt-team
    timestamp: Tue 2011-10-18 16:35:02 +0200
    message:
      Automerge opt-backporting -> opt-team
        ------------------------------------------------------------
        revno: 2876.339.177
        committer: Tor Didriksen <tor.didriksen@oracle.com>
        branch nick: next-mr-opt-backporting
        timestamp: Thu 2011-10-13 15:22:45 +0200
        message:
          "records" => "rows" in opt-trace/filesort
        ------------------------------------------------------------
        revno: 2876.339.176
        committer: Tor Didriksen <tor.didriksen@oracle.com>
        branch nick: next-mr-opt-backporting
        timestamp: Thu 2011-10-13 14:03:02 +0200
        message:
          new test results after backporting and merge dance
    ------------------------------------------------------------
    revno: 2876.249.418 [merge]
    committer: Jorgen Loland <jorgen.loland@oracle.com>
    branch nick: mysql-next-mr-opt-team
    timestamp: Tue 2011-10-18 16:25:42 +0200
    message:
      NULL-merge the NULL-merge (opt-backporting -> opt-team)
        ------------------------------------------------------------
        revno: 2876.339.175 [merge]
        committer: Tor Didriksen <tor.didriksen@oracle.com>
        branch nick: next-mr-opt-backporting
        timestamp: Thu 2011-10-13 13:04:45 +0200
        message:
          NULL merge trunk => opt-backporting
    ------------------------------------------------------------
    revno: 2876.249.417 [merge]
    committer: Jorgen Loland <jorgen.loland@oracle.com>
    branch nick: mysql-next-mr-opt-team
    timestamp: Tue 2011-10-18 16:17:23 +0200
    message:
      Merge opt-backporting -> opt-team
        ------------------------------------------------------------
        revno: 2876.339.174
        committer: Tor Didriksen <tor.didriksen@oracle.com>
        branch nick: next-mr-opt-backporting
        timestamp: Thu 2011-10-13 13:00:58 +0200
        message:
          new test results after merge
    ------------------------------------------------------------
    revno: 2876.249.416 [merge]
    committer: Jorgen Loland <jorgen.loland@oracle.com>
    branch nick: mysql-next-mr-opt-team
    timestamp: Tue 2011-10-18 16:15:51 +0200
    message:
      NULL merged test result changes from opt-backporting
        ------------------------------------------------------------
        revno: 2876.339.173 [merge]
        committer: Tor Didriksen <tor.didriksen@oracle.com>
        branch nick: next-mr-opt-backporting
        timestamp: Thu 2011-10-13 12:24:35 +0200
        message:
          Merge trunk => opt-backporting
    ------------------------------------------------------------
    revno: 2876.249.415 [merge]
    committer: Tor Didriksen <tor.didriksen@oracle.com>
    branch nick: next-mr-opt-team
    timestamp: Thu 2011-10-13 12:28:15 +0200
    message:
      empty merge trunk => opt-team
    ------------------------------------------------------------
    revno: 2876.249.414 [merge]
    committer: Tor Didriksen <tor.didriksen@oracle.com>
    branch nick: next-mr-opt-team
    timestamp: Thu 2011-10-13 12:24:24 +0200
    message:
      Merge trunk => opt-team
------------------------------------------------------------
revno: 3510 [merge]
committer: Nirbhay Choubey <nirbhay.choubey@oracle.com>
branch nick: mysql-trunk
timestamp: Tue 2011-10-18 22:55:25 +0530
message:
  Merge of fix for bug#13102538 from mysql-5.5.
    ------------------------------------------------------------
    revno: 2875.314.33 [merge]
    committer: Nirbhay Choubey <nirbhay.choubey@oracle.com>
    branch nick: mysql-5.5
    timestamp: Tue 2011-10-18 22:53:05 +0530
    message:
      Merge of fix for bug#13102538 from mysql-5.1.
        ------------------------------------------------------------
        revno: 2661.809.42
        committer: Nirbhay Choubey <nirbhay.choubey@oracle.com>
        branch nick: B13102538-5.1
        timestamp: Tue 2011-10-18 22:47:32 +0530
        message:
          Bug#13102538 : COMPILE ERROR ON SOLARIS WHEN COMPILING
                         WITH LIBEDIT
          
          Libedit won't build on platforms that do not provide
          "sys/cdefs.h".
          
          Removed the inclusion of cdefs.h from all files
          other that sys.h, which includes this file only
          when the header is found while configuring.
------------------------------------------------------------
revno: 3509
committer: Jorgen Loland <jorgen.loland@oracle.com>
branch nick: mysql-trunk
timestamp: Tue 2011-10-18 16:27:48 +0200
message:
  WL#5953: Optimize away useless subquery clauses
  
  Follow-up patch: Show the transformations in optimizer trace
------------------------------------------------------------
revno: 3508
committer: Tor Didriksen <tor.didriksen@oracle.com>
branch nick: trunk-bug12582849purevirtual
timestamp: Tue 2011-10-18 15:45:29 +0200
message:
  Bug#12582849 ASSERTION FAILURE IN __CXA_PURE_VIRTUAL/ITEM_COND::FIX_FIELDS
  
  This is a variant of earlier bugs: 12603457 and 12603141:
  Sometimes Item_field objects are wrapped in Item_ref objects.
  These must be stripped off when saving conditions in in 'prep_where'.
------------------------------------------------------------
revno: 3507 [merge]
committer: chuck.bell@oracle.com
branch nick: mysql-trunk
timestamp: Tue 2011-10-18 08:33:26 -0400
message:
  Merge with BUG#12968815, BUG#12968567 for mysql_plugin client.
    ------------------------------------------------------------
    revno: 2875.314.32
    committer: chuck.bell@oracle.com
    branch nick: mysql-5.5-stage
    timestamp: Mon 2011-10-17 15:33:54 -0400
    message:
      BUG#12968567: mysql_plugin : incorrect return from bootstrap failure
      
      This patch corrects a defect whereby the bootstrap_server() method was
      returning 0 instead of the error code generated. The code has been changed to
      return the correct value returned from the bootstrap command.
    ------------------------------------------------------------
    revno: 2875.314.31
    committer: chuck.bell@oracle.com
    branch nick: mysql-5.5-stage
    timestamp: Mon 2011-10-17 15:30:28 -0400
    message:
      BUG#12968815: mysql_plugin : disable requires plugin name but doesn't use it
      
      This patch corrects a defect in the building of the DELETE commands for
      disabling a plugin whereby only the original plugin data was deleted. If there
      were other plugins, the delete did not remove the rows. The code has been
      changed to remove all rows from the mysql.plugin table that were inserted when
      the plugin was loaded. The test has also been changed to correctly identify if
      all rows have been deleted.
------------------------------------------------------------
revno: 3506
committer: Sneha MOdi<sneha.modi@oracle.com>
branch nick: mysql-trunk
timestamp: Tue 2011-10-18 16:47:44 +0530
message:
  These tests were failing sporadically on push build.
  They have been fixed.
  The variable metadata_table_reference_number showed different outputs for different 
  runs.
------------------------------------------------------------
revno: 3505 [merge]
committer: Jorgen Loland <jorgen.loland@oracle.com>
branch nick: mysql-trunk
timestamp: Tue 2011-10-18 12:23:09 +0200
message:
  Merge WL#5953 into trunk
    ------------------------------------------------------------
    revno: 3398.1.10
    committer: Jorgen Loland <jorgen.loland@oracle.com>
    branch nick: mysql-trunk-remove_subq_order
    timestamp: Fri 2011-08-26 10:16:16 +0200
    message:
      WL#5953 - Optimize away useless subquery clauses
      
      For IN/ALL/ANY/SOME/EXISTS subqueries, the following clauses are 
      meaningless:
      
      * ORDER BY (since we don't support LIMIT in these subqueries)
      * DISTINCT
      * GROUP BY if there is no HAVING clause and no aggregate 
                 functions
      
      This WL detects and optimizes away these useless parts of the
      query during JOIN::prepare()
------------------------------------------------------------
revno: 3504
committer: Raghav Kapoor <raghav.kapoor@oracle.com>
branch nick: mysql-trunk-bug-11757503v2
timestamp: Tue 2011-10-18 14:27:54 +0530
message:
  BUG#11757503 - 49556: ERROR 1005 (HY000): CAN'T CREATE TABLE '#SQL-B7C_3' (ERRNO: -1) 
  
  BACKGROUND:
  When altering some tables it is found in the error log of mysqld:
  Found wrong key definition in #sql-1c54_7; Please do
  "ALTER TABLE '#sql-1c54_7' FORCE " to fix it! 
  mysql> ALTER TABLE '#sql-1c54_7' FORCE ;
  ERROR 1064 (42000): You have an error in your SQL syntax; 
  check the manual that corresponds
  Here There should be backticks around the table name.
  mysql>  ALTER TABLE `#sql-1c54_7` FORCE;
  ERROR 1146 (42S02): Table 'test.#sql-1c54_7' doesn't exist
   
  FIX:
  This bug is fixed by putting backticks around %s in the line
  "Please do \"ALTER TABLE '%s' FORCE\" to fix it!",in file 
  sql/table.cc.Also a test case has been added in file
  archive.test and the corresponding result file
  has also been updated.
------------------------------------------------------------
revno: 3503
committer: kevin.lewis@oracle.com
branch nick: mysql-trunk
timestamp: Mon 2011-10-17 22:58:01 -0500
message:
  Cleanup some comments
------------------------------------------------------------
revno: 3502
committer: Alfranio Correia <alfranio.correia@oracle.com>
branch nick: mysql-trunk
timestamp: Tue 2011-10-18 01:49:55 +0100
message:
  BUG#12402875 - BUG#60902: MYSQLDUMP DOES NOT DUMP THE REPLICATION *_INFO TABLES
  
  Post-push fix.
  
  Fixed failing tests due to error message that was removed.
------------------------------------------------------------
revno: 3501
committer: Jorgen Loland <jorgen.loland@oracle.com>
branch nick: mysql-trunk-13068506
timestamp: Mon 2011-10-17 15:52:27 +0200
message:
  Bug#13068506: QUERY WITH GROUP BY ON NON-AGGR COLUMN RETURNS 
                WRONG RESULT
  
  Consider the query:
  
  SELECT (
    SELECT MAX( t2.i2 )
    FROM t3 RIGHT JOIN t2 ON ( t2.i3 = 2 )
    WHERE t2.i3 <> t1.i1
  ) AS field1
  FROM t1
  GROUP BY field1;
  
  In simplify_joins(), the optimizer checks if the outer join can
  be transformed to an inner join, and if the ON conditions 
  can be transformed to WHERE conditions. This can be done if 
  there are conditions that reject null-extended rows (extensions
  to t3 in the query above)
  
  To check that the inner tables does have a join match for all
  qualifying outer rows, not_null_tables() is called on the 
  conditions and if all inner tables will produce rows the join
  is transformed (see simplify_joins()):
  
  if (conds)
    not_null_tables= conds->not_null_tables();
  ...
  if (!table->outer_join || (used_tables & not_null_tables))
  {
    <transformation happens here>
  }
  
  In the query above, t3 has table->map=1 and t2 has 
  table->map=2. Thus, when processing t2 of the subselect,
  used_tables=1. The WHERE condition is not null-rejecting for
  table t3, so not_null_tables shold not have bit 0 set. But 
  it has.
  
  Item_outer_ref inherits not_null_tables() from Item_ref. 
  Table t1 has table->map=1 in the outer select, so when 
  not_null_tables() is called on the t1.i1 part of the <> 
  condition, the map of t1 is returned. The bug is that
  Item_outer_ref::not_null_tables() returns the map of the outer
  reference in the first place. It should return 0.
------------------------------------------------------------
revno: 3500
committer: Marko M?kel? <marko.makela@oracle.com>
branch nick: mysql-trunk
timestamp: Mon 2011-10-17 14:54:06 +0300
message:
  Fix a memory leak caused by faulty merge of Bug#13006367 fix.
  
  buf_pool_free_instance(): Restore the ha_clear() call.
------------------------------------------------------------
revno: 3499 [merge]
committer: Jon Olav Hauglid <jon.hauglid@oracle.com>
branch nick: mysql-trunk-test
timestamp: Fri 2011-10-14 17:38:24 +0200
message:
  WL#2111 Stored Procedures: Implement GET DIAGNOSTICS
  
  Merged from mysql-trunk-wl2111-new
  Text conflict in sql/sql_yacc.yy
    ------------------------------------------------------------
    revno: 3306.1.15 [merge]
    committer: Jon Olav Hauglid <jon.hauglid@oracle.com>
    branch nick: mysql-trunk-wl2111-new
    timestamp: Thu 2011-10-13 14:33:08 +0200
    message:
      Merge from mysql-trunk to mysql-trunk-wl2111-new
    ------------------------------------------------------------
    revno: 3306.1.14
    committer: Jon Olav Hauglid <jon.hauglid@oracle.com>
    branch nick: mysql-trunk-wl2111-new
    timestamp: Mon 2011-09-19 17:30:54 +0200
    message:
      WL#2111: #11 Update code comments to reflect the
               implementation status of GET DIAGNOSTICS.
    ------------------------------------------------------------
    revno: 3306.1.13
    committer: Jon Olav Hauglid <jon.hauglid@oracle.com>
    branch nick: mysql-trunk-wl2111-new
    timestamp: Wed 2011-08-31 15:52:42 +0200
    message:
      Fix problem with last merge from trunk.
    ------------------------------------------------------------
    revno: 3306.1.12 [merge]
    committer: Jon Olav Hauglid <jon.hauglid@oracle.com>
    branch nick: mysql-trunk-wl2111-new
    timestamp: Mon 2011-08-29 16:33:10 +0200
    message:
      Merge from mysql-trunk to mysql-trunk-wl2111-new
    ------------------------------------------------------------
    revno: 3306.1.11 [merge]
    committer: Jon Olav Hauglid <jon.hauglid@oracle.com>
    branch nick: mysql-trunk-wl2111-new
    timestamp: Wed 2011-08-17 15:16:26 +0200
    message:
      Merge from mysql-trunk to mysql-trunk-wl2111-new
    ------------------------------------------------------------
    revno: 3306.1.10
    committer: Davi Arnaut <davi.arnaut@oracle.com>
    branch nick: 2111-trunk
    timestamp: Fri 2011-07-29 07:22:38 -0300
    message:
      WL#2111: #10 Use default collation utf8_general_ci
      
      Since MySQL's default collation for the UTF8 character set
      is utf8_general_ci, also use it as the default collation for
      the UTF8 string-based diagnostics items.
    ------------------------------------------------------------
    revno: 3306.1.9
    committer: Davi Arnaut <davi.arnaut@oracle.com>
    branch nick: 2111-trunk
    timestamp: Wed 2011-07-27 18:57:33 -0300
    message:
      WL#2111: #9 GET DIAGNOSTICS should not reset the value of ROW_COUNT
      
      Ensure that GET DIAGNOSTICS does not interfere with the value of
      ROW_COUNT. Also, fix the "Invalid condition number" error message
      to not end with a dot.
    ------------------------------------------------------------
    revno: 3306.1.8
    committer: Davi Arnaut <davi.arnaut@oracle.com>
    branch nick: 2111-trunk
    timestamp: Wed 2011-07-27 01:07:44 -0300
    message:
      WL#2111: #8 Address review comments
      
      Ensure that the class value of SQLSTATE is restricted to
      digits or simple latin upper case letters.
      
      Make it clear that although CURRENT is a reserved keyword
      in SQL:2003 (and :2008), it is not reserved in MySQL.
    ------------------------------------------------------------
    revno: 3306.1.7
    committer: Davi Arnaut <davi.arnaut@oracle.com>
    branch nick: 2111-trunk
    timestamp: Fri 2011-07-15 11:41:07 -0300
    message:
      WL#2111: #7 YACC grammar and actions, plus SQL tests.
      
      Implement GET DIAGNOSTICS grammar and associated actions.
      
      The basic format of a get diagnostics statement is:
      
      <get diagnostics statement> ::=
        GET DIAGNOSTICS <diagnostics information>
      
      <diagnostics information> ::=
        <statement information> | <condition information>
      
      <statement information> ::=
        <statement information item> [ { <comma> <statement information item> }... ]
      
      <statement information item> ::=
        <simple target specification> <equals operator> <statement information item name>
      
      <condition information> ::=
        CONDITION <condition number> <condition information item>
          [ { <comma> <condition information item> }... ]
      
      <condition information item> ::=
        <simple target specification> <equals operator> <condition information item name>
      
      <condition number> ::=
        <literal>
        <simple signal expression>
      
      <simple target specification> ::=
        <SQL parameter reference>
        <user-defined variable>
    ------------------------------------------------------------
    revno: 3306.1.6
    committer: Davi Arnaut <davi.arnaut@oracle.com>
    branch nick: 2111-trunk
    timestamp: Fri 2011-07-15 10:26:22 -0300
    message:
      WL#2111: #6 Set CLASS_ORIGIN and SUBCLASS_ORIGIN.
      
      Implement algorithm for determining the values of CLASS_ORIGIN
      and SUBCLASS_ORIGIN:
      
      Let CLASS = the first two letters of RETURNED_SQLSTATE.
      If CLASS[1] is any of: 0 1 2 3 4 A B C D E F G H and CLASS[2]
      is any of: 0-9 A-Z
        then let CLASS_ORIGIN = 'ISO 9075'.
      else
        let CLASS_ORIGIN = 'MySQL'.
      
      Let SUBCLASS = the next three letters of RETURNED_SQLSTATE.
      If CLASS_ORIGIN = 'ISO 9075' or SUBCLASS = '000'
        then let SUBCLASS_ORIGIN = 'ISO 9075'.
      else
        let SUBCLASS_ORIGIN = 'MySQL'.
      
      Almost no errors have CLASS_ORIGIN='MySQL' or
      SUBCLASS_ORIGIN='MySQL'.
    ------------------------------------------------------------
    revno: 3306.1.5
    committer: Davi Arnaut <davi.arnaut@oracle.com>
    branch nick: 2111-trunk
    timestamp: Fri 2011-07-15 10:23:52 -0300
    message:
      WL#2111: #5 Implement GET DIAGNOSTICS condition information.
      
      Implement the ability to retrieve condition information items
      through a GET DIAGNOSTICS statement.
      
      The Condition_information class is a specialization of
      Diagnostics_information that aggregates the condition for which
      information is to be obtained and condition information items.
      Items are represented by the Condition_information_item class.
      
      A condition information item is composed of a name and a member
      function that obtains the value of the named item. The supported
      items match information that is currently available in a condition.
    ------------------------------------------------------------
    revno: 3306.1.4
    committer: Davi Arnaut <davi.arnaut@oracle.com>
    branch nick: 2111-trunk
    timestamp: Fri 2011-07-15 10:04:17 -0300
    message:
      WL#2111: #4 Implement GET DIAGNOSTICS statement information.
      
      Implement the ability to retrieve statement information items
      through a GET DIAGNOSTICS statement.
      
      The Statement_information class is a specialization of
      Diagnostics_information that aggregates statement information items,
      which in turn are represented by the Statement_information_item class.
      
      A statement information item is composed of a name and a member
      function that obtains the value of the named item. Only the NUMBER
      and ROW_COUNT statement information items are supported.
    ------------------------------------------------------------
    revno: 3306.1.3
    committer: Davi Arnaut <davi.arnaut@oracle.com>
    branch nick: 2111-trunk
    timestamp: Fri 2011-07-15 09:56:32 -0300
    message:
      WL#2111: #3 Implement GET DIAGNOSTICS command.
      
      Introduce a set of classes to represent the skeleton of a GET
      DIAGNOSTICS command.
      
      The Sql_cmd_get_diagnostics class represents a GET DIAGNOSTICS
      statement. The Diagnostics_information class represents diagnostics
      information to be obtained through a GET DIAGNOSTICS command. The
      Diagnostics_information_item class represents a single diagnostics
      information item and is used to associate a specific diagnostics
      information item to a target variable.
      
      Within the execution context of the GET DIAGNOSTICS command,
      implement the required special error handling. A GET DIAGNOSTICS
      statement only fails if there are fatal errors, non-fatal errors
      are simply appended to the message list.
    ------------------------------------------------------------
    revno: 3306.1.2
    committer: Davi Arnaut <davi.arnaut@oracle.com>
    branch nick: 2111-trunk
    timestamp: Fri 2011-07-15 09:29:44 -0300
    message:
      WL#2111: #2 Consolidate code to create an object to represent
                  a SP variable in the Item-hierarchy.
      
      Consolidate into a function some duplicated code related to
      creating an Item_splocal object to represent a SP variable in
      the Item-hierarchy. This will also be used in the parsing of
      GET DIAGNOSTICS as statement information items can be assigned
      to variables.
    ------------------------------------------------------------
    revno: 3306.1.1
    committer: Davi Arnaut <davi.arnaut@oracle.com>
    branch nick: 2111-trunk
    timestamp: Fri 2011-07-15 09:27:50 -0300
    message:
      WL#2111: #1 Add ROW_COUNT as a non-reserved keyword.
      
      Add ROW_COUNT as a non-reserved keyword, to be used as part of
      the grammar for GET DIAGNOSTICS. Since the name ROW_COUNT is
      already used to name a regular (native) function, the parser
      needs to be adjusted to interpret ROW_COUNT() as a function
      call using a non-reserved keyword.
------------------------------------------------------------
revno: 3498
committer: Bjorn Munch <bjorn.munch@oracle.com>
branch nick: main-tr
timestamp: Fri 2011-10-14 17:13:18 +0200
message:
  Bug #13016347 FAILURE AT CHECK-WARNINGS FOR WINDOWS ON DAILY-TRUNK
    Give up solving the problem completely
    Let it happen, but then catch the case based on output,
      and pretend we did get exit code 62
------------------------------------------------------------
revno: 3497 [merge]
committer: Jon Olav Hauglid <jon.hauglid@oracle.com>
branch nick: mysql-trunk-test
timestamp: Fri 2011-10-14 17:04:41 +0200
message:
  WL#5986 Stored programs: Make condition handlers closer to the standard
  
  Merged from mysql-trunk-alik.
    ------------------------------------------------------------
    revno: 3398.2.29
    committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
    branch nick: mysql-trunk-alik
    timestamp: Tue 2011-10-11 19:01:02 +0400
    message:
      Review fixes for Bug 13059316 (ASSERTION FAILURE IN SP_RCONTEXT.CC):
        - add another test case
        - polish comment
        - mention the bug number in the test case
    ------------------------------------------------------------
    revno: 3398.2.28
    committer: Jon Olav Hauglid <jon.hauglid@oracle.com>
    branch nick: mysql-trunk-alik
    timestamp: Tue 2011-10-04 11:07:20 +0200
    message:
      WL#5986: Stored programs: Make condition handlers closer to the standard.
      
      Fix assertion failure if a variable declaration raises a warning
      and a warning handler is declared. The assertion was triggered
      because the parser thought the handler should be activated, yet
      at runtime the handler declaration had not been processed yet.
      
      This patch fixes the assertion by not activating the handler in
      such cases (this matches the current 5.5/5.6 behavior).
      
      Test case added to sp-error.test.
    ------------------------------------------------------------
    revno: 3398.2.27 [merge]
    committer: Jon Olav Hauglid <jon.hauglid@oracle.com>
    branch nick: mysql-trunk-alik
    timestamp: Tue 2011-09-20 15:04:00 +0200
    message:
      Merge from mysql-trunk to mysql-trunk-alik.
      No conflicts.
    ------------------------------------------------------------
    revno: 3398.2.26
    committer: Jon Olav Hauglid <jon.hauglid@oracle.com>
    branch nick: mysql-trunk-alik
    timestamp: Tue 2011-09-20 14:54:31 +0200
    message:
      WL#5986: Stored programs: Make condition handlers closer to the standard.
      
      Polishing patch:
      - Use explicit placement new. Remove the use of
        set_n_backup_active_arena() and restore_active_arena()
        where possible.
      - Use mem_roots rather than heap for sp_handler_entry,
        Sql_condition_info and Handler_call_frame.
      - Remove bogus arena juggling in handle_sql_condition().
      - Reformat and update comments.
    ------------------------------------------------------------
    revno: 3398.2.25
    committer: Jon Olav Hauglid <jon.hauglid@oracle.com>
    branch nick: mysql-trunk-alik
    timestamp: Tue 2011-09-20 14:25:40 +0200
    message:
      WL#5986: Stored programs: Make condition handlers closer to the standard.
      
      This patch changes handle resolution so that if a statement
      generated more than one warning, the last listed warning
      is handled rather than the first listed warning.
      This is done as MySQL shows the most substantial warning last.
    ------------------------------------------------------------
    revno: 3398.2.24
    committer: Jon Olav Hauglid <jon.hauglid@oracle.com>
    branch nick: mysql-trunk-alik
    timestamp: Tue 2011-09-20 14:13:07 +0200
    message:
      WL#5986: Stored programs: make SQL-handlers closer to the standard).
      
      This patch changes how conditions are removed from the diagnostics
      area when handlers are activated.
      
      Before, the handled condition was removed when the handler was
      activated. Now, any active conditions are marked when the
      handler is activated and then later removed when the handler
      exits. This allows diagnostics statements (e.g. SHOW WARNINGS)
      to inspect these conditions inside the handler. (Normal diagnostic
      area rules still apply, so the diagnostic statement will have
      to be the first statement in the handler.)
      
      Note that this does not apply to RESIGNAL with a condition value.
      In this case, the handled conditions will be kept. (This matches
      existing behavior.)
    ------------------------------------------------------------
    revno: 3398.2.23
    committer: Jon Olav Hauglid <jon.hauglid@oracle.com>
    branch nick: mysql-trunk-alik
    timestamp: Mon 2011-08-29 17:54:07 +0200
    message:
      WL#5986: Stored programs: make SQL-handlers closer to the standard).
      
      Rename sp_pcontext::push_X functions to add_X for which
      there are no matching pop_X functions and no stack semantics.
    ------------------------------------------------------------
    revno: 3398.2.22
    committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
    branch nick: mysql-trunk-alik
    timestamp: Mon 2011-08-29 18:20:23 +0400
    message:
      WL#5986: Stored programs: make SQL-handlers closer to the standard).
      
      Fixing comments in sp_rcontext.h / sp_rcontext.cc files.
    ------------------------------------------------------------
    revno: 3398.2.21
    committer: Jon Olav Hauglid <jon.hauglid@oracle.com>
    branch nick: mysql-trunk-alik
    timestamp: Mon 2011-08-29 13:33:04 +0200
    message:
      WL#5986: Stored programs: make SQL-handlers closer to the standard).
      
      Cleanup/polishing patch:
        - Use class instead of struct
        - Use constructors to initialization
        - Inherit from Sql_alloc and allocate using new rather than
          sql_alloc or new (without Sql_alloc)
        - Use THD::alloc directly rather than sql_alloc() if possible
    ------------------------------------------------------------
    revno: 3398.2.20
    committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
    branch nick: mysql-trunk-alik.tmp
    timestamp: Mon 2011-08-29 15:06:14 +0400
    message:
      WL#5986: Stored programs: make SQL-handlers closer to the standard).
      
      Cleanup/polishing patch:
        - make sp_pcontext operations accept LEX_STRING (by value)
          instead of (LEX_STRING *);
        - change sp_pcontext::find_cursor() so that it just returns
          (LEX_STRING *) instead of returning a flag and setting
          out-parameter;
        - change sp_label::name to be of type LEX_STRING
          instead of (char *).
    ------------------------------------------------------------
    revno: 3398.2.19
    committer: Jon Olav Hauglid <jon.hauglid@oracle.com>
    branch nick: mysql-trunk-alik
    timestamp: Fri 2011-08-26 15:16:23 +0200
    message:
      WL#5986: Stored programs: make SQL-handlers closer to the standard).
      
      Implementation of code review comments:
      - Remove sp_pcontext::get_num_handlers()
      - Combine handle_sql_condition() and activate_handler()
      - Simplify handle_sql_condition() logic
      - Change reinterpret_cast to static_cast
      - Rename sp_pcontext::dflt to ::default_value
      - Fix whitespace issues
      - Change Sql_condition_info() to take Sql_condition argument
      - Minor code comment adjustments
    ------------------------------------------------------------
    revno: 3398.2.18
    committer: Jon Olav Hauglid <jon.hauglid@oracle.com>
    branch nick: mysql-trunk-alik2
    timestamp: Fri 2011-08-26 14:46:32 +0200
    message:
      WL#5986: Stored programs: make SQL-handlers closer to the standard).
      
      Fix valgrind issue - delete sp_handler object in the
      sp_pcontext destructor.
    ------------------------------------------------------------
    revno: 3398.2.17
    committer: Jon Olav Hauglid <jon.hauglid@oracle.com>
    branch nick: mysql-trunk-alik
    timestamp: Thu 2011-08-25 17:16:15 +0200
    message:
      WL#5986: Stored programs: make SQL-handlers closer to the standard).
      
      Updated comments for sp_pcontext
      Removal of some default parameter values.
      
      Commit on behalf of Alik.
    ------------------------------------------------------------
    revno: 3398.2.16
    committer: Jon Olav Hauglid <jon.hauglid@oracle.com>
    branch nick: mysql-trunk-alik
    timestamp: Thu 2011-08-25 16:31:40 +0200
    message:
      WL#5986: Stored programs: make SQL-handlers closer to the standard).
      
      Polish of sp_pcontext and sp_rcontext:
      - Removed dead code
      - Removed trailing whitespace
      - Removed unneeded 'inline' keyword
      - Increased usage of 'const'
      - Made more functions/variables private
      - Moved Select_Fetch_into_spvars class into sp_cursor
      - Inlined additional functions
      - More consistent use of empty lines
      - Rewrapped function prototypes
    ------------------------------------------------------------
    revno: 3398.2.15
    committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
    branch nick: mysql-trunk-alik
    timestamp: Thu 2011-08-25 17:51:44 +0400
    message:
      WL#5986: Stored programs: make SQL-handlers closer to the standard).
      
      Patch for Bug#12731619: NESTED SP HANDLERS CAN TRIGGER ASSERTION.
        
      The thing is that runtime (execution) call stack can be deeper than the one
      during the parsing stage. I.e. runtime call stack can be deeper than number of
      nested BEGIN ... END blocks.
      
      Before the patch, the code was written in an assumption, that depth of runtime
      call stack can be calculated at parse time. That assumption led to a crash (when
      it's not true).
      
      The user visible problem was that the server might crash when
      executing a stored program containing nested SQL-handlers.
      During parsing, the maximum nesting was determined and
      used to allocate memory for handler invocations. However, in
      some cases this maximum depth could not be determined correctly.
      This could cause the server to crash when the routine was executed.
      
      The following things have been done in the patch:
        - Introduce Sql_condition_info to store 4 needed attributes
          from MYSQL_ERROR to report raised_condition;
        - Restructure find_handler() logic;
        - Get rid of static arrays for sp_rcontext::m_handlers and
          sp_rcontext::m_raised_condition;
        - Get rid of static handler-call-stack in sp_rcontext.
          Use dynamic call-stack.
        - Move deinitialization from sp_pcontext::destroy() to
          sp_pcontext destructor;
        - Remove sp_pcontext::destroy();
        - delete sp_pcontext instance in sp_head destructor;
        - Get rid of two-steps sp_rcontext initialization.
          Introduce static sp_rcontext::create() as a single point
          to construct a valid sp_rcontext instance.
      
      sp_rcontext cleanup / polishing:
        - use Bounds_checked_array template to check access to "raw" arrays.
    ------------------------------------------------------------
    revno: 3398.2.14
    committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
    branch nick: mysql-trunk-alik
    timestamp: Thu 2011-08-25 10:41:21 +0400
    message:
      WL#5986: Stored programs: make SQL-handlers closer to the standard).
      
      Typo fix: sp_condition_value is a class, not a struct.
    ------------------------------------------------------------
    revno: 3398.2.13
    committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
    branch nick: mysql-trunk-alik-38806.2
    timestamp: Wed 2011-08-24 20:00:32 +0400
    message:
      WL#5986: Stored programs: make SQL-handlers closer to the standard).
      
      sp_context cleanup / polishing:
        - remove sp_pcontext::add_handlers()
        - remove sp_pcontext::m_context_handlers counter
        - introduce sp_pcontext::get_num_handlers() to get
          number of handlers in an instance of sp_pcontext.
    ------------------------------------------------------------
    revno: 3398.2.12
    committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
    branch nick: mysql-trunk-alik-38806.2
    timestamp: Wed 2011-08-24 19:53:40 +0400
    message:
      WL#5986: Stored programs: make SQL-handlers closer to the standard).
      
      SP polishing / cleanup:
        - sp_pcontext: use Dynamic_array<T> instead of DYNAMIC_ARRAY;
        - sp_pcontext: use Dynamic_array<T> instead of List for m_children;
        - remove sp_handler::UNDO, sp_handler::NONE enum values, because
          they are actually unsupported and unused;
    ------------------------------------------------------------
    revno: 3398.2.11
    committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
    branch nick: mysql-trunk-alik-38806.2
    timestamp: Wed 2011-08-24 19:33:15 +0400
    message:
      WL#5986: Stored programs: make SQL-handlers closer to the standard).
      
      Patch for the following bugs:
        - Bug#11763171: 55852 - Possibly inappropriate handler activation.
        - Bug#11749343: 38806 - Wrong scope for SQL HANDLERS in SP.
      
      The problem was that SQL-handler resolution was done in a hackish way, which
      has nothing do with the SQL Standard requirements.
      
      The following terms are used below:
        - "handler" is an alias for "SQL-handler";
        - "scope" is an alias for "parsing scope", which is in turn an alias for
          "BEGIN .. END block";
        - "parsing context" -- an instance of sp_pcontext class;
        - "runtime context" -- an instance of sp_rcontext class;
      
      SQL-handlers were resolved using stack of stored program calls (runtime context
      stack). Information about scopes is not preserved in the runtime context. Thus,
      there was no way to ensure proper SQL-handler resolution if there were more
      than one scope.
      
      In other words, user-visible problem was that SQL-handlers were not properly
      chosen if there were several BEGIN .. END blocks with SQL-handlers inside them.
      
      For more information about the standard way to resolve handlers, see WL#5986
      and the mentioned bugs.
      
      The general idea of the patch is to resolve handlers in runtime using the
      parsing context of the instruction that raised SQL-condition(s).
      
      Here are some background information and steps that describes the patch:
      
        - An SP instruction has a pointer to its parsing context. So, it's possible
          to get instruction's parsing context when instruction raised
          SQL-condition(s).
      
        - A method to find the right handler should be moved to sp_pcontext class.
          This method should firstly look through the handlers declared in the
          current parsing context, then call the parent parsing context.
      
        - When an appropriate SQL-handler is found, we need to find its entering IP
          (instruction pointer). I.e. we need to get the pointer to the first
          SP-instruction of that handler. This information is available only in the
          runtime context.
      
        - Runtime contexts may has pointers to data in parsing contexts, but not vice
          versa.
      
        - Thus, we need to establish a link between a handler in the parsing context,
          and that handler in the runtime context. That means, we need some
          identification of handlers.
      
        - Before this patch, there has been no class/object to store information about
          declared SQL-handler. SQL-handlers were represented by SQL-condition-values.
      
        - It is not possible to identify handlers by theis condition values, because
          there might be several handlers using the same condition value. It happens,
          when there is a named condition and a few handlers for that condition in
          different scopes.
      
        - This patch introduces sp_handler class, which has two attributes:
          - handler type (only EXIT and CONTINUE are now supported);
          - list of condition values, which are caugh by this handler;
      
        - The parsing context stores an array of sp_handler instances.
      
        - The runtime context has a map between a pointer to sp_handler-object, and
          its entering instruction pointer. That map is filled/refreshed by means of
          hpush/hpop instructions.
      
      Programming-wise, the following things have been changed:
      
        - sp_active_handler_t has been removed, sp_rcontext::m_in_handlers[]
          is now an array of uint's.
      
        - sp.test has been fixed because it contained tests for wrong
          behaviour.
      
        - new tests have been added to sp-error.test
      
        - a new variant of sp_pcontext::find_handler() has been introduced,
          which does all the job to find appropriate SQL-handler for the
          given SQL-condition in the current frame/scope.
      
        - "active" handlers (or handlers "in use") are no longer needed for
          handler resolution, because it was a hackish (and incorrect) attempt
          to implement stacked handler resolution. The scoped resolution rules
          guarantee that handlers will not be activated recursively.
      
      SP-code polishing/cleanup:
      
        - remove entering-instruction-pointer from sp_handler, use it in sp_pcontext
          to store handler definitions;
      
        - introduce private sp_rcontext::sp_handler_entry, which contains entering ip
          for a handler;
      
        - get rid of macros SP_HANDLER_xxx, replace them by
          sp_handler::enum_type enum;
      
        - a few other renames;
    ------------------------------------------------------------
    revno: 3398.2.10
    committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
    branch nick: mysql-trunk-alik-38806.2
    timestamp: Wed 2011-08-24 14:37:10 +0400
    message:
      WL#5986: Stored programs: make SQL-handlers closer to the standard).
      
      sql_error polishing/cleanup:
        - replace the following macros by corresponding inline functions:
          - IS_WARNING_CONDITION -> is_sqlstate_warning()
          - IS_NOT_FOUND_CONDITION -> is_sqlstate_not_found()
          - IS_EXCEPTION_CONDITION -> is_sqlstate_exception()
        - update is_sqlstate_completion() to be consistent with
          the other prototypes.
    ------------------------------------------------------------
    revno: 3398.2.9
    committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
    branch nick: mysql-trunk-alik-38806.2
    timestamp: Wed 2011-08-24 14:31:41 +0400
    message:
      WL#5986: Stored programs: make SQL-handlers closer to the standard).
      
      The patch changes the way how SQL handlers are found and activated.
      
      We used to search handlers recursively (from the current scope up to the top
      one). That was needed because a search for handlers was done right when an SQL
      condition occurs. After patch for Bug 23032 the search for SQL handlers happens
      after SQL statement completes.
      
      That means, there is no need to do a recursive search now:
        - if there are warnings, they are handled by SQL handlers within
          the current scope only;
        - if there is an error, it is propagated to the outer scope.
    ------------------------------------------------------------
    revno: 3398.2.8
    committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
    branch nick: mysql-trunk-alik-38806.2
    timestamp: Wed 2011-08-24 14:06:11 +0400
    message:
      WL#5986: Stored programs: make SQL-handlers closer to the standard).
      
      sp_pcontext polishing/cleanup:
        - Rename sp_pcontext::m_label to sp_pcontext::m_labels
          to reflect that it is an array.
    ------------------------------------------------------------
    revno: 3398.2.7
    committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
    branch nick: mysql-trunk-alik-38806.2
    timestamp: Wed 2011-08-24 14:05:40 +0400
    message:
      WL#5986: Stored programs: make SQL-handlers closer to the standard).
      
      sp_pcontext polishing/cleanup:
        - Rename sp_condition_value::Type to sp_condition_value::enum_type
          to be in line with the coding style.
    ------------------------------------------------------------
    revno: 3398.2.6
    committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
    branch nick: mysql-trunk-alik-38806.2
    timestamp: Wed 2011-08-24 14:04:43 +0400
    message:
      WL#5986: Stored programs: make SQL-handlers closer to the standard).
      
      sp_head polishing/cleanup:
        - Move initialization of sp_instr_hpush_jump::m_frame to
          ctor, because this attribute is debug-only implementation
          detail of this class.
    ------------------------------------------------------------
    revno: 3398.2.5
    committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
    branch nick: mysql-trunk-alik-38806.2
    timestamp: Wed 2011-08-24 14:04:07 +0400
    message:
      WL#5986: Stored programs: make SQL-handlers closer to the standard).
      
      sp_rcontext polishing/cleanup:
        - Rename sp_rcontext::m_handler to m_handlers to reflect that
          this attribute is an array.
    ------------------------------------------------------------
    revno: 3398.2.4
    committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
    branch nick: mysql-trunk-alik-38806.2
    timestamp: Wed 2011-08-24 14:03:38 +0400
    message:
      WL#5986: Stored programs: make SQL-handlers closer to the standard).
      
      sp_head polishing/cleanup:
        - Rename sp_instr_hpush_jump::m_type to
          sp_instr_hpush_jump::m_handler_type
    ------------------------------------------------------------
    revno: 3398.2.3
    committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
    branch nick: mysql-trunk-alik-38806.2
    timestamp: Wed 2011-08-24 14:02:48 +0400
    message:
      WL#5986: Stored programs: make SQL-handlers closer to the standard).
      
      Move sp_cond_check() to sql_error.h, split and rename it
      to is_sqlstate_valid() & is_sqlstate_completion() because
      it has no SP-specificity.
    ------------------------------------------------------------
    revno: 3398.2.2
    committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
    branch nick: mysql-trunk-alik-38806.2
    timestamp: Wed 2011-08-24 13:41:15 +0400
    message:
      WL#5986: Stored programs: make SQL-handlers closer to the standard).
      Cleanups:
      
        - sql_signal.cc:
          Remove unnecessary code. This code is not needed because of two facts:
            1. calling of copy_opt_attributes() is not needed here, because
               raised_condition() does not return an Sql_condition with
               opt-attributes set
            2. copy_opt_attributes() is done in Warning_info::push_warning(), called
               here.
      
        - sql_error.cc:
          Update comment.
      
        - sql_class.h:
          Make THD::handle_condition private and non-virtual
          because it is a detail of THD implementation.
    ------------------------------------------------------------
    revno: 3398.2.1
    committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
    branch nick: mysql-trunk-alik-38806.2
    timestamp: Wed 2011-08-24 13:31:44 +0400
    message:
      WL#5986: Stored programs: make SQL-handlers closer to the standard).
      sp_pcontext polishing/cleanup:
        - Moving common part of sp_pcontext constructors to a separate function.
------------------------------------------------------------
revno: 3496
committer: Jon Olav Hauglid <jon.hauglid@oracle.com>
branch nick: mysql-trunk-test
timestamp: Fri 2011-10-14 16:45:15 +0200
message:
  This patch fixes a compiler error reported by gcc 4.6.1.
    pfs_instr.cc:1476:47: error: cast to pointer from
    integer of different size
------------------------------------------------------------
revno: 3495 [merge]
committer: Alfranio Correia <alfranio.correia@oracle.com>
branch nick: mysql-trunk
timestamp: Fri 2011-10-14 14:37:57 +0100
message:
  merge 5.5 --> mysql-trunk
    ------------------------------------------------------------
    revno: 2875.314.30
    committer: Alfranio Correia <alfranio.correia@oracle.com>
    branch nick: mysql-5.5
    timestamp: Fri 2011-10-14 14:24:15 +0100
    message:
      Introduced this code to make the gcc 4.6.1 compiler happy. When
      warnings are converted to errors, the compiler complains about
      the fact that binlog_can_be_corrupted is defined but never used.
      
      We need to check if this is a dead code or if someone removed any
      code by mistake.
------------------------------------------------------------
revno: 3494
committer: Luis Soares <luis.soares@oracle.com>
branch nick: mysql-trunk
timestamp: Fri 2011-10-14 02:25:12 +0100
message:
  BUG#11747887
  
  Reverting patch, which created a few failures in PB2. Needs some
  extra work.
------------------------------------------------------------
revno: 3493 [merge]
committer: Nirbhay Choubey <nirbhay.choubey@oracle.com>
branch nick: mysql-trunk
timestamp: Fri 2011-10-14 01:27:21 +0530
message:
  Merge of changeset of WL#5945 from mysql-5.5.
    ------------------------------------------------------------
    revno: 2875.314.29 [merge]
    committer: Nirbhay Choubey <nirbhay.choubey@oracle.com>
    branch nick: mysql-5.5
    timestamp: Fri 2011-10-14 01:17:46 +0530
    message:
      Merge of changeset of WL#5945 from mysql-5.1.
        ------------------------------------------------------------
        revno: 2661.809.41
        committer: Nirbhay Choubey <nirbhay.choubey@oracle.com>
        branch nick: mysql-5.1
        timestamp: Fri 2011-10-14 01:03:25 +0530
        message:
          WL#5945 : Improve libedit library
          
          Updated libedit library.
------------------------------------------------------------
revno: 3492 [merge]
committer: Alfranio Correia <alfranio.correia@oracle.com>
branch nick: mysql-trunk-merge
timestamp: Thu 2011-10-13 15:53:48 +0100
message:
  merge mysql-trunk (local) --> mysql-trunk
    ------------------------------------------------------------
    revno: 3488.1.1
    committer: Alfranio Correia <alfranio.correia@oracle.com>
    branch nick: mysql-trunk
    timestamp: Thu 2011-10-13 15:01:50 +0100
    message:
      BUG#12402875 - BUG#60902: MYSQLDUMP DOES NOT DUMP THE REPLICATION *_INFO TABLES
      
      When WL#2775 was developed we decided to follow the pattern used by
      log tables where direct updates are forbidden. The idea was to later
      on provide users with the necessary commands to execute maintenance
      tasks against the replication tables such as changing the engine in
      use or dumping data. 
      
      However, after pushing the WL#2775, we have realized that this would
      unnecessarily duplicate code, i.e. functionality.
      
      So, in this patch, we revert the code that follows the behavior
      adopted by log tables and allow any sort of statement to be executed
      against the replication tables.
      
      This change causes a side effect that it is worth noticing. It has
      made the relay-log-info file or not-transactional tables being updated
      optimistically prior to committing an user transaction that is being
      executed. This may lead to data loss if a crash happens as the user
      transaction can be rolled back but it won't be re-applied automatically
      upon restart.
      
      This patch also makes sure that the server fails gracefully if some
      unexpected changes are executed against the tables. For example, if
      some columns are dropped.
------------------------------------------------------------
revno: 3491
committer: Andrei Elkin <andrei.elkin@oracle.com>
branch nick: wl5569-trunk-bug13033076_rpl_parallel_ddl
timestamp: Thu 2011-10-13 15:12:19 +0300
message:
  Bug#13033076 - OCCASIONAL CRASH OF RPL.RPL_PARALLEL_DDL
  
  refining the test once more to print out all files in db dir right
  befre the db is drop-ed.
------------------------------------------------------------
revno: 3490 [merge]
committer: Tor Didriksen <tor.didriksen@oracle.com>
branch nick: trunk-merge
timestamp: Thu 2011-10-13 09:54:52 +0200
message:
  merge opt-team => trunk
    ------------------------------------------------------------
    revno: 2876.249.413 [merge]
    committer: Tor Didriksen <tor.didriksen@oracle.com>
    branch nick: next-mr-opt-team
    timestamp: Wed 2011-10-12 15:32:10 +0200
    message:
      Merge opt-backporting => opt-team
        ------------------------------------------------------------
        revno: 2876.339.172
        committer: Roy Lyseng <roy.lyseng@oracle.com>
        branch nick: mysql-sb4
        timestamp: Fri 2011-10-07 14:44:17 +0200
        message:
          Bug#12711441: crash in item_ident::fix_after_pullout on subquery...
          
          The problem occurs during semi-join transformation of
          a query involving the following query blocks (select_lex objects):
          
          +-------+
          | Outer |
          +-------+ 
              |       +--------+
              +------>| Middle |
                      +--------+
                          |       +--------+
                          +------>| Inner  |
                                  +--------+
          
          The Middle query block is part of an IN predicate and is merged
          into the Outer query block. The Inner query block is part of a
          >= SOME quantified comparison predicate which cannot be transformed.
          
          When attempting to apply the function fix_after_pullout() on a field
          of type Item_direct_view_ref which is also an outer reference, the
          program crashes. The field is referenced in the Inner query block and
          it originates from a view that is referenced in the Middle query block.
          
          The reason for the crash is that the Item_direct_view_ref object
          representing the view field v1.col_varchar_key is created with wrong
          name resolution context information. It is created with a context
          representing the Middle query block, but an equivalent table field
          would have been created with a context representing the Inner query
          block. dependent_from is then set to the same query block as the
          name resolution context points to, which is an illegal situation
          that Item_ident::fix_after_pullout() is not trained to handle.
          
          The solution seems to be to add proper name resolution context
          information to the Item_direct_view_ref constructor.
          
          Notice that the inner ref object of Item_direct_view_ref object
          references the query block where the view is referenced in the FROM
          clause, hence looking in the inner object will fail to get a proper
          name resolution context for the view field.
          
          mysql-test/include/subquery_sj.inc
            Added test case for bug#12711441
          
          mysql-test/r/subquery_sj_all.result
          mysql-test/r/subquery_sj_all_bka.result
          mysql-test/r/subquery_sj_all_bka_nixbnl.result
          mysql-test/r/subquery_sj_all_bkaunique.result
          mysql-test/r/subquery_sj_dupsweed.result
          mysql-test/r/subquery_sj_dupsweed_bka.result
          mysql-test/r/subquery_sj_dupsweed_bka_nixbnl.result
          mysql-test/r/subquery_sj_dupsweed_bkaunique.result
          mysql-test/r/subquery_sj_firstmatch.result
          mysql-test/r/subquery_sj_firstmatch_bka.result
          mysql-test/r/subquery_sj_firstmatch_bka_nixbnl.result
          mysql-test/r/subquery_sj_firstmatch_bkaunique.result
          mysql-test/r/subquery_sj_loosescan.result
          mysql-test/r/subquery_sj_loosescan_bka.result
          mysql-test/r/subquery_sj_loosescan_bka_nixbnl.result
          mysql-test/r/subquery_sj_loosescan_bkaunique.result
          mysql-test/r/subquery_sj_mat.result
          mysql-test/r/subquery_sj_mat_bka.result
          mysql-test/r/subquery_sj_mat_bka_nixbnl.result
          mysql-test/r/subquery_sj_mat_bkaunique.result
          mysql-test/r/subquery_sj_mat_nosj.result
          mysql-test/r/subquery_sj_none.result
          mysql-test/r/subquery_sj_none_bka.result
          mysql-test/r/subquery_sj_none_bka_nixbnl.result
          mysql-test/r/subquery_sj_none_bkaunique.result
            Added test case results for bug#12711441
          
          sql/item.cc
            Added an invariant check to Item_ident::fix_after_pullout.
            Added Name_resolution_context argument to Item_ref constructor.
            Deleted redundant Item_ident and Item_ref constructors.
          
          sql/item.h
            Added Name_resolution_context arguments to constructors for
            Item_ident, Item_ref, Item_direct_ref and Item_direct_view_ref
            Deleted redundant Item_ident, Item_ref, Item_direct_ref and
            Item_direct_view_ref constructors.
          
          sql/table.cc
            Added Name_resolution_context argument when constructing
            Item_direct_view_ref objects.
          
          sql/table.h
            Deleted function declaration after declaring function static.
        ------------------------------------------------------------
        revno: 2876.339.171
        committer: Roy Lyseng <roy.lyseng@oracle.com>
        branch nick: mysql-sb7
        timestamp: Thu 2011-10-06 12:58:30 +0200
        message:
          Bug#12867557: Valgrind: conditional jump/move at key_cmp
          
          This problem may occur when starting a JOIN execution for the second
          and subsequent time, such as when a subquery is evaluated in the
          context of an UPDATE statement to evaluate whether a row qualifies
          to be updated. The problem may also appear only in the case of a
          loosescan semi-join strategy. When the previous execution had
          qualifying rows, the found_match flag may be left with value TRUE,
          so that we erroneously assume that there is a row in loosescan_buf
          that we may compare the current row with.
          
          The problem is fixed by clearing the found_match flag when entering a
          new join_tab level within sub_select().
          
          mysql-test/include/subquery_sj.inc
            Added test case for bug#12867557.
          
          mysql-test/r/subquery_sj_all.result
          mysql-test/r/subquery_sj_all_bka.result
          mysql-test/r/subquery_sj_all_bka_nixbnl.result
          mysql-test/r/subquery_sj_all_bkaunique.result
          mysql-test/r/subquery_sj_dupsweed.result
          mysql-test/r/subquery_sj_dupsweed_bka.result
          mysql-test/r/subquery_sj_dupsweed_bka_nixbnl.result
          mysql-test/r/subquery_sj_dupsweed_bkaunique.result
          mysql-test/r/subquery_sj_firstmatch.result
          mysql-test/r/subquery_sj_firstmatch_bka.result
          mysql-test/r/subquery_sj_firstmatch_bka_nixbnl.result
          mysql-test/r/subquery_sj_firstmatch_bkaunique.result
          mysql-test/r/subquery_sj_loosescan.result
          mysql-test/r/subquery_sj_loosescan_bka.result
          mysql-test/r/subquery_sj_loosescan_bka_nixbnl.result
          mysql-test/r/subquery_sj_loosescan_bkaunique.result
          mysql-test/r/subquery_sj_mat.result
          mysql-test/r/subquery_sj_mat_bka.result
          mysql-test/r/subquery_sj_mat_bka_nixbnl.result
          mysql-test/r/subquery_sj_mat_bkaunique.result
          mysql-test/r/subquery_sj_mat_nosj.result
          mysql-test/r/subquery_sj_none.result
          mysql-test/r/subquery_sj_none_bka.result
          mysql-test/r/subquery_sj_none_bka_nixbnl.result
          mysql-test/r/subquery_sj_none_bkaunique.result
            Added test case results for bug#12867557.
          
          sql/sql_select.cc
            In sub_select(), added initialization of loosescan match flag when
            entering a new join_tab level.
        ------------------------------------------------------------
        revno: 2876.339.170
        committer: Tor Didriksen <tor.didriksen@oracle.com>
        branch nick: next-mr-opt-backporting
        timestamp: Wed 2011-10-05 10:22:01 +0200
        message:
          New test results after merge from trunk
    ------------------------------------------------------------
    revno: 2876.249.412 [merge]
    committer: Tor Didriksen <tor.didriksen@oracle.com>
    branch nick: next-mr-opt-team
    timestamp: Wed 2011-10-12 14:09:14 +0200
    message:
      NULL merge opt-backporting => opt-team
        ------------------------------------------------------------
        revno: 2876.339.169 [merge]
        committer: Tor Didriksen <tor.didriksen@oracle.com>
        branch nick: next-mr-opt-backporting
        timestamp: Wed 2011-10-05 10:18:36 +0200
        message:
          Merge trunk => opt-backporting
        ------------------------------------------------------------
        revno: 2876.339.168 [merge]
        committer: Tor Didriksen <tor.didriksen@oracle.com>
        branch nick: next-mr-opt-backporting
        timestamp: Wed 2011-10-05 10:04:25 +0200
        message:
          NULL merge trunk => opt-backporting
        ------------------------------------------------------------
        revno: 2876.339.167 [merge]
        committer: Tor Didriksen <tor.didriksen@oracle.com>
        branch nick: next-mr-opt-backporting
        timestamp: Wed 2011-10-05 10:00:45 +0200
        message:
          Merge trunk => opt-backporting
    ------------------------------------------------------------
    revno: 2876.249.411 [merge]
    committer: Tor Didriksen <tor.didriksen@oracle.com>
    branch nick: next-mr-opt-team
    timestamp: Wed 2011-10-05 10:18:04 +0200
    message:
      Merge trunk => opt-team
    ------------------------------------------------------------
    revno: 2876.249.410 [merge]
    committer: Tor Didriksen <tor.didriksen@oracle.com>
    branch nick: next-mr-opt-team
    timestamp: Wed 2011-10-05 10:04:47 +0200
    message:
      empty merge trunk => opt-team
    ------------------------------------------------------------
    revno: 2876.249.409 [merge]
    committer: Tor Didriksen <tor.didriksen@oracle.com>
    branch nick: next-mr-opt-team
    timestamp: Wed 2011-10-05 10:01:10 +0200
    message:
      Merge trunk => opt-team
------------------------------------------------------------
revno: 3489
committer: Andrei Elkin <andrei.elkin@oracle.com>
branch nick: wl5569-trunk-bug13033076_rpl_parallel_ddl
timestamp: Wed 2011-10-12 22:23:12 +0300
message:
  Bug#13033076 - OCCASIONAL CRASH OF RPL.RPL_PARALLEL_DDL
  
  This is an exploratory patch containing pure test's changes
  to get some info out of pb runs.
  The failure is not necessary crash and ends on non-wins with 
  errno 17 out of mkdir. That makes to think of a garbage left
  in a database dir.
------------------------------------------------------------
revno: 3488 [merge]
committer: Sergey Glukhov <sergey.glukhov@oracle.com>
branch nick: mysql-trunk
timestamp: Wed 2011-10-12 18:04:59 +0400
message:
  automerge
    ------------------------------------------------------------
    revno: 2875.314.28 [merge]
    committer: Sergey Glukhov <sergey.glukhov@oracle.com>
    branch nick: mysql-5.5
    timestamp: Wed 2011-10-12 18:02:05 +0400
    message:
      automerge
------------------------------------------------------------
revno: 3487 [merge]
committer: Sergey Glukhov <sergey.glukhov@oracle.com>
branch nick: mysql-trunk
timestamp: Wed 2011-10-12 18:02:53 +0400
message:
  automerge
    ------------------------------------------------------------
    revno: 3485.1.1 [merge]
    committer: Marko M?kel? <marko.makela@oracle.com>
    branch nick: mysql-trunk
    timestamp: Wed 2011-10-12 16:46:34 +0300
    message:
      Merge mysql-5.5 to mysql-trunk.
        ------------------------------------------------------------
        revno: 2875.318.1 [merge]
        committer: Marko M?kel? <marko.makela@oracle.com>
        branch nick: mysql-5.5
        timestamp: Wed 2011-10-12 09:21:33 +0300
        message:
          Merge mysql-5.1 to mysql-5.5.
            ------------------------------------------------------------
            revno: 2661.809.40
            committer: Marko M?kel? <marko.makela@oracle.com>
            branch nick: mysql-5.1
            timestamp: Wed 2011-10-12 09:00:49 +0300
            message:
              Bug#13006367 62487: innodb takes 3 minutes to clean up the adaptive
              hash index at shutdown
              
              btr_search_disable(): Just drop the entire adaptive hash index,
              without dropping every record separately.
              
              buf_pool_clear_hash_index(): Renamed and simplified from
              buf_pool_drop_hash_index(). Set block->index = NULL for every block in
              the buffer pool. Do not release the btr_search_latch. The caller will
              have to adjust other data structures.
              
              Remove block->is_hashed. It is redundant, should be always equal to
              block->index != NULL.
              
              Remove btr_search_fully_disabled, btr_search_enabled_mutex, and
              SYNC_SEARCH_SYS_CONF. We drop the AHI in one pass, without releasing
              the btr_search_latch in between.
              
              Replace void* with const rec_t* and add assertions on btr_search_latch
              and btr_search_enabled to ha0ha.h, ha0ha.ic, ha0ha.c.
              
              page_set_max_trx_id(): Ignore the adaptive hash index. I forgot to
              push this in rb:750.
              
              btr0sea.c: Always after acquiring btr_search_latch, check for
              block->index==NULL or !btr_search_enabled. We can now set
              block->index=NULL while only holding btr_search_latch in exclusive
              mode. Always acquire btr_search_latch before reading block->index,
              except in shortcuts when testing for block->index == NULL.
              
              ha_clear(), ha_search(): Unused function, remove.
              
              buf_page_peek_if_search_hashed(): Remove. This function may avoid
              latching a page at the cost of doing a duplicate buf_pool->page_hash
              lookup.
              
              rb:775 approved by Inaam Rana
------------------------------------------------------------
revno: 3486 [merge]
committer: Sergey Glukhov <sergey.glukhov@oracle.com>
branch nick: mysql-trunk
timestamp: Wed 2011-10-12 17:58:31 +0400
message:
  5.5 -> trunk merge
    ------------------------------------------------------------
    revno: 2875.314.27
    committer: Sergey Glukhov <sergey.glukhov@oracle.com>
    branch nick: mysql-5.5
    timestamp: Wed 2011-10-12 17:41:25 +0400
    message:
      Bug#11750518 41090: ORDER BY TRUNCATES GROUP_CONCAT RESULT
      When temporary tables is used for result sorting
      result field for gconcat function is created using
      group_concat_max_len size. It leads to result truncation
      when character_set_results is multi-byte character set due
      to insufficient tmp table field size.
      The fix is to increase temporary table field size for
      gconcat. Method make_string_field() is overloaded
      for Item_func_group_concat class and uses
      max_characters * collation.collation->mbmaxlen size for
      result field. max_characters is maximum number of characters
      what can fit into max_length size.
------------------------------------------------------------
revno: 3485 [merge]
committer: Vinay Fisrekar <vinay.fisrekar@oracle.com>
branch nick: mysql-trunk
timestamp: Wed 2011-10-12 10:26:07 +0530
message:
  merge 5.5 -> trunk
  adjust/modify tests as they were failing if system time zone is set differently
    ------------------------------------------------------------
    revno: 2875.314.26 [merge]
    committer: Vinay Fisrekar <vinay.fisrekar@oracle.com>
    branch nick: mysql-5.5
    timestamp: Wed 2011-10-12 10:19:46 +0530
    message:
      merge 5.1 -> 5.5
      adjust/modify tests as they were failing if system time zone is set differently.
        ------------------------------------------------------------
        revno: 2661.809.39
        committer: Vinay Fisrekar <vinay.fisrekar@oracle.com>
        branch nick: mysql-5.1
        timestamp: Wed 2011-10-12 10:10:52 +0530
        message:
          bug#11766457 - adjusting/modifying the the tests as tests were failing if system time zone is set differently.
------------------------------------------------------------
revno: 3484 [merge]
committer: Joerg Bruehe <joerg.bruehe@oracle.com>
branch nick: mysql-trunk
timestamp: Mon 2011-10-10 14:06:09 +0200
message:
  Auto-upmerge a fix for test "file_contents" from 5.5 to trunk.
    ------------------------------------------------------------
    revno: 2875.314.25
    committer: Joerg Bruehe <joerg.bruehe@oracle.com>
    branch nick: mysql-5.5
    timestamp: Mon 2011-10-10 14:03:29 +0200
    message:
      Test "file_contents" failed in non-community RPMs on SuSE
      because the search pattern for the "INFO_*" files was not general enough:
      Fixed.
------------------------------------------------------------
revno: 3483
committer: Raghav Kapoor <raghav.kapoor@oracle.com>
branch nick: mysql-trunk-bug-11765553
timestamp: Mon 2011-10-10 12:29:58 +0530
message:
  
  BUG#11765553 - 58534: MYSQL_INSTALL_DB PRINTS INCOMPLETE OPTION NAME 
  
  BACKGROUND:
  
  "--skip-grant" is an incomplete option name. It should be
  "--skip-grant-tables" in mysql_install_db.sh.Besides,full 
  option name should be displayed, not some arbitrary shorthand.
  
  
  FIX:
  
  One change has been made in file mysql_install_db.sh at 
  line 408 where "shell> $mysqld --skip-grant &" is replaced
  by "shell> $mysqld --skip-grant-tables &" to complete the 
  option name.
------------------------------------------------------------
revno: 3482
committer: Manish Kumar <manish.4.kumar@oracle.com>
branch nick: mysql-trunk-bug-11747887
timestamp: Mon 2011-10-10 11:52:13 +0530
message:
  BUG#11747887:34386: MYSQLBINLOG --HEXDUMP PRINTS LAST ROW OF HEXDUMP INCORRECTLY 
  
  Problem description: when mysqlbinlog --hexdump prints events, it prints the last row of the
                       hexdump incorrectly.
                       If the last row has eight bytes,the end of the second last row is 
                       copied to the end of the last row,padding the row to full length.
                       If the last row has less than sixteen bytes, the textual 
                       representation is not aligned with the previous row.
         
  Fix: the bug was removed by padding the last line with the required 
       number of spaces in the last line.
------------------------------------------------------------
revno: 3481
committer: Sergey Vojtovich <sergey.vojtovich@oracle.com>
branch nick: mysql-trunk-push
timestamp: Sat 2011-10-08 21:18:28 +0400
message:
  BUG#11756687 - 48633: ARCHIVE TABLES ARE NOT UPGRADEABLE
  
  This addition fixes main.archive failure.
  
  Archive didn't read blobs from original table while
  performing REPAIR TABLE with non-debug builds.
------------------------------------------------------------
revno: 3480
committer: Mattias Jonsson <mattias.jonsson@oracle.com>
branch nick: b11763825-trunk
timestamp: Fri 2011-10-07 16:20:21 +0200
message:
  bug#11763825/Bug#56590: PARTITIONS: FULLTEXT SEARCHES FAIL
  
  Confusing error message:
  ERROR 1214 (HY000): The used table type doesn't support FULLTEXT
  indexes
  
  Fixed by adding a new error for this:
  ERROR HY000: FULLTEXT index is not supported for partitioned tables.
------------------------------------------------------------
revno: 3479
committer: Andrei Elkin <andrei.elkin@oracle.com>
branch nick: wl5569-mts-trunk-for-bugfixing
timestamp: Fri 2011-10-07 11:36:04 +0300
message:
  Bug#12960284 - RPL.RPL_PARALLEL_SWITCH_SEQUENTIAL TEST FAILED IN VALGRIND RUN ON
  
  There was a timeout at the very end of the test.
  Details of printout upon the failure does not reveal any issue with the text nor
  the server code. It's just slow and is used to pass on the same valgrind but the run
  time is apparently big (over 1 000 000 msec) -
    rpl.rpl_parallel_switch_sequential 'mix' w2 [ pass ]  1068101
  
  So it's fixed with decreasing load size when the test runs on valgrind.
------------------------------------------------------------
revno: 3478
committer: Mattias Jonsson <mattias.jonsson@oracle.com>
branch nick: b13007154-trunk
timestamp: Fri 2011-10-07 10:30:01 +0200
message:
  Bug#13007154: Crash in keys_to_use_for_scanning with ORDER BY
                             and PARTITIONING
  
  The server could crash on a query that called
  ha_partition::keys_to_use_for_scanning when there was no partitions
  used.Due to the first used partition would then be out of bounds.
  
  The solution was to always use the first partitions handler since the
  function will return the same key_map for every partition, since they
  have the same engine and the same structure.
  
  This bug was introduced as a regression in WL#5217.
------------------------------------------------------------
revno: 3477 [merge]
committer: Sergey Vojtovich <sergey.vojtovich@oracle.com>
branch nick: mysql-trunk-push
timestamp: Fri 2011-10-07 10:03:14 +0400
message:
  Merge.
    ------------------------------------------------------------
    revno: 3225.1.1
    committer: Sergey Vojtovich <sergey.vojtovich@oracle.com>
    branch nick: mysql-trunk-bug48633
    timestamp: Thu 2011-10-06 17:51:28 +0400
    message:
      BUG#11756687 - 48633: ARCHIVE TABLES ARE NOT UPGRADEABLE
      
      Archive table created by 5.0 were not accessible.
      
      This patch adds various fixes so that 5.0 archive tables
      are readable and writable. Though it is strongly recommended
      to avoid binary upgrade of archive tables whenever it is
      possible.
------------------------------------------------------------
revno: 3476
committer: Marc Alff <marc.alff@oracle.com>
branch nick: mysql-trunk-cleanup
timestamp: Thu 2011-10-06 19:15:47 +0200
message:
  Merge cleanup
  
  Applied dos2unix for whitespace
------------------------------------------------------------
revno: 3475 [merge]
committer: Andrei Elkin <andrei.elkin@oracle.com>
branch nick: wl5569-mts-trunk-for-bugfixing
timestamp: Thu 2011-10-06 19:29:24 +0300
message:
  merging from BUG#12981684 bundle.
    ------------------------------------------------------------
    revno: 3402.9.1
    committer: Alfranio Correia <alfranio.correia@oracle.com>
    branch nick: mysql-trunk
    timestamp: Wed 2011-09-14 17:12:22 +0100
    message:
      BUG#12981684 - MTS KEEPS COMPLAINING ABOUT MISSING RELAY-LOG.INFO WITH REPOSITORY = TABLE
      
      Removed code that was introduced to track down BUG 11766392.
      We have figured out that the problem was an issue in the
      environment.
------------------------------------------------------------
revno: 3474 [merge]
committer: Andrei Elkin <andrei.elkin@oracle.com>
branch nick: wl5569-mts-trunk-for-bugfixing
timestamp: Thu 2011-10-06 18:32:21 +0300
message:
  merging from the main trunk repo.
    ------------------------------------------------------------
    revno: 3472.1.15
    committer: Marc Alff <marc.alff@oracle.com>
    branch nick: mysql-trunk-cleanup
    timestamp: Thu 2011-10-06 16:33:18 +0200
    message:
      Build cleanup
      
      Fixed the safe mutex macros to be safe when used as in:
      
      if (cond)
        safe_mutex_assert_owner(...);
      
      do_something();
      
      which, because of the empty=broken macro, can expand to:
      
      if (cond)
        do_something();
    ------------------------------------------------------------
    revno: 3472.1.14 [merge]
    committer: Magne Mahre <magne.mahre@oracle.com>
    branch nick: mysql-trunk
    timestamp: Thu 2011-10-06 14:15:21 +0200
    message:
      Merge from mysql-5.5
        ------------------------------------------------------------
        revno: 2875.314.24
        committer: Magne Mahre <magne.mahre@oracle.com>
        branch nick: mysql-5.5
        timestamp: Thu 2011-10-06 14:13:23 +0200
        message:
          Bug#12912112 MYSQL_CLIENT_TEST FAILS ON TEST_TRUNCATION 
                 
          Sun Studio 12 has an error when calculating the compile-time 
          length of a constant character string.  The error is only 
          present when building an optimized 32-bits version, using 
          the -xbuiltin=(%all) compiler flag. 
                 
          During compilation, the compiler recognizes the use of 
          the strlen() function used on a constant string. It 
          optimizes the strlen and replaces it with the actual 
          length of the string.   This optimization seems to 
          calculate the length wrongly in this particular case. 
                 
          Replacing the "const char *" with a "const char []" 
          solves the problem. 
    ------------------------------------------------------------
    revno: 3472.1.13
    committer: Tor Didriksen <tor.didriksen@oracle.com>
    branch nick: trunk-append-push-front
    timestamp: Thu 2011-10-06 13:06:34 +0200
    message:
      Code cleanup.
      Reading register_item_tree_chage/rollback_item_tree_changes was
      quite confusing, until I realized that append() was actually push_front()....
    ------------------------------------------------------------
    revno: 3472.1.12 [merge]
    committer: Mattias Jonsson <mattias.jonsson@oracle.com>
    branch nick: topush-trunk
    timestamp: Thu 2011-10-06 11:50:40 +0200
    message:
      merge
        ------------------------------------------------------------
        revno: 2661.818.1
        committer: Mattias Jonsson <mattias.jonsson@oracle.com>
        branch nick: b11933226-51
        timestamp: Mon 2011-04-04 12:01:30 +0200
        message:
          BUG#11933226 - Bug#60681: CHECKSUM TABLE RETURNS 0 FOR PARTITIONED TABLE
          
          ha_partition::checksum() was not implemented, but HA_HAS_CHECKSUM table flag
          was returned if the underlying handlers supported it, resulting in CHECKSUM TABLE
          returned 0 when checksum was enabled.
          
          Fixed by implementing ha_partition::checksum() by adding all partitions checksums
          together.
          
          (even compiles with this commit :)
    ------------------------------------------------------------
    revno: 3472.1.11 [merge]
    committer: Bjorn Munch <bjorn.munch@oracle.com>
    branch nick: main-tr
    timestamp: Wed 2011-10-05 23:45:08 +0200
    message:
      null upmerge
        ------------------------------------------------------------
        revno: 2875.314.23 [merge]
        committer: Bjorn Munch <bjorn.munch@oracle.com>
        branch nick: main-55
        timestamp: Wed 2011-10-05 22:55:31 +0200
        message:
          null upmerge
            ------------------------------------------------------------
            revno: 2661.809.38 [merge]
            committer: Bjorn Munch <bjorn.munch@oracle.com>
            branch nick: merge-51
            timestamp: Wed 2011-10-05 22:38:00 +0200
            message:
              merge 5.1-mtr => 5.1
        ------------------------------------------------------------
        revno: 2875.314.22 [merge]
        committer: Bjorn Munch <bjorn.munch@oracle.com>
        branch nick: main-55
        timestamp: Wed 2011-10-05 22:54:16 +0200
        message:
          merge 5.5-mtr => 5.5
    ------------------------------------------------------------
    revno: 3472.1.10 [merge]
    committer: Bjorn Munch <bjorn.munch@oracle.com>
    branch nick: main-tr
    timestamp: Wed 2011-10-05 23:15:03 +0200
    message:
      merge trunk-mtr => trunk
        ------------------------------------------------------------
        revno: 3076.1.48 [merge]
        committer: Bjorn Munch <bjorn.munch@oracle.com>
        branch nick: mtr-tr
        timestamp: Wed 2011-10-05 16:08:27 +0200
        message:
          upmerge 12373393,12844282 etc. 5.5-mtr => trunk-mtr
            ------------------------------------------------------------
            revno: 2875.125.181
            committer: Bjorn Munch <bjorn.munch@oracle.com>
            branch nick: collinc-55
            timestamp: Wed 2011-10-05 15:16:20 +0200
            message:
              Silly mistake in gdb output: replaced print with resfile_print,
              but the latter only takes one argument, duh!
              Fixed by concatenating the args (replace , with .)
            ------------------------------------------------------------
            revno: 2875.125.180 [merge]
            committer: Bjorn Munch <bjorn.munch@oracle.com>
            branch nick: collinc-55
            timestamp: Wed 2011-10-05 15:14:14 +0200
            message:
              Bug #12844282 62075: MTR TESTS SHOULD NOT HAVE TO SAVE & RESET INNODB_FILE_FORMAT_CHECK
                This is a redo for 5.5
                Added 'innodb_file_format_max' as variable to ignore change to.
                Tests that had to restore this amended
                Two tests assumed it to be Antelope, make sure these run on a freshly
                  started server
                ------------------------------------------------------------
                revno: 2661.412.176
                committer: Bjorn Munch <bjorn.munch@oracle.com>
                branch nick: iffcign-51
                timestamp: Mon 2011-10-03 13:41:59 +0200
                message:
                  backporting 11766169, fixing 13034450
                ------------------------------------------------------------
                revno: 2661.412.175
                committer: Bjorn Munch <bjorn.munch@oracle.com>
                branch nick: iffcign-51
                timestamp: Tue 2011-09-27 12:56:05 +0200
                message:
                  Bug #12844282 62075: MTR TESTS SHOULD NOT HAVE TO SAVE & RESET INNODB_FILE_FORMAT_CHECK
                    Added 'innodb_file_format_check' as variable to ignore change to.
                    Tests that had to restore this amended
                    Two tests assumed it to be Antelope, make sure these run on a freshly
                      started server
                    For 5.5, apparently innodb_file_format_max is the one to ignore
            ------------------------------------------------------------
            revno: 2875.125.179
            committer: Bjorn Munch <bjorn.munch@oracle.com>
            branch nick: collinc-55
            timestamp: Mon 2011-10-03 13:16:40 +0200
            message:
              mtr: print which suites are used, unless explicit test names
            ------------------------------------------------------------
            revno: 2875.125.178
            committer: Bjorn Munch <bjorn.munch@oracle.com>
            branch nick: collinc-55
            timestamp: Thu 2011-09-29 12:34:44 +0200
            message:
              mtr --help: add --boot-xxx and sort some debug options
            ------------------------------------------------------------
            revno: 2875.125.177
            committer: Bjorn Munch <bjorn.munch@oracle.com>
            branch nick: collinc-55
            timestamp: Thu 2011-09-29 12:30:14 +0200
            message:
              removed some duplicate/redundant entries from .bzrignore
            ------------------------------------------------------------
            revno: 2875.125.176
            committer: Bjorn Munch <bjorn.munch@oracle.com>
            branch nick: collinc-55
            timestamp: Thu 2011-09-29 10:42:23 +0200
            message:
              Bug #12373393 PB2 SHOULD ALLOW TO CREATE COLLECTIONS AS SUPER SET OF EXISTING COLLECTIONS
                  Let CMake parse files with a ".in" suffix containing includes
                  Added default.release.in to replace default.release
                  Explained in README
                  New patch: replace 'include' with '#include' to avoid accidental matches
        ------------------------------------------------------------
        revno: 3076.1.47 [merge]
        committer: Bjorn Munch <bjorn.munch@oracle.com>
        branch nick: mtr-tr
        timestamp: Mon 2011-10-03 15:42:54 +0200
        message:
          merge from trunk
    ------------------------------------------------------------
    revno: 3472.1.9 [merge]
    committer: Joerg Bruehe <joerg.bruehe@oracle.com>
    branch nick: mysql-trunk
    timestamp: Wed 2011-10-05 16:27:14 +0200
    message:
      Automerge 5.6.3 to new changes in main.
        ------------------------------------------------------------
        revno: 3472.4.1 [merge]
        committer: Joerg Bruehe <joerg.bruehe@oracle.com>
        branch nick: work-trunk
        timestamp: Wed 2011-10-05 15:16:38 +0200
        message:
          Backmerge the changes of the 5.6.3 build into main "trunk".
          
          This brings the following changesets:
            Marc Alff 2011-09-26 BUG#12993572 - P_S STANDBY MODE CAUSES PERFORMANCE DROP
              Guilhem Bichot 2011-09-23 Fix for Bug#13009176 "USE DATABASE BREAKS OPTIMIZER TRACE IF THERE IS A VIEW IN THE SCHEMA"
              Luis Soares 2011-09-22 BUG#12987771: REPLICATED STATEMENTS ARE DUPLICATED 
              Olav Sandstaa 2011-09-20 Fix for Bug#12976163 "CRASH IN INDEX CONDITION PUSHDOWN CODE AGAINST 
              Evgeny Potemkin 2011-09-19 Bug#12977203: SERVER CRASH ON A DERIVED TABLE WITH QUERY CACHE ENABLED
              Sunny Bains 2011-09-17 Bug 12982772 - SERVER DOES NOT START WITH INNODB_UNDO_TABLESPACES (SYSTEM ERROR 32 FILE IN USE)
              Evgeny Potemkin 2011-09-15 Bug#12910006: MRR initialization on a derived table caused crash.
              Georgi Kodinov 2011-09-13 Bug #12925024: MYSQLD_SAFE IGNORES THE VALUE OF PLUGIN_DIR FROM MY.CNF
              Gleb Shchepa 2011-09-09 Bug #12949629: CLIENT LOSES CONNECTION AFTER EXECUTING
              Andrei Elkin 2011-09-09 Bug#12947451 - MTS: ERROR LOG GETS FLOODED WITH SYNCHRONIZATION-RELATED MESSAGES (NOTES)
              Oystein Grovlen 2011-09-07 WL#5285
              Guilhem Bichot 2011-08-31 1) fix for BUG#12905521 - ASSERT IN OPT_TRACE_STMT::SYNTAX_ERROR ON SELECT DISTINCT/MIN/JOIN/SUBQ QUERY
              Jonathan Perkin 2011-08-30 Bump milestone.
              Joerg Bruehe 2011-08-30 [merge] Merge a RPM packaging bugfix into the 5.6.3 release clone.
              hery.ramilison@or... 2011-08-29 Applying patch from vasil.dimov@oracle.com for OS X build failure
          
          Conflicts:
          Text conflict in VERSION
          Text conflict in mysql-test/include/icp_tests.inc
          Text conflict in mysql-test/r/derived.result
          Text conflict in mysql-test/r/innodb_icp.result
          Text conflict in mysql-test/r/innodb_icp_none.result
          Contents conflict in mysql-test/r/join_cache_bka_nobnl.result
          Contents conflict in mysql-test/r/join_nested_bka_nobnl.result
          Contents conflict in mysql-test/r/join_outer_bka_nobnl.result
          Text conflict in mysql-test/r/myisam_icp.result
          Text conflict in mysql-test/r/myisam_icp_none.result
          Contents conflict in mysql-test/r/select_all_bka_nobnl.result
          Contents conflict in mysql-test/r/select_icp_mrr_bka_nobnl.result
          Contents conflict in mysql-test/r/select_none_bka_nobnl.result
          Contents conflict in mysql-test/r/subquery_all_bka_nobnl.result
          Contents conflict in mysql-test/r/subquery_nomat_nosj_bka_nobnl.result
          Contents conflict in mysql-test/r/subquery_none_bka_nobnl.result
          Contents conflict in mysql-test/r/subquery_sj_all_bka_nobnl.result
          Contents conflict in mysql-test/r/subquery_sj_dupsweed_bka_nobnl.result
          Contents conflict in mysql-test/r/subquery_sj_firstmatch_bka_nobnl.result
          Contents conflict in mysql-test/r/subquery_sj_innodb_all_bka_nobnl.result
          Contents conflict in mysql-test/r/subquery_sj_innodb_none_bka_nobnl.result
          Contents conflict in mysql-test/r/subquery_sj_loosescan_bka_nobnl.result
          Contents conflict in mysql-test/r/subquery_sj_mat_bka_nobnl.result
          Contents conflict in mysql-test/r/subquery_sj_none_bka_nobnl.result
          Text conflict in mysql-test/suite/opt_trace/r/general_no_prot_all.result
          Text conflict in mysql-test/suite/opt_trace/r/general_no_prot_none.result
          Text conflict in mysql-test/suite/opt_trace/r/general_ps_prot_all.result
          Text conflict in mysql-test/suite/opt_trace/r/general_ps_prot_none.result
          Text conflict in mysql-test/t/derived.test
          Contents conflict in mysql-test/t/join_cache_bka_nobnl.test
          Contents conflict in mysql-test/t/join_nested_bka_nobnl.test
          Contents conflict in mysql-test/t/join_outer_bka_nobnl.test
          Contents conflict in mysql-test/t/select_all_bka_nobnl.test
          Contents conflict in mysql-test/t/select_icp_mrr_bka_nobnl.test
          Contents conflict in mysql-test/t/select_none_bka_nobnl.test
          Contents conflict in mysql-test/t/subquery_all_bka_nobnl.test
          Contents conflict in mysql-test/t/subquery_nomat_nosj_bka_nobnl.test
          Contents conflict in mysql-test/t/subquery_none_bka_nobnl.test
          Contents conflict in mysql-test/t/subquery_sj_all_bka_nobnl.test
          Contents conflict in mysql-test/t/subquery_sj_dupsweed_bka_nobnl.test
          Contents conflict in mysql-test/t/subquery_sj_firstmatch_bka_nobnl.test
          Contents conflict in mysql-test/t/subquery_sj_innodb_all_bka_nobnl.test
          Contents conflict in mysql-test/t/subquery_sj_innodb_none_bka_nobnl.test
          Contents conflict in mysql-test/t/subquery_sj_loosescan_bka_nobnl.test
          Contents conflict in mysql-test/t/subquery_sj_mat_bka_nobnl.test
          Contents conflict in mysql-test/t/subquery_sj_none_bka_nobnl.test
          Text conflict in sql/rpl_rli_pdb.cc
          47 conflicts encountered.
            ------------------------------------------------------------
            revno: 3400.2.15
            tags: mysql-5.6.3
            committer: Marc Alff <marc.alff@oracle.com>
            branch nick: mysql-5.6.3-m6-release
            timestamp: Mon 2011-09-26 16:07:09 +0200
            message:
              BUG#12993572 - P_S STANDBY MODE CAUSES PERFORMANCE DROP
              
              Backport for mysql-5.6.3-m4-release
              
              This fix is a performance improvement.
              
              Before this fix, the performance schema unbind_table() and rebind_table()
              api were called from sql/sql_base.cc while holding LOCK_open.
              
              As the implementation of these api can involve updating table statistics
              for the current table handle, these calls did cause significant bottlenecks
              for LOCK_open.
              
              This fix:
              
              - moved the call to unbind_table() before adding a table handle to the table
                definition cache (which uses LOCK_open), so the code is outside the
                critical section.
              
              - moved the call to rebind_table() after a free handle has been reused from
                the table definition cache. This is now also outside of the LOCK_open critical
                section.
              
              - The implementation of PFS_table::aggregate(), which is part of
                unbind_table(), has been optimized to be simpler when there are no
                statistics to update. Given that table lock statistics are collected for
                11 different types of lock (see PFS_TL_LOCK_TYPE), and that table io stats
                are collected for 4 types (fetch, insert, update, delete), per table and
                per index, this decreases the overhead when the table instrumentation is
                not used.
